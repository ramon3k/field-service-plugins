var pg=Object.defineProperty;var mg=(e,t,i)=>t in e?pg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var pi=(e,t,i)=>mg(e,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function i(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(a){if(a.ep)return;a.ep=!0;const c=i(a);fetch(a.href,c)}})();var gg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _h={exports:{}},bs={},Sh={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qr=Symbol.for("react.element"),vg=Symbol.for("react.portal"),xg=Symbol.for("react.fragment"),yg=Symbol.for("react.strict_mode"),_g=Symbol.for("react.profiler"),Sg=Symbol.for("react.provider"),wg=Symbol.for("react.context"),Cg=Symbol.for("react.forward_ref"),jg=Symbol.for("react.suspense"),bg=Symbol.for("react.memo"),kg=Symbol.for("react.lazy"),id=Symbol.iterator;function Tg(e){return e===null||typeof e!="object"?null:(e=id&&e[id]||e["@@iterator"],typeof e=="function"?e:null)}var wh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ch=Object.assign,jh={};function Hi(e,t,i){this.props=e,this.context=t,this.refs=jh,this.updater=i||wh}Hi.prototype.isReactComponent={};Hi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Hi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function bh(){}bh.prototype=Hi.prototype;function Kl(e,t,i){this.props=e,this.context=t,this.refs=jh,this.updater=i||wh}var Yl=Kl.prototype=new bh;Yl.constructor=Kl;Ch(Yl,Hi.prototype);Yl.isPureReactComponent=!0;var rd=Array.isArray,kh=Object.prototype.hasOwnProperty,Ql={current:null},Th={key:!0,ref:!0,__self:!0,__source:!0};function Ph(e,t,i){var s,a={},c=null,d=null;if(t!=null)for(s in t.ref!==void 0&&(d=t.ref),t.key!==void 0&&(c=""+t.key),t)kh.call(t,s)&&!Th.hasOwnProperty(s)&&(a[s]=t[s]);var p=arguments.length-2;if(p===1)a.children=i;else if(1<p){for(var m=Array(p),g=0;g<p;g++)m[g]=arguments[g+2];a.children=m}if(e&&e.defaultProps)for(s in p=e.defaultProps,p)a[s]===void 0&&(a[s]=p[s]);return{$$typeof:qr,type:e,key:c,ref:d,props:a,_owner:Ql.current}}function Pg(e,t){return{$$typeof:qr,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Xl(e){return typeof e=="object"&&e!==null&&e.$$typeof===qr}function Lg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var od=/\/+/g;function xa(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Lg(""+e.key):t.toString(36)}function Wo(e,t,i,s,a){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case qr:case vg:d=!0}}if(d)return d=e,a=a(d),e=s===""?"."+xa(d,0):s,rd(a)?(i="",e!=null&&(i=e.replace(od,"$&/")+"/"),Wo(a,t,i,"",function(g){return g})):a!=null&&(Xl(a)&&(a=Pg(a,i+(!a.key||d&&d.key===a.key?"":(""+a.key).replace(od,"$&/")+"/")+e)),t.push(a)),1;if(d=0,s=s===""?".":s+":",rd(e))for(var p=0;p<e.length;p++){c=e[p];var m=s+xa(c,p);d+=Wo(c,t,i,m,a)}else if(m=Tg(e),typeof m=="function")for(e=m.call(e),p=0;!(c=e.next()).done;)c=c.value,m=s+xa(c,p++),d+=Wo(c,t,i,m,a);else if(c==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return d}function yo(e,t,i){if(e==null)return e;var s=[],a=0;return Wo(e,s,"","",function(c){return t.call(i,c,a++)}),s}function Ng(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Xe={current:null},Ho={transition:null},Ag={ReactCurrentDispatcher:Xe,ReactCurrentBatchConfig:Ho,ReactCurrentOwner:Ql};function Lh(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:yo,forEach:function(e,t,i){yo(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return yo(e,function(){t++}),t},toArray:function(e){return yo(e,function(t){return t})||[]},only:function(e){if(!Xl(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};he.Component=Hi;he.Fragment=xg;he.Profiler=_g;he.PureComponent=Kl;he.StrictMode=yg;he.Suspense=jg;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ag;he.act=Lh;he.cloneElement=function(e,t,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Ch({},e.props),a=e.key,c=e.ref,d=e._owner;if(t!=null){if(t.ref!==void 0&&(c=t.ref,d=Ql.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var p=e.type.defaultProps;for(m in t)kh.call(t,m)&&!Th.hasOwnProperty(m)&&(s[m]=t[m]===void 0&&p!==void 0?p[m]:t[m])}var m=arguments.length-2;if(m===1)s.children=i;else if(1<m){p=Array(m);for(var g=0;g<m;g++)p[g]=arguments[g+2];s.children=p}return{$$typeof:qr,type:e.type,key:a,ref:c,props:s,_owner:d}};he.createContext=function(e){return e={$$typeof:wg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Sg,_context:e},e.Consumer=e};he.createElement=Ph;he.createFactory=function(e){var t=Ph.bind(null,e);return t.type=e,t};he.createRef=function(){return{current:null}};he.forwardRef=function(e){return{$$typeof:Cg,render:e}};he.isValidElement=Xl;he.lazy=function(e){return{$$typeof:kg,_payload:{_status:-1,_result:e},_init:Ng}};he.memo=function(e,t){return{$$typeof:bg,type:e,compare:t===void 0?null:t}};he.startTransition=function(e){var t=Ho.transition;Ho.transition={};try{e()}finally{Ho.transition=t}};he.unstable_act=Lh;he.useCallback=function(e,t){return Xe.current.useCallback(e,t)};he.useContext=function(e){return Xe.current.useContext(e)};he.useDebugValue=function(){};he.useDeferredValue=function(e){return Xe.current.useDeferredValue(e)};he.useEffect=function(e,t){return Xe.current.useEffect(e,t)};he.useId=function(){return Xe.current.useId()};he.useImperativeHandle=function(e,t,i){return Xe.current.useImperativeHandle(e,t,i)};he.useInsertionEffect=function(e,t){return Xe.current.useInsertionEffect(e,t)};he.useLayoutEffect=function(e,t){return Xe.current.useLayoutEffect(e,t)};he.useMemo=function(e,t){return Xe.current.useMemo(e,t)};he.useReducer=function(e,t,i){return Xe.current.useReducer(e,t,i)};he.useRef=function(e){return Xe.current.useRef(e)};he.useState=function(e){return Xe.current.useState(e)};he.useSyncExternalStore=function(e,t,i){return Xe.current.useSyncExternalStore(e,t,i)};he.useTransition=function(){return Xe.current.useTransition()};he.version="18.3.1";Sh.exports=he;var P=Sh.exports;const Lr=yh(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eg=P,zg=Symbol.for("react.element"),Dg=Symbol.for("react.fragment"),Ig=Object.prototype.hasOwnProperty,Rg=Eg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Og={key:!0,ref:!0,__self:!0,__source:!0};function Nh(e,t,i){var s,a={},c=null,d=null;i!==void 0&&(c=""+i),t.key!==void 0&&(c=""+t.key),t.ref!==void 0&&(d=t.ref);for(s in t)Ig.call(t,s)&&!Og.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:zg,type:e,key:c,ref:d,props:a,_owner:Rg.current}}bs.Fragment=Dg;bs.jsx=Nh;bs.jsxs=Nh;_h.exports=bs;var r=_h.exports,Xa={},Ah={exports:{}},gt={},Eh={exports:{}},zh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(T,v){var E=T.length;T.push(v);e:for(;0<E;){var W=E-1>>>1,Z=T[W];if(0<a(Z,v))T[W]=v,T[E]=Z,E=W;else break e}}function i(T){return T.length===0?null:T[0]}function s(T){if(T.length===0)return null;var v=T[0],E=T.pop();if(E!==v){T[0]=E;e:for(var W=0,Z=T.length,Q=Z>>>1;W<Q;){var te=2*(W+1)-1,ae=T[te],q=te+1,ee=T[q];if(0>a(ae,E))q<Z&&0>a(ee,ae)?(T[W]=ee,T[q]=E,W=q):(T[W]=ae,T[te]=E,W=te);else if(q<Z&&0>a(ee,E))T[W]=ee,T[q]=E,W=q;else break e}}return v}function a(T,v){var E=T.sortIndex-v.sortIndex;return E!==0?E:T.id-v.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var d=Date,p=d.now();e.unstable_now=function(){return d.now()-p}}var m=[],g=[],_=1,j=null,b=3,D=!1,k=!1,A=!1,O=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(T){for(var v=i(g);v!==null;){if(v.callback===null)s(g);else if(v.startTime<=T)s(g),v.sortIndex=v.expirationTime,t(m,v);else break;v=i(g)}}function C(T){if(A=!1,w(T),!k)if(i(m)!==null)k=!0,re(y);else{var v=i(g);v!==null&&oe(C,v.startTime-T)}}function y(T,v){k=!1,A&&(A=!1,S(B),B=-1),D=!0;var E=b;try{for(w(v),j=i(m);j!==null&&(!(j.expirationTime>v)||T&&!U());){var W=j.callback;if(typeof W=="function"){j.callback=null,b=j.priorityLevel;var Z=W(j.expirationTime<=v);v=e.unstable_now(),typeof Z=="function"?j.callback=Z:j===i(m)&&s(m),w(v)}else s(m);j=i(m)}if(j!==null)var Q=!0;else{var te=i(g);te!==null&&oe(C,te.startTime-v),Q=!1}return Q}finally{j=null,b=E,D=!1}}var z=!1,I=null,B=-1,$=5,H=-1;function U(){return!(e.unstable_now()-H<$)}function F(){if(I!==null){var T=e.unstable_now();H=T;var v=!0;try{v=I(!0,T)}finally{v?G():(z=!1,I=null)}}else z=!1}var G;if(typeof f=="function")G=function(){f(F)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,ne=K.port2;K.port1.onmessage=F,G=function(){ne.postMessage(null)}}else G=function(){O(F,0)};function re(T){I=T,z||(z=!0,G())}function oe(T,v){B=O(function(){T(e.unstable_now())},v)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_continueExecution=function(){k||D||(k=!0,re(y))},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_getFirstCallbackNode=function(){return i(m)},e.unstable_next=function(T){switch(b){case 1:case 2:case 3:var v=3;break;default:v=b}var E=b;b=v;try{return T()}finally{b=E}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(T,v){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var E=b;b=T;try{return v()}finally{b=E}},e.unstable_scheduleCallback=function(T,v,E){var W=e.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?W+E:W):E=W,T){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=E+Z,T={id:_++,callback:v,priorityLevel:T,startTime:E,expirationTime:Z,sortIndex:-1},E>W?(T.sortIndex=E,t(g,T),i(m)===null&&T===i(g)&&(A?(S(B),B=-1):A=!0,oe(C,E-W))):(T.sortIndex=Z,t(m,T),k||D||(k=!0,re(y))),T},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(T){var v=b;return function(){var E=b;b=v;try{return T.apply(this,arguments)}finally{b=E}}}})(zh);Eh.exports=zh;var Mg=Eh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bg=P,mt=Mg;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dh=new Set,Nr={};function ni(e,t){Oi(e,t),Oi(e+"Capture",t)}function Oi(e,t){for(Nr[e]=t,e=0;e<t.length;e++)Dh.add(t[e])}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),el=Object.prototype.hasOwnProperty,Fg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sd={},ad={};function Ug(e){return el.call(ad,e)?!0:el.call(sd,e)?!1:Fg.test(e)?ad[e]=!0:(sd[e]=!0,!1)}function $g(e,t,i,s){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Wg(e,t,i,s){if(t===null||typeof t>"u"||$g(e,t,i,s))return!0;if(s)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function et(e,t,i,s,a,c,d){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=c,this.removeEmptyString=d}var Ze={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ze[e]=new et(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ze[t]=new et(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ze[e]=new et(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ze[e]=new et(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ze[e]=new et(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ze[e]=new et(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ze[e]=new et(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ze[e]=new et(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ze[e]=new et(e,5,!1,e.toLowerCase(),null,!1,!1)});var ec=/[\-:]([a-z])/g;function tc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ec,tc);Ze[t]=new et(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ec,tc);Ze[t]=new et(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ec,tc);Ze[t]=new et(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ze[e]=new et(e,1,!1,e.toLowerCase(),null,!1,!1)});Ze.xlinkHref=new et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ze[e]=new et(e,1,!1,e.toLowerCase(),null,!0,!0)});function nc(e,t,i,s){var a=Ze.hasOwnProperty(t)?Ze[t]:null;(a!==null?a.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Wg(t,i,a,s)&&(i=null),s||a===null?Ug(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):a.mustUseProperty?e[a.propertyName]=i===null?a.type===3?!1:"":i:(t=a.attributeName,s=a.attributeNamespace,i===null?e.removeAttribute(t):(a=a.type,i=a===3||a===4&&i===!0?"":""+i,s?e.setAttributeNS(s,t,i):e.setAttribute(t,i))))}var pn=Bg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_o=Symbol.for("react.element"),vi=Symbol.for("react.portal"),xi=Symbol.for("react.fragment"),ic=Symbol.for("react.strict_mode"),tl=Symbol.for("react.profiler"),Ih=Symbol.for("react.provider"),Rh=Symbol.for("react.context"),rc=Symbol.for("react.forward_ref"),nl=Symbol.for("react.suspense"),il=Symbol.for("react.suspense_list"),oc=Symbol.for("react.memo"),xn=Symbol.for("react.lazy"),Oh=Symbol.for("react.offscreen"),ld=Symbol.iterator;function sr(e){return e===null||typeof e!="object"?null:(e=ld&&e[ld]||e["@@iterator"],typeof e=="function"?e:null)}var Pe=Object.assign,ya;function mr(e){if(ya===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);ya=t&&t[1]||""}return`
`+ya+e}var _a=!1;function Sa(e,t){if(!e||_a)return"";_a=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(g){var s=g}Reflect.construct(e,[],t)}else{try{t.call()}catch(g){s=g}e.call(t.prototype)}else{try{throw Error()}catch(g){s=g}e()}}catch(g){if(g&&s&&typeof g.stack=="string"){for(var a=g.stack.split(`
`),c=s.stack.split(`
`),d=a.length-1,p=c.length-1;1<=d&&0<=p&&a[d]!==c[p];)p--;for(;1<=d&&0<=p;d--,p--)if(a[d]!==c[p]){if(d!==1||p!==1)do if(d--,p--,0>p||a[d]!==c[p]){var m=`
`+a[d].replace(" at new "," at ");return e.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",e.displayName)),m}while(1<=d&&0<=p);break}}}finally{_a=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?mr(e):""}function Hg(e){switch(e.tag){case 5:return mr(e.type);case 16:return mr("Lazy");case 13:return mr("Suspense");case 19:return mr("SuspenseList");case 0:case 2:case 15:return e=Sa(e.type,!1),e;case 11:return e=Sa(e.type.render,!1),e;case 1:return e=Sa(e.type,!0),e;default:return""}}function rl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xi:return"Fragment";case vi:return"Portal";case tl:return"Profiler";case ic:return"StrictMode";case nl:return"Suspense";case il:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Rh:return(e.displayName||"Context")+".Consumer";case Ih:return(e._context.displayName||"Context")+".Provider";case rc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case oc:return t=e.displayName||null,t!==null?t:rl(e.type)||"Memo";case xn:t=e._payload,e=e._init;try{return rl(e(t))}catch{}}return null}function Zg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rl(t);case 8:return t===ic?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Dn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Mh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Vg(e){var t=Mh(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var a=i.get,c=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(d){s=""+d,c.call(this,d)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function So(e){e._valueTracker||(e._valueTracker=Vg(e))}function Bh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),s="";return e&&(s=Mh(e)?e.checked?"true":"false":e.value),e=s,e!==i?(t.setValue(e),!0):!1}function ts(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ol(e,t){var i=t.checked;return Pe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function cd(e,t){var i=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;i=Dn(t.value!=null?t.value:i),e._wrapperState={initialChecked:s,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Fh(e,t){t=t.checked,t!=null&&nc(e,"checked",t,!1)}function sl(e,t){Fh(e,t);var i=Dn(t.value),s=t.type;if(i!=null)s==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?al(e,t.type,i):t.hasOwnProperty("defaultValue")&&al(e,t.type,Dn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ud(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function al(e,t,i){(t!=="number"||ts(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var gr=Array.isArray;function Ai(e,t,i,s){if(e=e.options,t){t={};for(var a=0;a<i.length;a++)t["$"+i[a]]=!0;for(i=0;i<e.length;i++)a=t.hasOwnProperty("$"+e[i].value),e[i].selected!==a&&(e[i].selected=a),a&&s&&(e[i].defaultSelected=!0)}else{for(i=""+Dn(i),t=null,a=0;a<e.length;a++){if(e[a].value===i){e[a].selected=!0,s&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function ll(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return Pe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function dd(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(J(92));if(gr(i)){if(1<i.length)throw Error(J(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:Dn(i)}}function Uh(e,t){var i=Dn(t.value),s=Dn(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),s!=null&&(e.defaultValue=""+s)}function hd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $h(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$h(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wo,Wh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,s,a){MSApp.execUnsafeLocalFunction(function(){return e(t,i,s,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wo=wo||document.createElement("div"),wo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ar(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var yr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qg=["Webkit","ms","Moz","O"];Object.keys(yr).forEach(function(e){qg.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),yr[t]=yr[e]})});function Hh(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||yr.hasOwnProperty(e)&&yr[e]?(""+t).trim():t+"px"}function Zh(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var s=i.indexOf("--")===0,a=Hh(i,t[i],s);i==="float"&&(i="cssFloat"),s?e.setProperty(i,a):e[i]=a}}var Jg=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ul(e,t){if(t){if(Jg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function dl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hl=null;function sc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var fl=null,Ei=null,zi=null;function fd(e){if(e=Kr(e)){if(typeof fl!="function")throw Error(J(280));var t=e.stateNode;t&&(t=Ns(t),fl(e.stateNode,e.type,t))}}function Vh(e){Ei?zi?zi.push(e):zi=[e]:Ei=e}function qh(){if(Ei){var e=Ei,t=zi;if(zi=Ei=null,fd(e),t)for(e=0;e<t.length;e++)fd(t[e])}}function Jh(e,t){return e(t)}function Gh(){}var wa=!1;function Kh(e,t,i){if(wa)return e(t,i);wa=!0;try{return Jh(e,t,i)}finally{wa=!1,(Ei!==null||zi!==null)&&(Gh(),qh())}}function Er(e,t){var i=e.stateNode;if(i===null)return null;var s=Ns(i);if(s===null)return null;i=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(J(231,t,typeof i));return i}var pl=!1;if(un)try{var ar={};Object.defineProperty(ar,"passive",{get:function(){pl=!0}}),window.addEventListener("test",ar,ar),window.removeEventListener("test",ar,ar)}catch{pl=!1}function Gg(e,t,i,s,a,c,d,p,m){var g=Array.prototype.slice.call(arguments,3);try{t.apply(i,g)}catch(_){this.onError(_)}}var _r=!1,ns=null,is=!1,ml=null,Kg={onError:function(e){_r=!0,ns=e}};function Yg(e,t,i,s,a,c,d,p,m){_r=!1,ns=null,Gg.apply(Kg,arguments)}function Qg(e,t,i,s,a,c,d,p,m){if(Yg.apply(this,arguments),_r){if(_r){var g=ns;_r=!1,ns=null}else throw Error(J(198));is||(is=!0,ml=g)}}function ii(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function Yh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function pd(e){if(ii(e)!==e)throw Error(J(188))}function Xg(e){var t=e.alternate;if(!t){if(t=ii(e),t===null)throw Error(J(188));return t!==e?null:e}for(var i=e,s=t;;){var a=i.return;if(a===null)break;var c=a.alternate;if(c===null){if(s=a.return,s!==null){i=s;continue}break}if(a.child===c.child){for(c=a.child;c;){if(c===i)return pd(a),e;if(c===s)return pd(a),t;c=c.sibling}throw Error(J(188))}if(i.return!==s.return)i=a,s=c;else{for(var d=!1,p=a.child;p;){if(p===i){d=!0,i=a,s=c;break}if(p===s){d=!0,s=a,i=c;break}p=p.sibling}if(!d){for(p=c.child;p;){if(p===i){d=!0,i=c,s=a;break}if(p===s){d=!0,s=c,i=a;break}p=p.sibling}if(!d)throw Error(J(189))}}if(i.alternate!==s)throw Error(J(190))}if(i.tag!==3)throw Error(J(188));return i.stateNode.current===i?e:t}function Qh(e){return e=Xg(e),e!==null?Xh(e):null}function Xh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Xh(e);if(t!==null)return t;e=e.sibling}return null}var ef=mt.unstable_scheduleCallback,md=mt.unstable_cancelCallback,ev=mt.unstable_shouldYield,tv=mt.unstable_requestPaint,Ee=mt.unstable_now,nv=mt.unstable_getCurrentPriorityLevel,ac=mt.unstable_ImmediatePriority,tf=mt.unstable_UserBlockingPriority,rs=mt.unstable_NormalPriority,iv=mt.unstable_LowPriority,nf=mt.unstable_IdlePriority,ks=null,Kt=null;function rv(e){if(Kt&&typeof Kt.onCommitFiberRoot=="function")try{Kt.onCommitFiberRoot(ks,e,void 0,(e.current.flags&128)===128)}catch{}}var Mt=Math.clz32?Math.clz32:av,ov=Math.log,sv=Math.LN2;function av(e){return e>>>=0,e===0?32:31-(ov(e)/sv|0)|0}var Co=64,jo=4194304;function vr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function os(e,t){var i=e.pendingLanes;if(i===0)return 0;var s=0,a=e.suspendedLanes,c=e.pingedLanes,d=i&268435455;if(d!==0){var p=d&~a;p!==0?s=vr(p):(c&=d,c!==0&&(s=vr(c)))}else d=i&~a,d!==0?s=vr(d):c!==0&&(s=vr(c));if(s===0)return 0;if(t!==0&&t!==s&&!(t&a)&&(a=s&-s,c=t&-t,a>=c||a===16&&(c&4194240)!==0))return t;if(s&4&&(s|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)i=31-Mt(t),a=1<<i,s|=e[i],t&=~a;return s}function lv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cv(e,t){for(var i=e.suspendedLanes,s=e.pingedLanes,a=e.expirationTimes,c=e.pendingLanes;0<c;){var d=31-Mt(c),p=1<<d,m=a[d];m===-1?(!(p&i)||p&s)&&(a[d]=lv(p,t)):m<=t&&(e.expiredLanes|=p),c&=~p}}function gl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function rf(){var e=Co;return Co<<=1,!(Co&4194240)&&(Co=64),e}function Ca(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Jr(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mt(t),e[t]=i}function uv(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<i;){var a=31-Mt(i),c=1<<a;t[a]=0,s[a]=-1,e[a]=-1,i&=~c}}function lc(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var s=31-Mt(i),a=1<<s;a&t|e[s]&t&&(e[s]|=t),i&=~a}}var ve=0;function of(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sf,cc,af,lf,cf,vl=!1,bo=[],kn=null,Tn=null,Pn=null,zr=new Map,Dr=new Map,_n=[],dv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gd(e,t){switch(e){case"focusin":case"focusout":kn=null;break;case"dragenter":case"dragleave":Tn=null;break;case"mouseover":case"mouseout":Pn=null;break;case"pointerover":case"pointerout":zr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dr.delete(t.pointerId)}}function lr(e,t,i,s,a,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:i,eventSystemFlags:s,nativeEvent:c,targetContainers:[a]},t!==null&&(t=Kr(t),t!==null&&cc(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function hv(e,t,i,s,a){switch(t){case"focusin":return kn=lr(kn,e,t,i,s,a),!0;case"dragenter":return Tn=lr(Tn,e,t,i,s,a),!0;case"mouseover":return Pn=lr(Pn,e,t,i,s,a),!0;case"pointerover":var c=a.pointerId;return zr.set(c,lr(zr.get(c)||null,e,t,i,s,a)),!0;case"gotpointercapture":return c=a.pointerId,Dr.set(c,lr(Dr.get(c)||null,e,t,i,s,a)),!0}return!1}function uf(e){var t=Vn(e.target);if(t!==null){var i=ii(t);if(i!==null){if(t=i.tag,t===13){if(t=Yh(i),t!==null){e.blockedOn=t,cf(e.priority,function(){af(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Zo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=xl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var s=new i.constructor(i.type,i);hl=s,i.target.dispatchEvent(s),hl=null}else return t=Kr(i),t!==null&&cc(t),e.blockedOn=i,!1;t.shift()}return!0}function vd(e,t,i){Zo(e)&&i.delete(t)}function fv(){vl=!1,kn!==null&&Zo(kn)&&(kn=null),Tn!==null&&Zo(Tn)&&(Tn=null),Pn!==null&&Zo(Pn)&&(Pn=null),zr.forEach(vd),Dr.forEach(vd)}function cr(e,t){e.blockedOn===t&&(e.blockedOn=null,vl||(vl=!0,mt.unstable_scheduleCallback(mt.unstable_NormalPriority,fv)))}function Ir(e){function t(a){return cr(a,e)}if(0<bo.length){cr(bo[0],e);for(var i=1;i<bo.length;i++){var s=bo[i];s.blockedOn===e&&(s.blockedOn=null)}}for(kn!==null&&cr(kn,e),Tn!==null&&cr(Tn,e),Pn!==null&&cr(Pn,e),zr.forEach(t),Dr.forEach(t),i=0;i<_n.length;i++)s=_n[i],s.blockedOn===e&&(s.blockedOn=null);for(;0<_n.length&&(i=_n[0],i.blockedOn===null);)uf(i),i.blockedOn===null&&_n.shift()}var Di=pn.ReactCurrentBatchConfig,ss=!0;function pv(e,t,i,s){var a=ve,c=Di.transition;Di.transition=null;try{ve=1,uc(e,t,i,s)}finally{ve=a,Di.transition=c}}function mv(e,t,i,s){var a=ve,c=Di.transition;Di.transition=null;try{ve=4,uc(e,t,i,s)}finally{ve=a,Di.transition=c}}function uc(e,t,i,s){if(ss){var a=xl(e,t,i,s);if(a===null)za(e,t,s,as,i),gd(e,s);else if(hv(a,e,t,i,s))s.stopPropagation();else if(gd(e,s),t&4&&-1<dv.indexOf(e)){for(;a!==null;){var c=Kr(a);if(c!==null&&sf(c),c=xl(e,t,i,s),c===null&&za(e,t,s,as,i),c===a)break;a=c}a!==null&&s.stopPropagation()}else za(e,t,s,null,i)}}var as=null;function xl(e,t,i,s){if(as=null,e=sc(s),e=Vn(e),e!==null)if(t=ii(e),t===null)e=null;else if(i=t.tag,i===13){if(e=Yh(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return as=e,null}function df(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nv()){case ac:return 1;case tf:return 4;case rs:case iv:return 16;case nf:return 536870912;default:return 16}default:return 16}}var jn=null,dc=null,Vo=null;function hf(){if(Vo)return Vo;var e,t=dc,i=t.length,s,a="value"in jn?jn.value:jn.textContent,c=a.length;for(e=0;e<i&&t[e]===a[e];e++);var d=i-e;for(s=1;s<=d&&t[i-s]===a[c-s];s++);return Vo=a.slice(e,1<s?1-s:void 0)}function qo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ko(){return!0}function xd(){return!1}function vt(e){function t(i,s,a,c,d){this._reactName=i,this._targetInst=a,this.type=s,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var p in e)e.hasOwnProperty(p)&&(i=e[p],this[p]=i?i(c):c[p]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?ko:xd,this.isPropagationStopped=xd,this}return Pe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=ko)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=ko)},persist:function(){},isPersistent:ko}),t}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hc=vt(Zi),Gr=Pe({},Zi,{view:0,detail:0}),gv=vt(Gr),ja,ba,ur,Ts=Pe({},Gr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ur&&(ur&&e.type==="mousemove"?(ja=e.screenX-ur.screenX,ba=e.screenY-ur.screenY):ba=ja=0,ur=e),ja)},movementY:function(e){return"movementY"in e?e.movementY:ba}}),yd=vt(Ts),vv=Pe({},Ts,{dataTransfer:0}),xv=vt(vv),yv=Pe({},Gr,{relatedTarget:0}),ka=vt(yv),_v=Pe({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),Sv=vt(_v),wv=Pe({},Zi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Cv=vt(wv),jv=Pe({},Zi,{data:0}),_d=vt(jv),bv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Tv[e])?!!t[e]:!1}function fc(){return Pv}var Lv=Pe({},Gr,{key:function(e){if(e.key){var t=bv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=qo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?kv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fc,charCode:function(e){return e.type==="keypress"?qo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nv=vt(Lv),Av=Pe({},Ts,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sd=vt(Av),Ev=Pe({},Gr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fc}),zv=vt(Ev),Dv=Pe({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Iv=vt(Dv),Rv=Pe({},Ts,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ov=vt(Rv),Mv=[9,13,27,32],pc=un&&"CompositionEvent"in window,Sr=null;un&&"documentMode"in document&&(Sr=document.documentMode);var Bv=un&&"TextEvent"in window&&!Sr,ff=un&&(!pc||Sr&&8<Sr&&11>=Sr),wd=" ",Cd=!1;function pf(e,t){switch(e){case"keyup":return Mv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yi=!1;function Fv(e,t){switch(e){case"compositionend":return mf(t);case"keypress":return t.which!==32?null:(Cd=!0,wd);case"textInput":return e=t.data,e===wd&&Cd?null:e;default:return null}}function Uv(e,t){if(yi)return e==="compositionend"||!pc&&pf(e,t)?(e=hf(),Vo=dc=jn=null,yi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ff&&t.locale!=="ko"?null:t.data;default:return null}}var $v={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!$v[e.type]:t==="textarea"}function gf(e,t,i,s){Vh(s),t=ls(t,"onChange"),0<t.length&&(i=new hc("onChange","change",null,i,s),e.push({event:i,listeners:t}))}var wr=null,Rr=null;function Wv(e){Tf(e,0)}function Ps(e){var t=wi(e);if(Bh(t))return e}function Hv(e,t){if(e==="change")return t}var vf=!1;if(un){var Ta;if(un){var Pa="oninput"in document;if(!Pa){var bd=document.createElement("div");bd.setAttribute("oninput","return;"),Pa=typeof bd.oninput=="function"}Ta=Pa}else Ta=!1;vf=Ta&&(!document.documentMode||9<document.documentMode)}function kd(){wr&&(wr.detachEvent("onpropertychange",xf),Rr=wr=null)}function xf(e){if(e.propertyName==="value"&&Ps(Rr)){var t=[];gf(t,Rr,e,sc(e)),Kh(Wv,t)}}function Zv(e,t,i){e==="focusin"?(kd(),wr=t,Rr=i,wr.attachEvent("onpropertychange",xf)):e==="focusout"&&kd()}function Vv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ps(Rr)}function qv(e,t){if(e==="click")return Ps(t)}function Jv(e,t){if(e==="input"||e==="change")return Ps(t)}function Gv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ut=typeof Object.is=="function"?Object.is:Gv;function Or(e,t){if(Ut(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(s=0;s<i.length;s++){var a=i[s];if(!el.call(t,a)||!Ut(e[a],t[a]))return!1}return!0}function Td(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pd(e,t){var i=Td(e);e=0;for(var s;i;){if(i.nodeType===3){if(s=e+i.textContent.length,e<=t&&s>=t)return{node:i,offset:t-e};e=s}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Td(i)}}function yf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _f(){for(var e=window,t=ts();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=ts(e.document)}return t}function mc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Kv(e){var t=_f(),i=e.focusedElem,s=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&yf(i.ownerDocument.documentElement,i)){if(s!==null&&mc(i)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=i.textContent.length,c=Math.min(s.start,a);s=s.end===void 0?c:Math.min(s.end,a),!e.extend&&c>s&&(a=s,s=c,c=a),a=Pd(i,c);var d=Pd(i,s);a&&d&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),c>s?(e.addRange(t),e.extend(d.node,d.offset)):(t.setEnd(d.node,d.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Yv=un&&"documentMode"in document&&11>=document.documentMode,_i=null,yl=null,Cr=null,_l=!1;function Ld(e,t,i){var s=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;_l||_i==null||_i!==ts(s)||(s=_i,"selectionStart"in s&&mc(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Cr&&Or(Cr,s)||(Cr=s,s=ls(yl,"onSelect"),0<s.length&&(t=new hc("onSelect","select",null,t,i),e.push({event:t,listeners:s}),t.target=_i)))}function To(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Si={animationend:To("Animation","AnimationEnd"),animationiteration:To("Animation","AnimationIteration"),animationstart:To("Animation","AnimationStart"),transitionend:To("Transition","TransitionEnd")},La={},Sf={};un&&(Sf=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);function Ls(e){if(La[e])return La[e];if(!Si[e])return e;var t=Si[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in Sf)return La[e]=t[i];return e}var wf=Ls("animationend"),Cf=Ls("animationiteration"),jf=Ls("animationstart"),bf=Ls("transitionend"),kf=new Map,Nd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rn(e,t){kf.set(e,t),ni(t,[e])}for(var Na=0;Na<Nd.length;Na++){var Aa=Nd[Na],Qv=Aa.toLowerCase(),Xv=Aa[0].toUpperCase()+Aa.slice(1);Rn(Qv,"on"+Xv)}Rn(wf,"onAnimationEnd");Rn(Cf,"onAnimationIteration");Rn(jf,"onAnimationStart");Rn("dblclick","onDoubleClick");Rn("focusin","onFocus");Rn("focusout","onBlur");Rn(bf,"onTransitionEnd");Oi("onMouseEnter",["mouseout","mouseover"]);Oi("onMouseLeave",["mouseout","mouseover"]);Oi("onPointerEnter",["pointerout","pointerover"]);Oi("onPointerLeave",["pointerout","pointerover"]);ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ni("onBeforeInput",["compositionend","keypress","textInput","paste"]);ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ex=new Set("cancel close invalid load scroll toggle".split(" ").concat(xr));function Ad(e,t,i){var s=e.type||"unknown-event";e.currentTarget=i,Qg(s,t,void 0,e),e.currentTarget=null}function Tf(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var s=e[i],a=s.event;s=s.listeners;e:{var c=void 0;if(t)for(var d=s.length-1;0<=d;d--){var p=s[d],m=p.instance,g=p.currentTarget;if(p=p.listener,m!==c&&a.isPropagationStopped())break e;Ad(a,p,g),c=m}else for(d=0;d<s.length;d++){if(p=s[d],m=p.instance,g=p.currentTarget,p=p.listener,m!==c&&a.isPropagationStopped())break e;Ad(a,p,g),c=m}}}if(is)throw e=ml,is=!1,ml=null,e}function Se(e,t){var i=t[bl];i===void 0&&(i=t[bl]=new Set);var s=e+"__bubble";i.has(s)||(Pf(t,e,2,!1),i.add(s))}function Ea(e,t,i){var s=0;t&&(s|=4),Pf(i,e,s,t)}var Po="_reactListening"+Math.random().toString(36).slice(2);function Mr(e){if(!e[Po]){e[Po]=!0,Dh.forEach(function(i){i!=="selectionchange"&&(ex.has(i)||Ea(i,!1,e),Ea(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Po]||(t[Po]=!0,Ea("selectionchange",!1,t))}}function Pf(e,t,i,s){switch(df(t)){case 1:var a=pv;break;case 4:a=mv;break;default:a=uc}i=a.bind(null,t,i,e),a=void 0,!pl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),s?a!==void 0?e.addEventListener(t,i,{capture:!0,passive:a}):e.addEventListener(t,i,!0):a!==void 0?e.addEventListener(t,i,{passive:a}):e.addEventListener(t,i,!1)}function za(e,t,i,s,a){var c=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var p=s.stateNode.containerInfo;if(p===a||p.nodeType===8&&p.parentNode===a)break;if(d===4)for(d=s.return;d!==null;){var m=d.tag;if((m===3||m===4)&&(m=d.stateNode.containerInfo,m===a||m.nodeType===8&&m.parentNode===a))return;d=d.return}for(;p!==null;){if(d=Vn(p),d===null)return;if(m=d.tag,m===5||m===6){s=c=d;continue e}p=p.parentNode}}s=s.return}Kh(function(){var g=c,_=sc(i),j=[];e:{var b=kf.get(e);if(b!==void 0){var D=hc,k=e;switch(e){case"keypress":if(qo(i)===0)break e;case"keydown":case"keyup":D=Nv;break;case"focusin":k="focus",D=ka;break;case"focusout":k="blur",D=ka;break;case"beforeblur":case"afterblur":D=ka;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":D=yd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":D=xv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":D=zv;break;case wf:case Cf:case jf:D=Sv;break;case bf:D=Iv;break;case"scroll":D=gv;break;case"wheel":D=Ov;break;case"copy":case"cut":case"paste":D=Cv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":D=Sd}var A=(t&4)!==0,O=!A&&e==="scroll",S=A?b!==null?b+"Capture":null:b;A=[];for(var f=g,w;f!==null;){w=f;var C=w.stateNode;if(w.tag===5&&C!==null&&(w=C,S!==null&&(C=Er(f,S),C!=null&&A.push(Br(f,C,w)))),O)break;f=f.return}0<A.length&&(b=new D(b,k,null,i,_),j.push({event:b,listeners:A}))}}if(!(t&7)){e:{if(b=e==="mouseover"||e==="pointerover",D=e==="mouseout"||e==="pointerout",b&&i!==hl&&(k=i.relatedTarget||i.fromElement)&&(Vn(k)||k[dn]))break e;if((D||b)&&(b=_.window===_?_:(b=_.ownerDocument)?b.defaultView||b.parentWindow:window,D?(k=i.relatedTarget||i.toElement,D=g,k=k?Vn(k):null,k!==null&&(O=ii(k),k!==O||k.tag!==5&&k.tag!==6)&&(k=null)):(D=null,k=g),D!==k)){if(A=yd,C="onMouseLeave",S="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(A=Sd,C="onPointerLeave",S="onPointerEnter",f="pointer"),O=D==null?b:wi(D),w=k==null?b:wi(k),b=new A(C,f+"leave",D,i,_),b.target=O,b.relatedTarget=w,C=null,Vn(_)===g&&(A=new A(S,f+"enter",k,i,_),A.target=w,A.relatedTarget=O,C=A),O=C,D&&k)t:{for(A=D,S=k,f=0,w=A;w;w=mi(w))f++;for(w=0,C=S;C;C=mi(C))w++;for(;0<f-w;)A=mi(A),f--;for(;0<w-f;)S=mi(S),w--;for(;f--;){if(A===S||S!==null&&A===S.alternate)break t;A=mi(A),S=mi(S)}A=null}else A=null;D!==null&&Ed(j,b,D,A,!1),k!==null&&O!==null&&Ed(j,O,k,A,!0)}}e:{if(b=g?wi(g):window,D=b.nodeName&&b.nodeName.toLowerCase(),D==="select"||D==="input"&&b.type==="file")var y=Hv;else if(jd(b))if(vf)y=Jv;else{y=Vv;var z=Zv}else(D=b.nodeName)&&D.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(y=qv);if(y&&(y=y(e,g))){gf(j,y,i,_);break e}z&&z(e,b,g),e==="focusout"&&(z=b._wrapperState)&&z.controlled&&b.type==="number"&&al(b,"number",b.value)}switch(z=g?wi(g):window,e){case"focusin":(jd(z)||z.contentEditable==="true")&&(_i=z,yl=g,Cr=null);break;case"focusout":Cr=yl=_i=null;break;case"mousedown":_l=!0;break;case"contextmenu":case"mouseup":case"dragend":_l=!1,Ld(j,i,_);break;case"selectionchange":if(Yv)break;case"keydown":case"keyup":Ld(j,i,_)}var I;if(pc)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else yi?pf(e,i)&&(B="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(B="onCompositionStart");B&&(ff&&i.locale!=="ko"&&(yi||B!=="onCompositionStart"?B==="onCompositionEnd"&&yi&&(I=hf()):(jn=_,dc="value"in jn?jn.value:jn.textContent,yi=!0)),z=ls(g,B),0<z.length&&(B=new _d(B,e,null,i,_),j.push({event:B,listeners:z}),I?B.data=I:(I=mf(i),I!==null&&(B.data=I)))),(I=Bv?Fv(e,i):Uv(e,i))&&(g=ls(g,"onBeforeInput"),0<g.length&&(_=new _d("onBeforeInput","beforeinput",null,i,_),j.push({event:_,listeners:g}),_.data=I))}Tf(j,t)})}function Br(e,t,i){return{instance:e,listener:t,currentTarget:i}}function ls(e,t){for(var i=t+"Capture",s=[];e!==null;){var a=e,c=a.stateNode;a.tag===5&&c!==null&&(a=c,c=Er(e,i),c!=null&&s.unshift(Br(e,c,a)),c=Er(e,t),c!=null&&s.push(Br(e,c,a))),e=e.return}return s}function mi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ed(e,t,i,s,a){for(var c=t._reactName,d=[];i!==null&&i!==s;){var p=i,m=p.alternate,g=p.stateNode;if(m!==null&&m===s)break;p.tag===5&&g!==null&&(p=g,a?(m=Er(i,c),m!=null&&d.unshift(Br(i,m,p))):a||(m=Er(i,c),m!=null&&d.push(Br(i,m,p)))),i=i.return}d.length!==0&&e.push({event:t,listeners:d})}var tx=/\r\n?/g,nx=/\u0000|\uFFFD/g;function zd(e){return(typeof e=="string"?e:""+e).replace(tx,`
`).replace(nx,"")}function Lo(e,t,i){if(t=zd(t),zd(e)!==t&&i)throw Error(J(425))}function cs(){}var Sl=null,wl=null;function Cl(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var jl=typeof setTimeout=="function"?setTimeout:void 0,ix=typeof clearTimeout=="function"?clearTimeout:void 0,Dd=typeof Promise=="function"?Promise:void 0,rx=typeof queueMicrotask=="function"?queueMicrotask:typeof Dd<"u"?function(e){return Dd.resolve(null).then(e).catch(ox)}:jl;function ox(e){setTimeout(function(){throw e})}function Da(e,t){var i=t,s=0;do{var a=i.nextSibling;if(e.removeChild(i),a&&a.nodeType===8)if(i=a.data,i==="/$"){if(s===0){e.removeChild(a),Ir(t);return}s--}else i!=="$"&&i!=="$?"&&i!=="$!"||s++;i=a}while(i);Ir(t)}function Ln(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Id(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Vi=Math.random().toString(36).slice(2),Jt="__reactFiber$"+Vi,Fr="__reactProps$"+Vi,dn="__reactContainer$"+Vi,bl="__reactEvents$"+Vi,sx="__reactListeners$"+Vi,ax="__reactHandles$"+Vi;function Vn(e){var t=e[Jt];if(t)return t;for(var i=e.parentNode;i;){if(t=i[dn]||i[Jt]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=Id(e);e!==null;){if(i=e[Jt])return i;e=Id(e)}return t}e=i,i=e.parentNode}return null}function Kr(e){return e=e[Jt]||e[dn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function wi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function Ns(e){return e[Fr]||null}var kl=[],Ci=-1;function On(e){return{current:e}}function we(e){0>Ci||(e.current=kl[Ci],kl[Ci]=null,Ci--)}function ye(e,t){Ci++,kl[Ci]=e.current,e.current=t}var In={},Ge=On(In),st=On(!1),Yn=In;function Mi(e,t){var i=e.type.contextTypes;if(!i)return In;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a={},c;for(c in i)a[c]=t[c];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function at(e){return e=e.childContextTypes,e!=null}function us(){we(st),we(Ge)}function Rd(e,t,i){if(Ge.current!==In)throw Error(J(168));ye(Ge,t),ye(st,i)}function Lf(e,t,i){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return i;s=s.getChildContext();for(var a in s)if(!(a in t))throw Error(J(108,Zg(e)||"Unknown",a));return Pe({},i,s)}function ds(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||In,Yn=Ge.current,ye(Ge,e),ye(st,st.current),!0}function Od(e,t,i){var s=e.stateNode;if(!s)throw Error(J(169));i?(e=Lf(e,t,Yn),s.__reactInternalMemoizedMergedChildContext=e,we(st),we(Ge),ye(Ge,e)):we(st),ye(st,i)}var sn=null,As=!1,Ia=!1;function Nf(e){sn===null?sn=[e]:sn.push(e)}function lx(e){As=!0,Nf(e)}function Mn(){if(!Ia&&sn!==null){Ia=!0;var e=0,t=ve;try{var i=sn;for(ve=1;e<i.length;e++){var s=i[e];do s=s(!0);while(s!==null)}sn=null,As=!1}catch(a){throw sn!==null&&(sn=sn.slice(e+1)),ef(ac,Mn),a}finally{ve=t,Ia=!1}}return null}var ji=[],bi=0,hs=null,fs=0,wt=[],Ct=0,Qn=null,an=1,ln="";function Hn(e,t){ji[bi++]=fs,ji[bi++]=hs,hs=e,fs=t}function Af(e,t,i){wt[Ct++]=an,wt[Ct++]=ln,wt[Ct++]=Qn,Qn=e;var s=an;e=ln;var a=32-Mt(s)-1;s&=~(1<<a),i+=1;var c=32-Mt(t)+a;if(30<c){var d=a-a%5;c=(s&(1<<d)-1).toString(32),s>>=d,a-=d,an=1<<32-Mt(t)+a|i<<a|s,ln=c+e}else an=1<<c|i<<a|s,ln=e}function gc(e){e.return!==null&&(Hn(e,1),Af(e,1,0))}function vc(e){for(;e===hs;)hs=ji[--bi],ji[bi]=null,fs=ji[--bi],ji[bi]=null;for(;e===Qn;)Qn=wt[--Ct],wt[Ct]=null,ln=wt[--Ct],wt[Ct]=null,an=wt[--Ct],wt[Ct]=null}var ft=null,ht=null,Ce=!1,Ot=null;function Ef(e,t){var i=jt(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function Md(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ft=e,ht=Ln(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ft=e,ht=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Qn!==null?{id:an,overflow:ln}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=jt(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,ft=e,ht=null,!0):!1;default:return!1}}function Tl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Pl(e){if(Ce){var t=ht;if(t){var i=t;if(!Md(e,t)){if(Tl(e))throw Error(J(418));t=Ln(i.nextSibling);var s=ft;t&&Md(e,t)?Ef(s,i):(e.flags=e.flags&-4097|2,Ce=!1,ft=e)}}else{if(Tl(e))throw Error(J(418));e.flags=e.flags&-4097|2,Ce=!1,ft=e}}}function Bd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ft=e}function No(e){if(e!==ft)return!1;if(!Ce)return Bd(e),Ce=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cl(e.type,e.memoizedProps)),t&&(t=ht)){if(Tl(e))throw zf(),Error(J(418));for(;t;)Ef(e,t),t=Ln(t.nextSibling)}if(Bd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){ht=Ln(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}ht=null}}else ht=ft?Ln(e.stateNode.nextSibling):null;return!0}function zf(){for(var e=ht;e;)e=Ln(e.nextSibling)}function Bi(){ht=ft=null,Ce=!1}function xc(e){Ot===null?Ot=[e]:Ot.push(e)}var cx=pn.ReactCurrentBatchConfig;function dr(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(J(309));var s=i.stateNode}if(!s)throw Error(J(147,e));var a=s,c=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===c?t.ref:(t=function(d){var p=a.refs;d===null?delete p[c]:p[c]=d},t._stringRef=c,t)}if(typeof e!="string")throw Error(J(284));if(!i._owner)throw Error(J(290,e))}return e}function Ao(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Fd(e){var t=e._init;return t(e._payload)}function Df(e){function t(S,f){if(e){var w=S.deletions;w===null?(S.deletions=[f],S.flags|=16):w.push(f)}}function i(S,f){if(!e)return null;for(;f!==null;)t(S,f),f=f.sibling;return null}function s(S,f){for(S=new Map;f!==null;)f.key!==null?S.set(f.key,f):S.set(f.index,f),f=f.sibling;return S}function a(S,f){return S=zn(S,f),S.index=0,S.sibling=null,S}function c(S,f,w){return S.index=w,e?(w=S.alternate,w!==null?(w=w.index,w<f?(S.flags|=2,f):w):(S.flags|=2,f)):(S.flags|=1048576,f)}function d(S){return e&&S.alternate===null&&(S.flags|=2),S}function p(S,f,w,C){return f===null||f.tag!==6?(f=$a(w,S.mode,C),f.return=S,f):(f=a(f,w),f.return=S,f)}function m(S,f,w,C){var y=w.type;return y===xi?_(S,f,w.props.children,C,w.key):f!==null&&(f.elementType===y||typeof y=="object"&&y!==null&&y.$$typeof===xn&&Fd(y)===f.type)?(C=a(f,w.props),C.ref=dr(S,f,w),C.return=S,C):(C=es(w.type,w.key,w.props,null,S.mode,C),C.ref=dr(S,f,w),C.return=S,C)}function g(S,f,w,C){return f===null||f.tag!==4||f.stateNode.containerInfo!==w.containerInfo||f.stateNode.implementation!==w.implementation?(f=Wa(w,S.mode,C),f.return=S,f):(f=a(f,w.children||[]),f.return=S,f)}function _(S,f,w,C,y){return f===null||f.tag!==7?(f=Kn(w,S.mode,C,y),f.return=S,f):(f=a(f,w),f.return=S,f)}function j(S,f,w){if(typeof f=="string"&&f!==""||typeof f=="number")return f=$a(""+f,S.mode,w),f.return=S,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case _o:return w=es(f.type,f.key,f.props,null,S.mode,w),w.ref=dr(S,null,f),w.return=S,w;case vi:return f=Wa(f,S.mode,w),f.return=S,f;case xn:var C=f._init;return j(S,C(f._payload),w)}if(gr(f)||sr(f))return f=Kn(f,S.mode,w,null),f.return=S,f;Ao(S,f)}return null}function b(S,f,w,C){var y=f!==null?f.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return y!==null?null:p(S,f,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case _o:return w.key===y?m(S,f,w,C):null;case vi:return w.key===y?g(S,f,w,C):null;case xn:return y=w._init,b(S,f,y(w._payload),C)}if(gr(w)||sr(w))return y!==null?null:_(S,f,w,C,null);Ao(S,w)}return null}function D(S,f,w,C,y){if(typeof C=="string"&&C!==""||typeof C=="number")return S=S.get(w)||null,p(f,S,""+C,y);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case _o:return S=S.get(C.key===null?w:C.key)||null,m(f,S,C,y);case vi:return S=S.get(C.key===null?w:C.key)||null,g(f,S,C,y);case xn:var z=C._init;return D(S,f,w,z(C._payload),y)}if(gr(C)||sr(C))return S=S.get(w)||null,_(f,S,C,y,null);Ao(f,C)}return null}function k(S,f,w,C){for(var y=null,z=null,I=f,B=f=0,$=null;I!==null&&B<w.length;B++){I.index>B?($=I,I=null):$=I.sibling;var H=b(S,I,w[B],C);if(H===null){I===null&&(I=$);break}e&&I&&H.alternate===null&&t(S,I),f=c(H,f,B),z===null?y=H:z.sibling=H,z=H,I=$}if(B===w.length)return i(S,I),Ce&&Hn(S,B),y;if(I===null){for(;B<w.length;B++)I=j(S,w[B],C),I!==null&&(f=c(I,f,B),z===null?y=I:z.sibling=I,z=I);return Ce&&Hn(S,B),y}for(I=s(S,I);B<w.length;B++)$=D(I,S,B,w[B],C),$!==null&&(e&&$.alternate!==null&&I.delete($.key===null?B:$.key),f=c($,f,B),z===null?y=$:z.sibling=$,z=$);return e&&I.forEach(function(U){return t(S,U)}),Ce&&Hn(S,B),y}function A(S,f,w,C){var y=sr(w);if(typeof y!="function")throw Error(J(150));if(w=y.call(w),w==null)throw Error(J(151));for(var z=y=null,I=f,B=f=0,$=null,H=w.next();I!==null&&!H.done;B++,H=w.next()){I.index>B?($=I,I=null):$=I.sibling;var U=b(S,I,H.value,C);if(U===null){I===null&&(I=$);break}e&&I&&U.alternate===null&&t(S,I),f=c(U,f,B),z===null?y=U:z.sibling=U,z=U,I=$}if(H.done)return i(S,I),Ce&&Hn(S,B),y;if(I===null){for(;!H.done;B++,H=w.next())H=j(S,H.value,C),H!==null&&(f=c(H,f,B),z===null?y=H:z.sibling=H,z=H);return Ce&&Hn(S,B),y}for(I=s(S,I);!H.done;B++,H=w.next())H=D(I,S,B,H.value,C),H!==null&&(e&&H.alternate!==null&&I.delete(H.key===null?B:H.key),f=c(H,f,B),z===null?y=H:z.sibling=H,z=H);return e&&I.forEach(function(F){return t(S,F)}),Ce&&Hn(S,B),y}function O(S,f,w,C){if(typeof w=="object"&&w!==null&&w.type===xi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case _o:e:{for(var y=w.key,z=f;z!==null;){if(z.key===y){if(y=w.type,y===xi){if(z.tag===7){i(S,z.sibling),f=a(z,w.props.children),f.return=S,S=f;break e}}else if(z.elementType===y||typeof y=="object"&&y!==null&&y.$$typeof===xn&&Fd(y)===z.type){i(S,z.sibling),f=a(z,w.props),f.ref=dr(S,z,w),f.return=S,S=f;break e}i(S,z);break}else t(S,z);z=z.sibling}w.type===xi?(f=Kn(w.props.children,S.mode,C,w.key),f.return=S,S=f):(C=es(w.type,w.key,w.props,null,S.mode,C),C.ref=dr(S,f,w),C.return=S,S=C)}return d(S);case vi:e:{for(z=w.key;f!==null;){if(f.key===z)if(f.tag===4&&f.stateNode.containerInfo===w.containerInfo&&f.stateNode.implementation===w.implementation){i(S,f.sibling),f=a(f,w.children||[]),f.return=S,S=f;break e}else{i(S,f);break}else t(S,f);f=f.sibling}f=Wa(w,S.mode,C),f.return=S,S=f}return d(S);case xn:return z=w._init,O(S,f,z(w._payload),C)}if(gr(w))return k(S,f,w,C);if(sr(w))return A(S,f,w,C);Ao(S,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,f!==null&&f.tag===6?(i(S,f.sibling),f=a(f,w),f.return=S,S=f):(i(S,f),f=$a(w,S.mode,C),f.return=S,S=f),d(S)):i(S,f)}return O}var Fi=Df(!0),If=Df(!1),ps=On(null),ms=null,ki=null,yc=null;function _c(){yc=ki=ms=null}function Sc(e){var t=ps.current;we(ps),e._currentValue=t}function Ll(e,t,i){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===i)break;e=e.return}}function Ii(e,t){ms=e,yc=ki=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ot=!0),e.firstContext=null)}function kt(e){var t=e._currentValue;if(yc!==e)if(e={context:e,memoizedValue:t,next:null},ki===null){if(ms===null)throw Error(J(308));ki=e,ms.dependencies={lanes:0,firstContext:e}}else ki=ki.next=e;return t}var qn=null;function wc(e){qn===null?qn=[e]:qn.push(e)}function Rf(e,t,i,s){var a=t.interleaved;return a===null?(i.next=i,wc(t)):(i.next=a.next,a.next=i),t.interleaved=i,hn(e,s)}function hn(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var yn=!1;function Cc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Of(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Nn(e,t,i){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,pe&2){var a=s.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t,hn(e,i)}return a=s.interleaved,a===null?(t.next=t,wc(s)):(t.next=a.next,a.next=t),s.interleaved=t,hn(e,i)}function Jo(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,i|=s,t.lanes=i,lc(e,i)}}function Ud(e,t){var i=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,i===s)){var a=null,c=null;if(i=i.firstBaseUpdate,i!==null){do{var d={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};c===null?a=c=d:c=c.next=d,i=i.next}while(i!==null);c===null?a=c=t:c=c.next=t}else a=c=t;i={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:c,shared:s.shared,effects:s.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function gs(e,t,i,s){var a=e.updateQueue;yn=!1;var c=a.firstBaseUpdate,d=a.lastBaseUpdate,p=a.shared.pending;if(p!==null){a.shared.pending=null;var m=p,g=m.next;m.next=null,d===null?c=g:d.next=g,d=m;var _=e.alternate;_!==null&&(_=_.updateQueue,p=_.lastBaseUpdate,p!==d&&(p===null?_.firstBaseUpdate=g:p.next=g,_.lastBaseUpdate=m))}if(c!==null){var j=a.baseState;d=0,_=g=m=null,p=c;do{var b=p.lane,D=p.eventTime;if((s&b)===b){_!==null&&(_=_.next={eventTime:D,lane:0,tag:p.tag,payload:p.payload,callback:p.callback,next:null});e:{var k=e,A=p;switch(b=t,D=i,A.tag){case 1:if(k=A.payload,typeof k=="function"){j=k.call(D,j,b);break e}j=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=A.payload,b=typeof k=="function"?k.call(D,j,b):k,b==null)break e;j=Pe({},j,b);break e;case 2:yn=!0}}p.callback!==null&&p.lane!==0&&(e.flags|=64,b=a.effects,b===null?a.effects=[p]:b.push(p))}else D={eventTime:D,lane:b,tag:p.tag,payload:p.payload,callback:p.callback,next:null},_===null?(g=_=D,m=j):_=_.next=D,d|=b;if(p=p.next,p===null){if(p=a.shared.pending,p===null)break;b=p,p=b.next,b.next=null,a.lastBaseUpdate=b,a.shared.pending=null}}while(!0);if(_===null&&(m=j),a.baseState=m,a.firstBaseUpdate=g,a.lastBaseUpdate=_,t=a.shared.interleaved,t!==null){a=t;do d|=a.lane,a=a.next;while(a!==t)}else c===null&&(a.shared.lanes=0);ei|=d,e.lanes=d,e.memoizedState=j}}function $d(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],a=s.callback;if(a!==null){if(s.callback=null,s=i,typeof a!="function")throw Error(J(191,a));a.call(s)}}}var Yr={},Yt=On(Yr),Ur=On(Yr),$r=On(Yr);function Jn(e){if(e===Yr)throw Error(J(174));return e}function jc(e,t){switch(ye($r,t),ye(Ur,e),ye(Yt,Yr),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cl(t,e)}we(Yt),ye(Yt,t)}function Ui(){we(Yt),we(Ur),we($r)}function Mf(e){Jn($r.current);var t=Jn(Yt.current),i=cl(t,e.type);t!==i&&(ye(Ur,e),ye(Yt,i))}function bc(e){Ur.current===e&&(we(Yt),we(Ur))}var ke=On(0);function vs(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ra=[];function kc(){for(var e=0;e<Ra.length;e++)Ra[e]._workInProgressVersionPrimary=null;Ra.length=0}var Go=pn.ReactCurrentDispatcher,Oa=pn.ReactCurrentBatchConfig,Xn=0,Te=null,Re=null,Fe=null,xs=!1,jr=!1,Wr=0,ux=0;function Ve(){throw Error(J(321))}function Tc(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Ut(e[i],t[i]))return!1;return!0}function Pc(e,t,i,s,a,c){if(Xn=c,Te=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Go.current=e===null||e.memoizedState===null?px:mx,e=i(s,a),jr){c=0;do{if(jr=!1,Wr=0,25<=c)throw Error(J(301));c+=1,Fe=Re=null,t.updateQueue=null,Go.current=gx,e=i(s,a)}while(jr)}if(Go.current=ys,t=Re!==null&&Re.next!==null,Xn=0,Fe=Re=Te=null,xs=!1,t)throw Error(J(300));return e}function Lc(){var e=Wr!==0;return Wr=0,e}function qt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fe===null?Te.memoizedState=Fe=e:Fe=Fe.next=e,Fe}function Tt(){if(Re===null){var e=Te.alternate;e=e!==null?e.memoizedState:null}else e=Re.next;var t=Fe===null?Te.memoizedState:Fe.next;if(t!==null)Fe=t,Re=e;else{if(e===null)throw Error(J(310));Re=e,e={memoizedState:Re.memoizedState,baseState:Re.baseState,baseQueue:Re.baseQueue,queue:Re.queue,next:null},Fe===null?Te.memoizedState=Fe=e:Fe=Fe.next=e}return Fe}function Hr(e,t){return typeof t=="function"?t(e):t}function Ma(e){var t=Tt(),i=t.queue;if(i===null)throw Error(J(311));i.lastRenderedReducer=e;var s=Re,a=s.baseQueue,c=i.pending;if(c!==null){if(a!==null){var d=a.next;a.next=c.next,c.next=d}s.baseQueue=a=c,i.pending=null}if(a!==null){c=a.next,s=s.baseState;var p=d=null,m=null,g=c;do{var _=g.lane;if((Xn&_)===_)m!==null&&(m=m.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),s=g.hasEagerState?g.eagerState:e(s,g.action);else{var j={lane:_,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};m===null?(p=m=j,d=s):m=m.next=j,Te.lanes|=_,ei|=_}g=g.next}while(g!==null&&g!==c);m===null?d=s:m.next=p,Ut(s,t.memoizedState)||(ot=!0),t.memoizedState=s,t.baseState=d,t.baseQueue=m,i.lastRenderedState=s}if(e=i.interleaved,e!==null){a=e;do c=a.lane,Te.lanes|=c,ei|=c,a=a.next;while(a!==e)}else a===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Ba(e){var t=Tt(),i=t.queue;if(i===null)throw Error(J(311));i.lastRenderedReducer=e;var s=i.dispatch,a=i.pending,c=t.memoizedState;if(a!==null){i.pending=null;var d=a=a.next;do c=e(c,d.action),d=d.next;while(d!==a);Ut(c,t.memoizedState)||(ot=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),i.lastRenderedState=c}return[c,s]}function Bf(){}function Ff(e,t){var i=Te,s=Tt(),a=t(),c=!Ut(s.memoizedState,a);if(c&&(s.memoizedState=a,ot=!0),s=s.queue,Nc(Wf.bind(null,i,s,e),[e]),s.getSnapshot!==t||c||Fe!==null&&Fe.memoizedState.tag&1){if(i.flags|=2048,Zr(9,$f.bind(null,i,s,a,t),void 0,null),Ue===null)throw Error(J(349));Xn&30||Uf(i,t,a)}return a}function Uf(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=Te.updateQueue,t===null?(t={lastEffect:null,stores:null},Te.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function $f(e,t,i,s){t.value=i,t.getSnapshot=s,Hf(t)&&Zf(e)}function Wf(e,t,i){return i(function(){Hf(t)&&Zf(e)})}function Hf(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Ut(e,i)}catch{return!0}}function Zf(e){var t=hn(e,1);t!==null&&Bt(t,e,1,-1)}function Wd(e){var t=qt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:e},t.queue=e,e=e.dispatch=fx.bind(null,Te,e),[t.memoizedState,e]}function Zr(e,t,i,s){return e={tag:e,create:t,destroy:i,deps:s,next:null},t=Te.updateQueue,t===null?(t={lastEffect:null,stores:null},Te.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(s=i.next,i.next=e,e.next=s,t.lastEffect=e)),e}function Vf(){return Tt().memoizedState}function Ko(e,t,i,s){var a=qt();Te.flags|=e,a.memoizedState=Zr(1|t,i,void 0,s===void 0?null:s)}function Es(e,t,i,s){var a=Tt();s=s===void 0?null:s;var c=void 0;if(Re!==null){var d=Re.memoizedState;if(c=d.destroy,s!==null&&Tc(s,d.deps)){a.memoizedState=Zr(t,i,c,s);return}}Te.flags|=e,a.memoizedState=Zr(1|t,i,c,s)}function Hd(e,t){return Ko(8390656,8,e,t)}function Nc(e,t){return Es(2048,8,e,t)}function qf(e,t){return Es(4,2,e,t)}function Jf(e,t){return Es(4,4,e,t)}function Gf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Kf(e,t,i){return i=i!=null?i.concat([e]):null,Es(4,4,Gf.bind(null,t,e),i)}function Ac(){}function Yf(e,t){var i=Tt();t=t===void 0?null:t;var s=i.memoizedState;return s!==null&&t!==null&&Tc(t,s[1])?s[0]:(i.memoizedState=[e,t],e)}function Qf(e,t){var i=Tt();t=t===void 0?null:t;var s=i.memoizedState;return s!==null&&t!==null&&Tc(t,s[1])?s[0]:(e=e(),i.memoizedState=[e,t],e)}function Xf(e,t,i){return Xn&21?(Ut(i,t)||(i=rf(),Te.lanes|=i,ei|=i,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ot=!0),e.memoizedState=i)}function dx(e,t){var i=ve;ve=i!==0&&4>i?i:4,e(!0);var s=Oa.transition;Oa.transition={};try{e(!1),t()}finally{ve=i,Oa.transition=s}}function ep(){return Tt().memoizedState}function hx(e,t,i){var s=En(e);if(i={lane:s,action:i,hasEagerState:!1,eagerState:null,next:null},tp(e))np(t,i);else if(i=Rf(e,t,i,s),i!==null){var a=Qe();Bt(i,e,s,a),ip(i,t,s)}}function fx(e,t,i){var s=En(e),a={lane:s,action:i,hasEagerState:!1,eagerState:null,next:null};if(tp(e))np(t,a);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var d=t.lastRenderedState,p=c(d,i);if(a.hasEagerState=!0,a.eagerState=p,Ut(p,d)){var m=t.interleaved;m===null?(a.next=a,wc(t)):(a.next=m.next,m.next=a),t.interleaved=a;return}}catch{}finally{}i=Rf(e,t,a,s),i!==null&&(a=Qe(),Bt(i,e,s,a),ip(i,t,s))}}function tp(e){var t=e.alternate;return e===Te||t!==null&&t===Te}function np(e,t){jr=xs=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function ip(e,t,i){if(i&4194240){var s=t.lanes;s&=e.pendingLanes,i|=s,t.lanes=i,lc(e,i)}}var ys={readContext:kt,useCallback:Ve,useContext:Ve,useEffect:Ve,useImperativeHandle:Ve,useInsertionEffect:Ve,useLayoutEffect:Ve,useMemo:Ve,useReducer:Ve,useRef:Ve,useState:Ve,useDebugValue:Ve,useDeferredValue:Ve,useTransition:Ve,useMutableSource:Ve,useSyncExternalStore:Ve,useId:Ve,unstable_isNewReconciler:!1},px={readContext:kt,useCallback:function(e,t){return qt().memoizedState=[e,t===void 0?null:t],e},useContext:kt,useEffect:Hd,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,Ko(4194308,4,Gf.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Ko(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ko(4,2,e,t)},useMemo:function(e,t){var i=qt();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var s=qt();return t=i!==void 0?i(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=hx.bind(null,Te,e),[s.memoizedState,e]},useRef:function(e){var t=qt();return e={current:e},t.memoizedState=e},useState:Wd,useDebugValue:Ac,useDeferredValue:function(e){return qt().memoizedState=e},useTransition:function(){var e=Wd(!1),t=e[0];return e=dx.bind(null,e[1]),qt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var s=Te,a=qt();if(Ce){if(i===void 0)throw Error(J(407));i=i()}else{if(i=t(),Ue===null)throw Error(J(349));Xn&30||Uf(s,t,i)}a.memoizedState=i;var c={value:i,getSnapshot:t};return a.queue=c,Hd(Wf.bind(null,s,c,e),[e]),s.flags|=2048,Zr(9,$f.bind(null,s,c,i,t),void 0,null),i},useId:function(){var e=qt(),t=Ue.identifierPrefix;if(Ce){var i=ln,s=an;i=(s&~(1<<32-Mt(s)-1)).toString(32)+i,t=":"+t+"R"+i,i=Wr++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=ux++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},mx={readContext:kt,useCallback:Yf,useContext:kt,useEffect:Nc,useImperativeHandle:Kf,useInsertionEffect:qf,useLayoutEffect:Jf,useMemo:Qf,useReducer:Ma,useRef:Vf,useState:function(){return Ma(Hr)},useDebugValue:Ac,useDeferredValue:function(e){var t=Tt();return Xf(t,Re.memoizedState,e)},useTransition:function(){var e=Ma(Hr)[0],t=Tt().memoizedState;return[e,t]},useMutableSource:Bf,useSyncExternalStore:Ff,useId:ep,unstable_isNewReconciler:!1},gx={readContext:kt,useCallback:Yf,useContext:kt,useEffect:Nc,useImperativeHandle:Kf,useInsertionEffect:qf,useLayoutEffect:Jf,useMemo:Qf,useReducer:Ba,useRef:Vf,useState:function(){return Ba(Hr)},useDebugValue:Ac,useDeferredValue:function(e){var t=Tt();return Re===null?t.memoizedState=e:Xf(t,Re.memoizedState,e)},useTransition:function(){var e=Ba(Hr)[0],t=Tt().memoizedState;return[e,t]},useMutableSource:Bf,useSyncExternalStore:Ff,useId:ep,unstable_isNewReconciler:!1};function Dt(e,t){if(e&&e.defaultProps){t=Pe({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function Nl(e,t,i,s){t=e.memoizedState,i=i(s,t),i=i==null?t:Pe({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var zs={isMounted:function(e){return(e=e._reactInternals)?ii(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var s=Qe(),a=En(e),c=cn(s,a);c.payload=t,i!=null&&(c.callback=i),t=Nn(e,c,a),t!==null&&(Bt(t,e,a,s),Jo(t,e,a))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var s=Qe(),a=En(e),c=cn(s,a);c.tag=1,c.payload=t,i!=null&&(c.callback=i),t=Nn(e,c,a),t!==null&&(Bt(t,e,a,s),Jo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Qe(),s=En(e),a=cn(i,s);a.tag=2,t!=null&&(a.callback=t),t=Nn(e,a,s),t!==null&&(Bt(t,e,s,i),Jo(t,e,s))}};function Zd(e,t,i,s,a,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,d):t.prototype&&t.prototype.isPureReactComponent?!Or(i,s)||!Or(a,c):!0}function rp(e,t,i){var s=!1,a=In,c=t.contextType;return typeof c=="object"&&c!==null?c=kt(c):(a=at(t)?Yn:Ge.current,s=t.contextTypes,c=(s=s!=null)?Mi(e,a):In),t=new t(i,c),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=zs,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=c),t}function Vd(e,t,i,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,s),t.state!==e&&zs.enqueueReplaceState(t,t.state,null)}function Al(e,t,i,s){var a=e.stateNode;a.props=i,a.state=e.memoizedState,a.refs={},Cc(e);var c=t.contextType;typeof c=="object"&&c!==null?a.context=kt(c):(c=at(t)?Yn:Ge.current,a.context=Mi(e,c)),a.state=e.memoizedState,c=t.getDerivedStateFromProps,typeof c=="function"&&(Nl(e,t,c,i),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&zs.enqueueReplaceState(a,a.state,null),gs(e,i,a,s),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function $i(e,t){try{var i="",s=t;do i+=Hg(s),s=s.return;while(s);var a=i}catch(c){a=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:t,stack:a,digest:null}}function Fa(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function El(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var vx=typeof WeakMap=="function"?WeakMap:Map;function op(e,t,i){i=cn(-1,i),i.tag=3,i.payload={element:null};var s=t.value;return i.callback=function(){Ss||(Ss=!0,$l=s),El(e,t)},i}function sp(e,t,i){i=cn(-1,i),i.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var a=t.value;i.payload=function(){return s(a)},i.callback=function(){El(e,t)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(i.callback=function(){El(e,t),typeof s!="function"&&(An===null?An=new Set([this]):An.add(this));var d=t.stack;this.componentDidCatch(t.value,{componentStack:d!==null?d:""})}),i}function qd(e,t,i){var s=e.pingCache;if(s===null){s=e.pingCache=new vx;var a=new Set;s.set(t,a)}else a=s.get(t),a===void 0&&(a=new Set,s.set(t,a));a.has(i)||(a.add(i),e=Ax.bind(null,e,t,i),t.then(e,e))}function Jd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Gd(e,t,i,s,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=cn(-1,1),t.tag=2,Nn(i,t,1))),i.lanes|=1),e)}var xx=pn.ReactCurrentOwner,ot=!1;function Ye(e,t,i,s){t.child=e===null?If(t,null,i,s):Fi(t,e.child,i,s)}function Kd(e,t,i,s,a){i=i.render;var c=t.ref;return Ii(t,a),s=Pc(e,t,i,s,c,a),i=Lc(),e!==null&&!ot?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,fn(e,t,a)):(Ce&&i&&gc(t),t.flags|=1,Ye(e,t,s,a),t.child)}function Yd(e,t,i,s,a){if(e===null){var c=i.type;return typeof c=="function"&&!Bc(c)&&c.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=c,ap(e,t,c,s,a)):(e=es(i.type,null,s,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!(e.lanes&a)){var d=c.memoizedProps;if(i=i.compare,i=i!==null?i:Or,i(d,s)&&e.ref===t.ref)return fn(e,t,a)}return t.flags|=1,e=zn(c,s),e.ref=t.ref,e.return=t,t.child=e}function ap(e,t,i,s,a){if(e!==null){var c=e.memoizedProps;if(Or(c,s)&&e.ref===t.ref)if(ot=!1,t.pendingProps=s=c,(e.lanes&a)!==0)e.flags&131072&&(ot=!0);else return t.lanes=e.lanes,fn(e,t,a)}return zl(e,t,i,s,a)}function lp(e,t,i){var s=t.pendingProps,a=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ye(Pi,dt),dt|=i;else{if(!(i&1073741824))return e=c!==null?c.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ye(Pi,dt),dt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=c!==null?c.baseLanes:i,ye(Pi,dt),dt|=s}else c!==null?(s=c.baseLanes|i,t.memoizedState=null):s=i,ye(Pi,dt),dt|=s;return Ye(e,t,a,i),t.child}function cp(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function zl(e,t,i,s,a){var c=at(i)?Yn:Ge.current;return c=Mi(t,c),Ii(t,a),i=Pc(e,t,i,s,c,a),s=Lc(),e!==null&&!ot?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,fn(e,t,a)):(Ce&&s&&gc(t),t.flags|=1,Ye(e,t,i,a),t.child)}function Qd(e,t,i,s,a){if(at(i)){var c=!0;ds(t)}else c=!1;if(Ii(t,a),t.stateNode===null)Yo(e,t),rp(t,i,s),Al(t,i,s,a),s=!0;else if(e===null){var d=t.stateNode,p=t.memoizedProps;d.props=p;var m=d.context,g=i.contextType;typeof g=="object"&&g!==null?g=kt(g):(g=at(i)?Yn:Ge.current,g=Mi(t,g));var _=i.getDerivedStateFromProps,j=typeof _=="function"||typeof d.getSnapshotBeforeUpdate=="function";j||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(p!==s||m!==g)&&Vd(t,d,s,g),yn=!1;var b=t.memoizedState;d.state=b,gs(t,s,d,a),m=t.memoizedState,p!==s||b!==m||st.current||yn?(typeof _=="function"&&(Nl(t,i,_,s),m=t.memoizedState),(p=yn||Zd(t,i,p,s,b,m,g))?(j||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=m),d.props=s,d.state=m,d.context=g,s=p):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{d=t.stateNode,Of(e,t),p=t.memoizedProps,g=t.type===t.elementType?p:Dt(t.type,p),d.props=g,j=t.pendingProps,b=d.context,m=i.contextType,typeof m=="object"&&m!==null?m=kt(m):(m=at(i)?Yn:Ge.current,m=Mi(t,m));var D=i.getDerivedStateFromProps;(_=typeof D=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(p!==j||b!==m)&&Vd(t,d,s,m),yn=!1,b=t.memoizedState,d.state=b,gs(t,s,d,a);var k=t.memoizedState;p!==j||b!==k||st.current||yn?(typeof D=="function"&&(Nl(t,i,D,s),k=t.memoizedState),(g=yn||Zd(t,i,g,s,b,k,m)||!1)?(_||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(s,k,m),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(s,k,m)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||p===e.memoizedProps&&b===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&b===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=k),d.props=s,d.state=k,d.context=m,s=g):(typeof d.componentDidUpdate!="function"||p===e.memoizedProps&&b===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&b===e.memoizedState||(t.flags|=1024),s=!1)}return Dl(e,t,i,s,c,a)}function Dl(e,t,i,s,a,c){cp(e,t);var d=(t.flags&128)!==0;if(!s&&!d)return a&&Od(t,i,!1),fn(e,t,c);s=t.stateNode,xx.current=t;var p=d&&typeof i.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&d?(t.child=Fi(t,e.child,null,c),t.child=Fi(t,null,p,c)):Ye(e,t,p,c),t.memoizedState=s.state,a&&Od(t,i,!0),t.child}function up(e){var t=e.stateNode;t.pendingContext?Rd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Rd(e,t.context,!1),jc(e,t.containerInfo)}function Xd(e,t,i,s,a){return Bi(),xc(a),t.flags|=256,Ye(e,t,i,s),t.child}var Il={dehydrated:null,treeContext:null,retryLane:0};function Rl(e){return{baseLanes:e,cachePool:null,transitions:null}}function dp(e,t,i){var s=t.pendingProps,a=ke.current,c=!1,d=(t.flags&128)!==0,p;if((p=d)||(p=e!==null&&e.memoizedState===null?!1:(a&2)!==0),p?(c=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ye(ke,a&1),e===null)return Pl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(d=s.children,e=s.fallback,c?(s=t.mode,c=t.child,d={mode:"hidden",children:d},!(s&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=Rs(d,s,0,null),e=Kn(e,s,i,null),c.return=t,e.return=t,c.sibling=e,t.child=c,t.child.memoizedState=Rl(i),t.memoizedState=Il,e):Ec(t,d));if(a=e.memoizedState,a!==null&&(p=a.dehydrated,p!==null))return yx(e,t,d,s,p,a,i);if(c){c=s.fallback,d=t.mode,a=e.child,p=a.sibling;var m={mode:"hidden",children:s.children};return!(d&1)&&t.child!==a?(s=t.child,s.childLanes=0,s.pendingProps=m,t.deletions=null):(s=zn(a,m),s.subtreeFlags=a.subtreeFlags&14680064),p!==null?c=zn(p,c):(c=Kn(c,d,i,null),c.flags|=2),c.return=t,s.return=t,s.sibling=c,t.child=s,s=c,c=t.child,d=e.child.memoizedState,d=d===null?Rl(i):{baseLanes:d.baseLanes|i,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=e.childLanes&~i,t.memoizedState=Il,s}return c=e.child,e=c.sibling,s=zn(c,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=i),s.return=t,s.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=s,t.memoizedState=null,s}function Ec(e,t){return t=Rs({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Eo(e,t,i,s){return s!==null&&xc(s),Fi(t,e.child,null,i),e=Ec(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function yx(e,t,i,s,a,c,d){if(i)return t.flags&256?(t.flags&=-257,s=Fa(Error(J(422))),Eo(e,t,d,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(c=s.fallback,a=t.mode,s=Rs({mode:"visible",children:s.children},a,0,null),c=Kn(c,a,d,null),c.flags|=2,s.return=t,c.return=t,s.sibling=c,t.child=s,t.mode&1&&Fi(t,e.child,null,d),t.child.memoizedState=Rl(d),t.memoizedState=Il,c);if(!(t.mode&1))return Eo(e,t,d,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var p=s.dgst;return s=p,c=Error(J(419)),s=Fa(c,s,void 0),Eo(e,t,d,s)}if(p=(d&e.childLanes)!==0,ot||p){if(s=Ue,s!==null){switch(d&-d){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|d)?0:a,a!==0&&a!==c.retryLane&&(c.retryLane=a,hn(e,a),Bt(s,e,a,-1))}return Mc(),s=Fa(Error(J(421))),Eo(e,t,d,s)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Ex.bind(null,e),a._reactRetry=t,null):(e=c.treeContext,ht=Ln(a.nextSibling),ft=t,Ce=!0,Ot=null,e!==null&&(wt[Ct++]=an,wt[Ct++]=ln,wt[Ct++]=Qn,an=e.id,ln=e.overflow,Qn=t),t=Ec(t,s.children),t.flags|=4096,t)}function eh(e,t,i){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Ll(e.return,t,i)}function Ua(e,t,i,s,a){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:i,tailMode:a}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=i,c.tailMode=a)}function hp(e,t,i){var s=t.pendingProps,a=s.revealOrder,c=s.tail;if(Ye(e,t,s.children,i),s=ke.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&eh(e,i,t);else if(e.tag===19)eh(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(ye(ke,s),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(i=t.child,a=null;i!==null;)e=i.alternate,e!==null&&vs(e)===null&&(a=i),i=i.sibling;i=a,i===null?(a=t.child,t.child=null):(a=i.sibling,i.sibling=null),Ua(t,!1,a,i,c);break;case"backwards":for(i=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&vs(e)===null){t.child=a;break}e=a.sibling,a.sibling=i,i=a,a=e}Ua(t,!0,i,null,c);break;case"together":Ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fn(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),ei|=t.lanes,!(i&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,i=zn(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=zn(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function _x(e,t,i){switch(t.tag){case 3:up(t),Bi();break;case 5:Mf(t);break;case 1:at(t.type)&&ds(t);break;case 4:jc(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;ye(ps,s._currentValue),s._currentValue=a;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(ye(ke,ke.current&1),t.flags|=128,null):i&t.child.childLanes?dp(e,t,i):(ye(ke,ke.current&1),e=fn(e,t,i),e!==null?e.sibling:null);ye(ke,ke.current&1);break;case 19:if(s=(i&t.childLanes)!==0,e.flags&128){if(s)return hp(e,t,i);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ye(ke,ke.current),s)break;return null;case 22:case 23:return t.lanes=0,lp(e,t,i)}return fn(e,t,i)}var fp,Ol,pp,mp;fp=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Ol=function(){};pp=function(e,t,i,s){var a=e.memoizedProps;if(a!==s){e=t.stateNode,Jn(Yt.current);var c=null;switch(i){case"input":a=ol(e,a),s=ol(e,s),c=[];break;case"select":a=Pe({},a,{value:void 0}),s=Pe({},s,{value:void 0}),c=[];break;case"textarea":a=ll(e,a),s=ll(e,s),c=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=cs)}ul(i,s);var d;i=null;for(g in a)if(!s.hasOwnProperty(g)&&a.hasOwnProperty(g)&&a[g]!=null)if(g==="style"){var p=a[g];for(d in p)p.hasOwnProperty(d)&&(i||(i={}),i[d]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Nr.hasOwnProperty(g)?c||(c=[]):(c=c||[]).push(g,null));for(g in s){var m=s[g];if(p=a!=null?a[g]:void 0,s.hasOwnProperty(g)&&m!==p&&(m!=null||p!=null))if(g==="style")if(p){for(d in p)!p.hasOwnProperty(d)||m&&m.hasOwnProperty(d)||(i||(i={}),i[d]="");for(d in m)m.hasOwnProperty(d)&&p[d]!==m[d]&&(i||(i={}),i[d]=m[d])}else i||(c||(c=[]),c.push(g,i)),i=m;else g==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,p=p?p.__html:void 0,m!=null&&p!==m&&(c=c||[]).push(g,m)):g==="children"?typeof m!="string"&&typeof m!="number"||(c=c||[]).push(g,""+m):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(Nr.hasOwnProperty(g)?(m!=null&&g==="onScroll"&&Se("scroll",e),c||p===m||(c=[])):(c=c||[]).push(g,m))}i&&(c=c||[]).push("style",i);var g=c;(t.updateQueue=g)&&(t.flags|=4)}};mp=function(e,t,i,s){i!==s&&(t.flags|=4)};function hr(e,t){if(!Ce)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function qe(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,s=0;if(t)for(var a=e.child;a!==null;)i|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)i|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=s,e.childLanes=i,t}function Sx(e,t,i){var s=t.pendingProps;switch(vc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qe(t),null;case 1:return at(t.type)&&us(),qe(t),null;case 3:return s=t.stateNode,Ui(),we(st),we(Ge),kc(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(No(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ot!==null&&(Zl(Ot),Ot=null))),Ol(e,t),qe(t),null;case 5:bc(t);var a=Jn($r.current);if(i=t.type,e!==null&&t.stateNode!=null)pp(e,t,i,s,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(J(166));return qe(t),null}if(e=Jn(Yt.current),No(t)){s=t.stateNode,i=t.type;var c=t.memoizedProps;switch(s[Jt]=t,s[Fr]=c,e=(t.mode&1)!==0,i){case"dialog":Se("cancel",s),Se("close",s);break;case"iframe":case"object":case"embed":Se("load",s);break;case"video":case"audio":for(a=0;a<xr.length;a++)Se(xr[a],s);break;case"source":Se("error",s);break;case"img":case"image":case"link":Se("error",s),Se("load",s);break;case"details":Se("toggle",s);break;case"input":cd(s,c),Se("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!c.multiple},Se("invalid",s);break;case"textarea":dd(s,c),Se("invalid",s)}ul(i,c),a=null;for(var d in c)if(c.hasOwnProperty(d)){var p=c[d];d==="children"?typeof p=="string"?s.textContent!==p&&(c.suppressHydrationWarning!==!0&&Lo(s.textContent,p,e),a=["children",p]):typeof p=="number"&&s.textContent!==""+p&&(c.suppressHydrationWarning!==!0&&Lo(s.textContent,p,e),a=["children",""+p]):Nr.hasOwnProperty(d)&&p!=null&&d==="onScroll"&&Se("scroll",s)}switch(i){case"input":So(s),ud(s,c,!0);break;case"textarea":So(s),hd(s);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(s.onclick=cs)}s=a,t.updateQueue=s,s!==null&&(t.flags|=4)}else{d=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$h(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=d.createElement(i,{is:s.is}):(e=d.createElement(i),i==="select"&&(d=e,s.multiple?d.multiple=!0:s.size&&(d.size=s.size))):e=d.createElementNS(e,i),e[Jt]=t,e[Fr]=s,fp(e,t,!1,!1),t.stateNode=e;e:{switch(d=dl(i,s),i){case"dialog":Se("cancel",e),Se("close",e),a=s;break;case"iframe":case"object":case"embed":Se("load",e),a=s;break;case"video":case"audio":for(a=0;a<xr.length;a++)Se(xr[a],e);a=s;break;case"source":Se("error",e),a=s;break;case"img":case"image":case"link":Se("error",e),Se("load",e),a=s;break;case"details":Se("toggle",e),a=s;break;case"input":cd(e,s),a=ol(e,s),Se("invalid",e);break;case"option":a=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},a=Pe({},s,{value:void 0}),Se("invalid",e);break;case"textarea":dd(e,s),a=ll(e,s),Se("invalid",e);break;default:a=s}ul(i,a),p=a;for(c in p)if(p.hasOwnProperty(c)){var m=p[c];c==="style"?Zh(e,m):c==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&Wh(e,m)):c==="children"?typeof m=="string"?(i!=="textarea"||m!=="")&&Ar(e,m):typeof m=="number"&&Ar(e,""+m):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Nr.hasOwnProperty(c)?m!=null&&c==="onScroll"&&Se("scroll",e):m!=null&&nc(e,c,m,d))}switch(i){case"input":So(e),ud(e,s,!1);break;case"textarea":So(e),hd(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Dn(s.value));break;case"select":e.multiple=!!s.multiple,c=s.value,c!=null?Ai(e,!!s.multiple,c,!1):s.defaultValue!=null&&Ai(e,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=cs)}switch(i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return qe(t),null;case 6:if(e&&t.stateNode!=null)mp(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(J(166));if(i=Jn($r.current),Jn(Yt.current),No(t)){if(s=t.stateNode,i=t.memoizedProps,s[Jt]=t,(c=s.nodeValue!==i)&&(e=ft,e!==null))switch(e.tag){case 3:Lo(s.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Lo(s.nodeValue,i,(e.mode&1)!==0)}c&&(t.flags|=4)}else s=(i.nodeType===9?i:i.ownerDocument).createTextNode(s),s[Jt]=t,t.stateNode=s}return qe(t),null;case 13:if(we(ke),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ce&&ht!==null&&t.mode&1&&!(t.flags&128))zf(),Bi(),t.flags|=98560,c=!1;else if(c=No(t),s!==null&&s.dehydrated!==null){if(e===null){if(!c)throw Error(J(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(J(317));c[Jt]=t}else Bi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;qe(t),c=!1}else Ot!==null&&(Zl(Ot),Ot=null),c=!0;if(!c)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||ke.current&1?Oe===0&&(Oe=3):Mc())),t.updateQueue!==null&&(t.flags|=4),qe(t),null);case 4:return Ui(),Ol(e,t),e===null&&Mr(t.stateNode.containerInfo),qe(t),null;case 10:return Sc(t.type._context),qe(t),null;case 17:return at(t.type)&&us(),qe(t),null;case 19:if(we(ke),c=t.memoizedState,c===null)return qe(t),null;if(s=(t.flags&128)!==0,d=c.rendering,d===null)if(s)hr(c,!1);else{if(Oe!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(d=vs(e),d!==null){for(t.flags|=128,hr(c,!1),s=d.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=i,i=t.child;i!==null;)c=i,e=s,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,e=d.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return ye(ke,ke.current&1|2),t.child}e=e.sibling}c.tail!==null&&Ee()>Wi&&(t.flags|=128,s=!0,hr(c,!1),t.lanes=4194304)}else{if(!s)if(e=vs(d),e!==null){if(t.flags|=128,s=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),hr(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!Ce)return qe(t),null}else 2*Ee()-c.renderingStartTime>Wi&&i!==1073741824&&(t.flags|=128,s=!0,hr(c,!1),t.lanes=4194304);c.isBackwards?(d.sibling=t.child,t.child=d):(i=c.last,i!==null?i.sibling=d:t.child=d,c.last=d)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Ee(),t.sibling=null,i=ke.current,ye(ke,s?i&1|2:i&1),t):(qe(t),null);case 22:case 23:return Oc(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?dt&1073741824&&(qe(t),t.subtreeFlags&6&&(t.flags|=8192)):qe(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function wx(e,t){switch(vc(t),t.tag){case 1:return at(t.type)&&us(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ui(),we(st),we(Ge),kc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bc(t),null;case 13:if(we(ke),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));Bi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return we(ke),null;case 4:return Ui(),null;case 10:return Sc(t.type._context),null;case 22:case 23:return Oc(),null;case 24:return null;default:return null}}var zo=!1,Je=!1,Cx=typeof WeakSet=="function"?WeakSet:Set,X=null;function Ti(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(s){Le(e,t,s)}else i.current=null}function Ml(e,t,i){try{i()}catch(s){Le(e,t,s)}}var th=!1;function jx(e,t){if(Sl=ss,e=_f(),mc(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var s=i.getSelection&&i.getSelection();if(s&&s.rangeCount!==0){i=s.anchorNode;var a=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{i.nodeType,c.nodeType}catch{i=null;break e}var d=0,p=-1,m=-1,g=0,_=0,j=e,b=null;t:for(;;){for(var D;j!==i||a!==0&&j.nodeType!==3||(p=d+a),j!==c||s!==0&&j.nodeType!==3||(m=d+s),j.nodeType===3&&(d+=j.nodeValue.length),(D=j.firstChild)!==null;)b=j,j=D;for(;;){if(j===e)break t;if(b===i&&++g===a&&(p=d),b===c&&++_===s&&(m=d),(D=j.nextSibling)!==null)break;j=b,b=j.parentNode}j=D}i=p===-1||m===-1?null:{start:p,end:m}}else i=null}i=i||{start:0,end:0}}else i=null;for(wl={focusedElem:e,selectionRange:i},ss=!1,X=t;X!==null;)if(t=X,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,X=e;else for(;X!==null;){t=X;try{var k=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var A=k.memoizedProps,O=k.memoizedState,S=t.stateNode,f=S.getSnapshotBeforeUpdate(t.elementType===t.type?A:Dt(t.type,A),O);S.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(C){Le(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,X=e;break}X=t.return}return k=th,th=!1,k}function br(e,t,i){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var c=a.destroy;a.destroy=void 0,c!==void 0&&Ml(t,i,c)}a=a.next}while(a!==s)}}function Ds(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var s=i.create;i.destroy=s()}i=i.next}while(i!==t)}}function Bl(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function gp(e){var t=e.alternate;t!==null&&(e.alternate=null,gp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Jt],delete t[Fr],delete t[bl],delete t[sx],delete t[ax])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function vp(e){return e.tag===5||e.tag===3||e.tag===4}function nh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||vp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fl(e,t,i){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=cs));else if(s!==4&&(e=e.child,e!==null))for(Fl(e,t,i),e=e.sibling;e!==null;)Fl(e,t,i),e=e.sibling}function Ul(e,t,i){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Ul(e,t,i),e=e.sibling;e!==null;)Ul(e,t,i),e=e.sibling}var We=null,Rt=!1;function vn(e,t,i){for(i=i.child;i!==null;)xp(e,t,i),i=i.sibling}function xp(e,t,i){if(Kt&&typeof Kt.onCommitFiberUnmount=="function")try{Kt.onCommitFiberUnmount(ks,i)}catch{}switch(i.tag){case 5:Je||Ti(i,t);case 6:var s=We,a=Rt;We=null,vn(e,t,i),We=s,Rt=a,We!==null&&(Rt?(e=We,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):We.removeChild(i.stateNode));break;case 18:We!==null&&(Rt?(e=We,i=i.stateNode,e.nodeType===8?Da(e.parentNode,i):e.nodeType===1&&Da(e,i),Ir(e)):Da(We,i.stateNode));break;case 4:s=We,a=Rt,We=i.stateNode.containerInfo,Rt=!0,vn(e,t,i),We=s,Rt=a;break;case 0:case 11:case 14:case 15:if(!Je&&(s=i.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var c=a,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&Ml(i,t,d),a=a.next}while(a!==s)}vn(e,t,i);break;case 1:if(!Je&&(Ti(i,t),s=i.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=i.memoizedProps,s.state=i.memoizedState,s.componentWillUnmount()}catch(p){Le(i,t,p)}vn(e,t,i);break;case 21:vn(e,t,i);break;case 22:i.mode&1?(Je=(s=Je)||i.memoizedState!==null,vn(e,t,i),Je=s):vn(e,t,i);break;default:vn(e,t,i)}}function ih(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Cx),t.forEach(function(s){var a=zx.bind(null,e,s);i.has(s)||(i.add(s),s.then(a,a))})}}function Et(e,t){var i=t.deletions;if(i!==null)for(var s=0;s<i.length;s++){var a=i[s];try{var c=e,d=t,p=d;e:for(;p!==null;){switch(p.tag){case 5:We=p.stateNode,Rt=!1;break e;case 3:We=p.stateNode.containerInfo,Rt=!0;break e;case 4:We=p.stateNode.containerInfo,Rt=!0;break e}p=p.return}if(We===null)throw Error(J(160));xp(c,d,a),We=null,Rt=!1;var m=a.alternate;m!==null&&(m.return=null),a.return=null}catch(g){Le(a,t,g)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)yp(t,e),t=t.sibling}function yp(e,t){var i=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Et(t,e),Vt(e),s&4){try{br(3,e,e.return),Ds(3,e)}catch(A){Le(e,e.return,A)}try{br(5,e,e.return)}catch(A){Le(e,e.return,A)}}break;case 1:Et(t,e),Vt(e),s&512&&i!==null&&Ti(i,i.return);break;case 5:if(Et(t,e),Vt(e),s&512&&i!==null&&Ti(i,i.return),e.flags&32){var a=e.stateNode;try{Ar(a,"")}catch(A){Le(e,e.return,A)}}if(s&4&&(a=e.stateNode,a!=null)){var c=e.memoizedProps,d=i!==null?i.memoizedProps:c,p=e.type,m=e.updateQueue;if(e.updateQueue=null,m!==null)try{p==="input"&&c.type==="radio"&&c.name!=null&&Fh(a,c),dl(p,d);var g=dl(p,c);for(d=0;d<m.length;d+=2){var _=m[d],j=m[d+1];_==="style"?Zh(a,j):_==="dangerouslySetInnerHTML"?Wh(a,j):_==="children"?Ar(a,j):nc(a,_,j,g)}switch(p){case"input":sl(a,c);break;case"textarea":Uh(a,c);break;case"select":var b=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!c.multiple;var D=c.value;D!=null?Ai(a,!!c.multiple,D,!1):b!==!!c.multiple&&(c.defaultValue!=null?Ai(a,!!c.multiple,c.defaultValue,!0):Ai(a,!!c.multiple,c.multiple?[]:"",!1))}a[Fr]=c}catch(A){Le(e,e.return,A)}}break;case 6:if(Et(t,e),Vt(e),s&4){if(e.stateNode===null)throw Error(J(162));a=e.stateNode,c=e.memoizedProps;try{a.nodeValue=c}catch(A){Le(e,e.return,A)}}break;case 3:if(Et(t,e),Vt(e),s&4&&i!==null&&i.memoizedState.isDehydrated)try{Ir(t.containerInfo)}catch(A){Le(e,e.return,A)}break;case 4:Et(t,e),Vt(e);break;case 13:Et(t,e),Vt(e),a=e.child,a.flags&8192&&(c=a.memoizedState!==null,a.stateNode.isHidden=c,!c||a.alternate!==null&&a.alternate.memoizedState!==null||(Ic=Ee())),s&4&&ih(e);break;case 22:if(_=i!==null&&i.memoizedState!==null,e.mode&1?(Je=(g=Je)||_,Et(t,e),Je=g):Et(t,e),Vt(e),s&8192){if(g=e.memoizedState!==null,(e.stateNode.isHidden=g)&&!_&&e.mode&1)for(X=e,_=e.child;_!==null;){for(j=X=_;X!==null;){switch(b=X,D=b.child,b.tag){case 0:case 11:case 14:case 15:br(4,b,b.return);break;case 1:Ti(b,b.return);var k=b.stateNode;if(typeof k.componentWillUnmount=="function"){s=b,i=b.return;try{t=s,k.props=t.memoizedProps,k.state=t.memoizedState,k.componentWillUnmount()}catch(A){Le(s,i,A)}}break;case 5:Ti(b,b.return);break;case 22:if(b.memoizedState!==null){oh(j);continue}}D!==null?(D.return=b,X=D):oh(j)}_=_.sibling}e:for(_=null,j=e;;){if(j.tag===5){if(_===null){_=j;try{a=j.stateNode,g?(c=a.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(p=j.stateNode,m=j.memoizedProps.style,d=m!=null&&m.hasOwnProperty("display")?m.display:null,p.style.display=Hh("display",d))}catch(A){Le(e,e.return,A)}}}else if(j.tag===6){if(_===null)try{j.stateNode.nodeValue=g?"":j.memoizedProps}catch(A){Le(e,e.return,A)}}else if((j.tag!==22&&j.tag!==23||j.memoizedState===null||j===e)&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===e)break e;for(;j.sibling===null;){if(j.return===null||j.return===e)break e;_===j&&(_=null),j=j.return}_===j&&(_=null),j.sibling.return=j.return,j=j.sibling}}break;case 19:Et(t,e),Vt(e),s&4&&ih(e);break;case 21:break;default:Et(t,e),Vt(e)}}function Vt(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(vp(i)){var s=i;break e}i=i.return}throw Error(J(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Ar(a,""),s.flags&=-33);var c=nh(e);Ul(e,c,a);break;case 3:case 4:var d=s.stateNode.containerInfo,p=nh(e);Fl(e,p,d);break;default:throw Error(J(161))}}catch(m){Le(e,e.return,m)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function bx(e,t,i){X=e,_p(e)}function _p(e,t,i){for(var s=(e.mode&1)!==0;X!==null;){var a=X,c=a.child;if(a.tag===22&&s){var d=a.memoizedState!==null||zo;if(!d){var p=a.alternate,m=p!==null&&p.memoizedState!==null||Je;p=zo;var g=Je;if(zo=d,(Je=m)&&!g)for(X=a;X!==null;)d=X,m=d.child,d.tag===22&&d.memoizedState!==null?sh(a):m!==null?(m.return=d,X=m):sh(a);for(;c!==null;)X=c,_p(c),c=c.sibling;X=a,zo=p,Je=g}rh(e)}else a.subtreeFlags&8772&&c!==null?(c.return=a,X=c):rh(e)}}function rh(e){for(;X!==null;){var t=X;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Je||Ds(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Je)if(i===null)s.componentDidMount();else{var a=t.elementType===t.type?i.memoizedProps:Dt(t.type,i.memoizedProps);s.componentDidUpdate(a,i.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var c=t.updateQueue;c!==null&&$d(t,c,s);break;case 3:var d=t.updateQueue;if(d!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}$d(t,d,i)}break;case 5:var p=t.stateNode;if(i===null&&t.flags&4){i=p;var m=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&i.focus();break;case"img":m.src&&(i.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var g=t.alternate;if(g!==null){var _=g.memoizedState;if(_!==null){var j=_.dehydrated;j!==null&&Ir(j)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}Je||t.flags&512&&Bl(t)}catch(b){Le(t,t.return,b)}}if(t===e){X=null;break}if(i=t.sibling,i!==null){i.return=t.return,X=i;break}X=t.return}}function oh(e){for(;X!==null;){var t=X;if(t===e){X=null;break}var i=t.sibling;if(i!==null){i.return=t.return,X=i;break}X=t.return}}function sh(e){for(;X!==null;){var t=X;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{Ds(4,t)}catch(m){Le(t,i,m)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var a=t.return;try{s.componentDidMount()}catch(m){Le(t,a,m)}}var c=t.return;try{Bl(t)}catch(m){Le(t,c,m)}break;case 5:var d=t.return;try{Bl(t)}catch(m){Le(t,d,m)}}}catch(m){Le(t,t.return,m)}if(t===e){X=null;break}var p=t.sibling;if(p!==null){p.return=t.return,X=p;break}X=t.return}}var kx=Math.ceil,_s=pn.ReactCurrentDispatcher,zc=pn.ReactCurrentOwner,bt=pn.ReactCurrentBatchConfig,pe=0,Ue=null,Ie=null,He=0,dt=0,Pi=On(0),Oe=0,Vr=null,ei=0,Is=0,Dc=0,kr=null,rt=null,Ic=0,Wi=1/0,on=null,Ss=!1,$l=null,An=null,Do=!1,bn=null,ws=0,Tr=0,Wl=null,Qo=-1,Xo=0;function Qe(){return pe&6?Ee():Qo!==-1?Qo:Qo=Ee()}function En(e){return e.mode&1?pe&2&&He!==0?He&-He:cx.transition!==null?(Xo===0&&(Xo=rf()),Xo):(e=ve,e!==0||(e=window.event,e=e===void 0?16:df(e.type)),e):1}function Bt(e,t,i,s){if(50<Tr)throw Tr=0,Wl=null,Error(J(185));Jr(e,i,s),(!(pe&2)||e!==Ue)&&(e===Ue&&(!(pe&2)&&(Is|=i),Oe===4&&Sn(e,He)),lt(e,s),i===1&&pe===0&&!(t.mode&1)&&(Wi=Ee()+500,As&&Mn()))}function lt(e,t){var i=e.callbackNode;cv(e,t);var s=os(e,e===Ue?He:0);if(s===0)i!==null&&md(i),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(i!=null&&md(i),t===1)e.tag===0?lx(ah.bind(null,e)):Nf(ah.bind(null,e)),rx(function(){!(pe&6)&&Mn()}),i=null;else{switch(of(s)){case 1:i=ac;break;case 4:i=tf;break;case 16:i=rs;break;case 536870912:i=nf;break;default:i=rs}i=Pp(i,Sp.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function Sp(e,t){if(Qo=-1,Xo=0,pe&6)throw Error(J(327));var i=e.callbackNode;if(Ri()&&e.callbackNode!==i)return null;var s=os(e,e===Ue?He:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Cs(e,s);else{t=s;var a=pe;pe|=2;var c=Cp();(Ue!==e||He!==t)&&(on=null,Wi=Ee()+500,Gn(e,t));do try{Lx();break}catch(p){wp(e,p)}while(!0);_c(),_s.current=c,pe=a,Ie!==null?t=0:(Ue=null,He=0,t=Oe)}if(t!==0){if(t===2&&(a=gl(e),a!==0&&(s=a,t=Hl(e,a))),t===1)throw i=Vr,Gn(e,0),Sn(e,s),lt(e,Ee()),i;if(t===6)Sn(e,s);else{if(a=e.current.alternate,!(s&30)&&!Tx(a)&&(t=Cs(e,s),t===2&&(c=gl(e),c!==0&&(s=c,t=Hl(e,c))),t===1))throw i=Vr,Gn(e,0),Sn(e,s),lt(e,Ee()),i;switch(e.finishedWork=a,e.finishedLanes=s,t){case 0:case 1:throw Error(J(345));case 2:Zn(e,rt,on);break;case 3:if(Sn(e,s),(s&130023424)===s&&(t=Ic+500-Ee(),10<t)){if(os(e,0)!==0)break;if(a=e.suspendedLanes,(a&s)!==s){Qe(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=jl(Zn.bind(null,e,rt,on),t);break}Zn(e,rt,on);break;case 4:if(Sn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,a=-1;0<s;){var d=31-Mt(s);c=1<<d,d=t[d],d>a&&(a=d),s&=~c}if(s=a,s=Ee()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*kx(s/1960))-s,10<s){e.timeoutHandle=jl(Zn.bind(null,e,rt,on),s);break}Zn(e,rt,on);break;case 5:Zn(e,rt,on);break;default:throw Error(J(329))}}}return lt(e,Ee()),e.callbackNode===i?Sp.bind(null,e):null}function Hl(e,t){var i=kr;return e.current.memoizedState.isDehydrated&&(Gn(e,t).flags|=256),e=Cs(e,t),e!==2&&(t=rt,rt=i,t!==null&&Zl(t)),e}function Zl(e){rt===null?rt=e:rt.push.apply(rt,e)}function Tx(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var s=0;s<i.length;s++){var a=i[s],c=a.getSnapshot;a=a.value;try{if(!Ut(c(),a))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Sn(e,t){for(t&=~Dc,t&=~Is,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-Mt(t),s=1<<i;e[i]=-1,t&=~s}}function ah(e){if(pe&6)throw Error(J(327));Ri();var t=os(e,0);if(!(t&1))return lt(e,Ee()),null;var i=Cs(e,t);if(e.tag!==0&&i===2){var s=gl(e);s!==0&&(t=s,i=Hl(e,s))}if(i===1)throw i=Vr,Gn(e,0),Sn(e,t),lt(e,Ee()),i;if(i===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Zn(e,rt,on),lt(e,Ee()),null}function Rc(e,t){var i=pe;pe|=1;try{return e(t)}finally{pe=i,pe===0&&(Wi=Ee()+500,As&&Mn())}}function ti(e){bn!==null&&bn.tag===0&&!(pe&6)&&Ri();var t=pe;pe|=1;var i=bt.transition,s=ve;try{if(bt.transition=null,ve=1,e)return e()}finally{ve=s,bt.transition=i,pe=t,!(pe&6)&&Mn()}}function Oc(){dt=Pi.current,we(Pi)}function Gn(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,ix(i)),Ie!==null)for(i=Ie.return;i!==null;){var s=i;switch(vc(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&us();break;case 3:Ui(),we(st),we(Ge),kc();break;case 5:bc(s);break;case 4:Ui();break;case 13:we(ke);break;case 19:we(ke);break;case 10:Sc(s.type._context);break;case 22:case 23:Oc()}i=i.return}if(Ue=e,Ie=e=zn(e.current,null),He=dt=t,Oe=0,Vr=null,Dc=Is=ei=0,rt=kr=null,qn!==null){for(t=0;t<qn.length;t++)if(i=qn[t],s=i.interleaved,s!==null){i.interleaved=null;var a=s.next,c=i.pending;if(c!==null){var d=c.next;c.next=a,s.next=d}i.pending=s}qn=null}return e}function wp(e,t){do{var i=Ie;try{if(_c(),Go.current=ys,xs){for(var s=Te.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}xs=!1}if(Xn=0,Fe=Re=Te=null,jr=!1,Wr=0,zc.current=null,i===null||i.return===null){Oe=1,Vr=t,Ie=null;break}e:{var c=e,d=i.return,p=i,m=t;if(t=He,p.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var g=m,_=p,j=_.tag;if(!(_.mode&1)&&(j===0||j===11||j===15)){var b=_.alternate;b?(_.updateQueue=b.updateQueue,_.memoizedState=b.memoizedState,_.lanes=b.lanes):(_.updateQueue=null,_.memoizedState=null)}var D=Jd(d);if(D!==null){D.flags&=-257,Gd(D,d,p,c,t),D.mode&1&&qd(c,g,t),t=D,m=g;var k=t.updateQueue;if(k===null){var A=new Set;A.add(m),t.updateQueue=A}else k.add(m);break e}else{if(!(t&1)){qd(c,g,t),Mc();break e}m=Error(J(426))}}else if(Ce&&p.mode&1){var O=Jd(d);if(O!==null){!(O.flags&65536)&&(O.flags|=256),Gd(O,d,p,c,t),xc($i(m,p));break e}}c=m=$i(m,p),Oe!==4&&(Oe=2),kr===null?kr=[c]:kr.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,t&=-t,c.lanes|=t;var S=op(c,m,t);Ud(c,S);break e;case 1:p=m;var f=c.type,w=c.stateNode;if(!(c.flags&128)&&(typeof f.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(An===null||!An.has(w)))){c.flags|=65536,t&=-t,c.lanes|=t;var C=sp(c,p,t);Ud(c,C);break e}}c=c.return}while(c!==null)}bp(i)}catch(y){t=y,Ie===i&&i!==null&&(Ie=i=i.return);continue}break}while(!0)}function Cp(){var e=_s.current;return _s.current=ys,e===null?ys:e}function Mc(){(Oe===0||Oe===3||Oe===2)&&(Oe=4),Ue===null||!(ei&268435455)&&!(Is&268435455)||Sn(Ue,He)}function Cs(e,t){var i=pe;pe|=2;var s=Cp();(Ue!==e||He!==t)&&(on=null,Gn(e,t));do try{Px();break}catch(a){wp(e,a)}while(!0);if(_c(),pe=i,_s.current=s,Ie!==null)throw Error(J(261));return Ue=null,He=0,Oe}function Px(){for(;Ie!==null;)jp(Ie)}function Lx(){for(;Ie!==null&&!ev();)jp(Ie)}function jp(e){var t=Tp(e.alternate,e,dt);e.memoizedProps=e.pendingProps,t===null?bp(e):Ie=t,zc.current=null}function bp(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&32768){if(i=wx(i,t),i!==null){i.flags&=32767,Ie=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Oe=6,Ie=null;return}}else if(i=Sx(i,t,dt),i!==null){Ie=i;return}if(t=t.sibling,t!==null){Ie=t;return}Ie=t=e}while(t!==null);Oe===0&&(Oe=5)}function Zn(e,t,i){var s=ve,a=bt.transition;try{bt.transition=null,ve=1,Nx(e,t,i,s)}finally{bt.transition=a,ve=s}return null}function Nx(e,t,i,s){do Ri();while(bn!==null);if(pe&6)throw Error(J(327));i=e.finishedWork;var a=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var c=i.lanes|i.childLanes;if(uv(e,c),e===Ue&&(Ie=Ue=null,He=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||Do||(Do=!0,Pp(rs,function(){return Ri(),null})),c=(i.flags&15990)!==0,i.subtreeFlags&15990||c){c=bt.transition,bt.transition=null;var d=ve;ve=1;var p=pe;pe|=4,zc.current=null,jx(e,i),yp(i,e),Kv(wl),ss=!!Sl,wl=Sl=null,e.current=i,bx(i),tv(),pe=p,ve=d,bt.transition=c}else e.current=i;if(Do&&(Do=!1,bn=e,ws=a),c=e.pendingLanes,c===0&&(An=null),rv(i.stateNode),lt(e,Ee()),t!==null)for(s=e.onRecoverableError,i=0;i<t.length;i++)a=t[i],s(a.value,{componentStack:a.stack,digest:a.digest});if(Ss)throw Ss=!1,e=$l,$l=null,e;return ws&1&&e.tag!==0&&Ri(),c=e.pendingLanes,c&1?e===Wl?Tr++:(Tr=0,Wl=e):Tr=0,Mn(),null}function Ri(){if(bn!==null){var e=of(ws),t=bt.transition,i=ve;try{if(bt.transition=null,ve=16>e?16:e,bn===null)var s=!1;else{if(e=bn,bn=null,ws=0,pe&6)throw Error(J(331));var a=pe;for(pe|=4,X=e.current;X!==null;){var c=X,d=c.child;if(X.flags&16){var p=c.deletions;if(p!==null){for(var m=0;m<p.length;m++){var g=p[m];for(X=g;X!==null;){var _=X;switch(_.tag){case 0:case 11:case 15:br(8,_,c)}var j=_.child;if(j!==null)j.return=_,X=j;else for(;X!==null;){_=X;var b=_.sibling,D=_.return;if(gp(_),_===g){X=null;break}if(b!==null){b.return=D,X=b;break}X=D}}}var k=c.alternate;if(k!==null){var A=k.child;if(A!==null){k.child=null;do{var O=A.sibling;A.sibling=null,A=O}while(A!==null)}}X=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,X=d;else e:for(;X!==null;){if(c=X,c.flags&2048)switch(c.tag){case 0:case 11:case 15:br(9,c,c.return)}var S=c.sibling;if(S!==null){S.return=c.return,X=S;break e}X=c.return}}var f=e.current;for(X=f;X!==null;){d=X;var w=d.child;if(d.subtreeFlags&2064&&w!==null)w.return=d,X=w;else e:for(d=f;X!==null;){if(p=X,p.flags&2048)try{switch(p.tag){case 0:case 11:case 15:Ds(9,p)}}catch(y){Le(p,p.return,y)}if(p===d){X=null;break e}var C=p.sibling;if(C!==null){C.return=p.return,X=C;break e}X=p.return}}if(pe=a,Mn(),Kt&&typeof Kt.onPostCommitFiberRoot=="function")try{Kt.onPostCommitFiberRoot(ks,e)}catch{}s=!0}return s}finally{ve=i,bt.transition=t}}return!1}function lh(e,t,i){t=$i(i,t),t=op(e,t,1),e=Nn(e,t,1),t=Qe(),e!==null&&(Jr(e,1,t),lt(e,t))}function Le(e,t,i){if(e.tag===3)lh(e,e,i);else for(;t!==null;){if(t.tag===3){lh(t,e,i);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(An===null||!An.has(s))){e=$i(i,e),e=sp(t,e,1),t=Nn(t,e,1),e=Qe(),t!==null&&(Jr(t,1,e),lt(t,e));break}}t=t.return}}function Ax(e,t,i){var s=e.pingCache;s!==null&&s.delete(t),t=Qe(),e.pingedLanes|=e.suspendedLanes&i,Ue===e&&(He&i)===i&&(Oe===4||Oe===3&&(He&130023424)===He&&500>Ee()-Ic?Gn(e,0):Dc|=i),lt(e,t)}function kp(e,t){t===0&&(e.mode&1?(t=jo,jo<<=1,!(jo&130023424)&&(jo=4194304)):t=1);var i=Qe();e=hn(e,t),e!==null&&(Jr(e,t,i),lt(e,i))}function Ex(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),kp(e,i)}function zx(e,t){var i=0;switch(e.tag){case 13:var s=e.stateNode,a=e.memoizedState;a!==null&&(i=a.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(J(314))}s!==null&&s.delete(t),kp(e,i)}var Tp;Tp=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||st.current)ot=!0;else{if(!(e.lanes&i)&&!(t.flags&128))return ot=!1,_x(e,t,i);ot=!!(e.flags&131072)}else ot=!1,Ce&&t.flags&1048576&&Af(t,fs,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Yo(e,t),e=t.pendingProps;var a=Mi(t,Ge.current);Ii(t,i),a=Pc(null,t,s,e,a,i);var c=Lc();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,at(s)?(c=!0,ds(t)):c=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Cc(t),a.updater=zs,t.stateNode=a,a._reactInternals=t,Al(t,s,e,i),t=Dl(null,t,s,!0,c,i)):(t.tag=0,Ce&&c&&gc(t),Ye(null,t,a,i),t=t.child),t;case 16:s=t.elementType;e:{switch(Yo(e,t),e=t.pendingProps,a=s._init,s=a(s._payload),t.type=s,a=t.tag=Ix(s),e=Dt(s,e),a){case 0:t=zl(null,t,s,e,i);break e;case 1:t=Qd(null,t,s,e,i);break e;case 11:t=Kd(null,t,s,e,i);break e;case 14:t=Yd(null,t,s,Dt(s.type,e),i);break e}throw Error(J(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:Dt(s,a),zl(e,t,s,a,i);case 1:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:Dt(s,a),Qd(e,t,s,a,i);case 3:e:{if(up(t),e===null)throw Error(J(387));s=t.pendingProps,c=t.memoizedState,a=c.element,Of(e,t),gs(t,s,null,i);var d=t.memoizedState;if(s=d.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){a=$i(Error(J(423)),t),t=Xd(e,t,s,i,a);break e}else if(s!==a){a=$i(Error(J(424)),t),t=Xd(e,t,s,i,a);break e}else for(ht=Ln(t.stateNode.containerInfo.firstChild),ft=t,Ce=!0,Ot=null,i=If(t,null,s,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Bi(),s===a){t=fn(e,t,i);break e}Ye(e,t,s,i)}t=t.child}return t;case 5:return Mf(t),e===null&&Pl(t),s=t.type,a=t.pendingProps,c=e!==null?e.memoizedProps:null,d=a.children,Cl(s,a)?d=null:c!==null&&Cl(s,c)&&(t.flags|=32),cp(e,t),Ye(e,t,d,i),t.child;case 6:return e===null&&Pl(t),null;case 13:return dp(e,t,i);case 4:return jc(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Fi(t,null,s,i):Ye(e,t,s,i),t.child;case 11:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:Dt(s,a),Kd(e,t,s,a,i);case 7:return Ye(e,t,t.pendingProps,i),t.child;case 8:return Ye(e,t,t.pendingProps.children,i),t.child;case 12:return Ye(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,c=t.memoizedProps,d=a.value,ye(ps,s._currentValue),s._currentValue=d,c!==null)if(Ut(c.value,d)){if(c.children===a.children&&!st.current){t=fn(e,t,i);break e}}else for(c=t.child,c!==null&&(c.return=t);c!==null;){var p=c.dependencies;if(p!==null){d=c.child;for(var m=p.firstContext;m!==null;){if(m.context===s){if(c.tag===1){m=cn(-1,i&-i),m.tag=2;var g=c.updateQueue;if(g!==null){g=g.shared;var _=g.pending;_===null?m.next=m:(m.next=_.next,_.next=m),g.pending=m}}c.lanes|=i,m=c.alternate,m!==null&&(m.lanes|=i),Ll(c.return,i,t),p.lanes|=i;break}m=m.next}}else if(c.tag===10)d=c.type===t.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(J(341));d.lanes|=i,p=d.alternate,p!==null&&(p.lanes|=i),Ll(d,i,t),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===t){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Ye(e,t,a.children,i),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,Ii(t,i),a=kt(a),s=s(a),t.flags|=1,Ye(e,t,s,i),t.child;case 14:return s=t.type,a=Dt(s,t.pendingProps),a=Dt(s.type,a),Yd(e,t,s,a,i);case 15:return ap(e,t,t.type,t.pendingProps,i);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:Dt(s,a),Yo(e,t),t.tag=1,at(s)?(e=!0,ds(t)):e=!1,Ii(t,i),rp(t,s,a),Al(t,s,a,i),Dl(null,t,s,!0,e,i);case 19:return hp(e,t,i);case 22:return lp(e,t,i)}throw Error(J(156,t.tag))};function Pp(e,t){return ef(e,t)}function Dx(e,t,i,s){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jt(e,t,i,s){return new Dx(e,t,i,s)}function Bc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ix(e){if(typeof e=="function")return Bc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rc)return 11;if(e===oc)return 14}return 2}function zn(e,t){var i=e.alternate;return i===null?(i=jt(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function es(e,t,i,s,a,c){var d=2;if(s=e,typeof e=="function")Bc(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case xi:return Kn(i.children,a,c,t);case ic:d=8,a|=8;break;case tl:return e=jt(12,i,t,a|2),e.elementType=tl,e.lanes=c,e;case nl:return e=jt(13,i,t,a),e.elementType=nl,e.lanes=c,e;case il:return e=jt(19,i,t,a),e.elementType=il,e.lanes=c,e;case Oh:return Rs(i,a,c,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ih:d=10;break e;case Rh:d=9;break e;case rc:d=11;break e;case oc:d=14;break e;case xn:d=16,s=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=jt(d,i,t,a),t.elementType=e,t.type=s,t.lanes=c,t}function Kn(e,t,i,s){return e=jt(7,e,s,t),e.lanes=i,e}function Rs(e,t,i,s){return e=jt(22,e,s,t),e.elementType=Oh,e.lanes=i,e.stateNode={isHidden:!1},e}function $a(e,t,i){return e=jt(6,e,null,t),e.lanes=i,e}function Wa(e,t,i){return t=jt(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Rx(e,t,i,s,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ca(0),this.expirationTimes=Ca(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ca(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Fc(e,t,i,s,a,c,d,p,m){return e=new Rx(e,t,i,p,m),t===1?(t=1,c===!0&&(t|=8)):t=0,c=jt(3,null,null,t),e.current=c,c.stateNode=e,c.memoizedState={element:s,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cc(c),e}function Ox(e,t,i){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vi,key:s==null?null:""+s,children:e,containerInfo:t,implementation:i}}function Lp(e){if(!e)return In;e=e._reactInternals;e:{if(ii(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(at(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var i=e.type;if(at(i))return Lf(e,i,t)}return t}function Np(e,t,i,s,a,c,d,p,m){return e=Fc(i,s,!0,e,a,c,d,p,m),e.context=Lp(null),i=e.current,s=Qe(),a=En(i),c=cn(s,a),c.callback=t??null,Nn(i,c,a),e.current.lanes=a,Jr(e,a,s),lt(e,s),e}function Os(e,t,i,s){var a=t.current,c=Qe(),d=En(a);return i=Lp(i),t.context===null?t.context=i:t.pendingContext=i,t=cn(c,d),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=Nn(a,t,d),e!==null&&(Bt(e,a,d,c),Jo(e,a,d)),d}function js(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ch(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Uc(e,t){ch(e,t),(e=e.alternate)&&ch(e,t)}function Mx(){return null}var Ap=typeof reportError=="function"?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}Ms.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));Os(e,t,null,null)};Ms.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ti(function(){Os(null,e,null,null)}),t[dn]=null}};function Ms(e){this._internalRoot=e}Ms.prototype.unstable_scheduleHydration=function(e){if(e){var t=lf();e={blockedOn:null,target:e,priority:t};for(var i=0;i<_n.length&&t!==0&&t<_n[i].priority;i++);_n.splice(i,0,e),i===0&&uf(e)}};function Wc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Bs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function uh(){}function Bx(e,t,i,s,a){if(a){if(typeof s=="function"){var c=s;s=function(){var g=js(d);c.call(g)}}var d=Np(t,s,e,0,null,!1,!1,"",uh);return e._reactRootContainer=d,e[dn]=d.current,Mr(e.nodeType===8?e.parentNode:e),ti(),d}for(;a=e.lastChild;)e.removeChild(a);if(typeof s=="function"){var p=s;s=function(){var g=js(m);p.call(g)}}var m=Fc(e,0,!1,null,null,!1,!1,"",uh);return e._reactRootContainer=m,e[dn]=m.current,Mr(e.nodeType===8?e.parentNode:e),ti(function(){Os(t,m,i,s)}),m}function Fs(e,t,i,s,a){var c=i._reactRootContainer;if(c){var d=c;if(typeof a=="function"){var p=a;a=function(){var m=js(d);p.call(m)}}Os(t,d,e,a)}else d=Bx(i,t,e,a,s);return js(d)}sf=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=vr(t.pendingLanes);i!==0&&(lc(t,i|1),lt(t,Ee()),!(pe&6)&&(Wi=Ee()+500,Mn()))}break;case 13:ti(function(){var s=hn(e,1);if(s!==null){var a=Qe();Bt(s,e,1,a)}}),Uc(e,1)}};cc=function(e){if(e.tag===13){var t=hn(e,134217728);if(t!==null){var i=Qe();Bt(t,e,134217728,i)}Uc(e,134217728)}};af=function(e){if(e.tag===13){var t=En(e),i=hn(e,t);if(i!==null){var s=Qe();Bt(i,e,t,s)}Uc(e,t)}};lf=function(){return ve};cf=function(e,t){var i=ve;try{return ve=e,t()}finally{ve=i}};fl=function(e,t,i){switch(t){case"input":if(sl(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var s=i[t];if(s!==e&&s.form===e.form){var a=Ns(s);if(!a)throw Error(J(90));Bh(s),sl(s,a)}}}break;case"textarea":Uh(e,i);break;case"select":t=i.value,t!=null&&Ai(e,!!i.multiple,t,!1)}};Jh=Rc;Gh=ti;var Fx={usingClientEntryPoint:!1,Events:[Kr,wi,Ns,Vh,qh,Rc]},fr={findFiberByHostInstance:Vn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ux={bundleType:fr.bundleType,version:fr.version,rendererPackageName:fr.rendererPackageName,rendererConfig:fr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Qh(e),e===null?null:e.stateNode},findFiberByHostInstance:fr.findFiberByHostInstance||Mx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Io=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Io.isDisabled&&Io.supportsFiber)try{ks=Io.inject(Ux),Kt=Io}catch{}}gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fx;gt.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wc(t))throw Error(J(200));return Ox(e,t,null,i)};gt.createRoot=function(e,t){if(!Wc(e))throw Error(J(299));var i=!1,s="",a=Ap;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Fc(e,1,!1,null,null,i,!1,s,a),e[dn]=t.current,Mr(e.nodeType===8?e.parentNode:e),new $c(t)};gt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=Qh(t),e=e===null?null:e.stateNode,e};gt.flushSync=function(e){return ti(e)};gt.hydrate=function(e,t,i){if(!Bs(t))throw Error(J(200));return Fs(null,e,t,!0,i)};gt.hydrateRoot=function(e,t,i){if(!Wc(e))throw Error(J(405));var s=i!=null&&i.hydratedSources||null,a=!1,c="",d=Ap;if(i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),t=Np(t,null,e,1,i??null,a,!1,c,d),e[dn]=t.current,Mr(e),s)for(e=0;e<s.length;e++)i=s[e],a=i._getVersion,a=a(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,a]:t.mutableSourceEagerHydrationData.push(i,a);return new Ms(t)};gt.render=function(e,t,i){if(!Bs(t))throw Error(J(200));return Fs(null,e,t,!1,i)};gt.unmountComponentAtNode=function(e){if(!Bs(e))throw Error(J(40));return e._reactRootContainer?(ti(function(){Fs(null,null,e,!1,function(){e._reactRootContainer=null,e[dn]=null})}),!0):!1};gt.unstable_batchedUpdates=Rc;gt.unstable_renderSubtreeIntoContainer=function(e,t,i,s){if(!Bs(i))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return Fs(e,t,i,!1,s)};gt.version="18.3.1-next-f1338f8080-20240426";function Ep(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ep)}catch(e){console.error(e)}}Ep(),Ah.exports=gt;var zp=Ah.exports,dh=zp;Xa.createRoot=dh.createRoot,Xa.hydrateRoot=dh.hydrateRoot;let rn=null,ct=[],wn=[],ut=[],Cn=[],It=[];async function gi(){if(rn)return rn;try{console.log("JsonApiService: Loading data from /data.json...");const e=await fetch("/data.json");if(!e.ok)throw new Error(`Failed to load data: ${e.status}`);return rn=await e.json(),ct=rn.tickets||[],wn=rn.customers||[],ut=rn.sites||[],Cn=rn.assets||[],It=rn.vendors||[],console.log("JsonApiService: Loaded data:",{tickets:ct.length,customers:wn.length,sites:ut.length,assets:Cn.length,vendors:It.length}),rn}catch(e){throw console.error("JsonApiService: Error loading data from JSON file:",e),ct=[],wn=[],ut=[],Cn=[],It=[],e}}function $x(){return`TKT-${Date.now()}`}function it(e=100){return new Promise(t=>setTimeout(t,e))}class Wx{async getTickets(){return console.log("JsonApiService.getTickets: Starting..."),await gi(),console.log("JsonApiService.getTickets: Returning",ct.length,"tickets"),await it(100),[...ct]}async createTicket(t){console.log("JsonApiService.createTicket: Creating ticket with data:",t);const i={TicketID:$x(),Title:t.Title||"",Status:t.Status||"New",Priority:t.Priority||"Normal",Customer:t.Customer||"",Site:t.Site||"",AssetIDs:t.AssetIDs||"",Category:t.Category||"",Description:t.Description||"",ScheduledStart:t.ScheduledStart||"",ScheduledEnd:t.ScheduledEnd||"",AssignedTo:t.AssignedTo||"",SLA_Due:t.SLA_Due||"",Resolution:t.Resolution||"",ClosedBy:t.ClosedBy||"",ClosedDate:t.ClosedDate||"",GeoLocation:t.GeoLocation||"",Tags:t.Tags||"",CreatedAt:new Date().toISOString(),UpdatedAt:new Date().toISOString()};return await it(200),ct.push(i),console.log("JsonApiService.createTicket: Created ticket:",i.TicketID),i}async updateTicket(t,i){console.log("JsonApiService.updateTicket: Updating ticket",t,"with:",i),await it(200);const s=ct.findIndex(c=>c.TicketID===t);if(s===-1)throw new Error(`Ticket ${t} not found`);const a={...ct[s],...i,UpdatedAt:new Date().toISOString()};return ct[s]=a,console.log("JsonApiService.updateTicket: Successfully updated ticket:",t),a}async deleteTicket(t){console.log("JsonApiService.deleteTicket: Deleting ticket:",t),await it(100);const i=ct.findIndex(s=>s.TicketID===t);if(i===-1)throw new Error(`Ticket ${t} not found`);ct.splice(i,1),console.log("JsonApiService.deleteTicket: Successfully deleted ticket:",t)}async getCustomers(){return console.log("JsonApiService.getCustomers: Starting..."),await gi(),console.log("JsonApiService.getCustomers: Returning",wn.length,"customers"),await it(50),[...wn]}async createCustomer(t){console.log("JsonApiService.createCustomer: Creating customer:",t);const i={Customer:t.Customer||"",ContactEmail:t.ContactEmail||"",ContactPhone:t.ContactPhone||"",Address:t.Address||"",Industry:t.Industry||"",AccountManager:t.AccountManager||""};return await it(100),wn.push(i),console.log("JsonApiService.createCustomer: Created customer:",i.Customer),i}async getSites(){return console.log("JsonApiService.getSites: Starting..."),await gi(),console.log("JsonApiService.getSites: Returning",ut.length,"sites"),await it(50),[...ut]}async createSite(t){console.log("JsonApiService.createSite: Creating site:",t);const i={Customer:t.Customer||"",Site:t.Site||"",Address:t.Address||"",ContactName:t.ContactName||"",ContactPhone:t.ContactPhone||"",SiteType:t.SiteType||"",GeoLocation:t.GeoLocation||""};return await it(100),ut.push(i),console.log("JsonApiService.createSite: Created site:",i.Site),i}async updateSite(t,i){console.log("JsonApiService.updateSite: Updating site:",t,i),await gi();const[s,a]=t.split("|"),c=ut.findIndex(d=>d.Customer===s&&d.Site===a);if(c===-1)throw new Error(`Site not found: ${t}`);return ut[c]={...ut[c],...i},await it(100),console.log("JsonApiService.updateSite: Updated site:",ut[c].Site),ut[c]}async getAssets(){return console.log("JsonApiService.getAssets: Starting..."),await gi(),console.log("JsonApiService.getAssets: Returning",Cn.length,"assets"),await it(50),[...Cn]}async createAsset(t){console.log("JsonApiService.createAsset: Creating asset:",t);const i={AssetID:t.AssetID||`AST-${Date.now()}`,Customer:t.Customer||"",Site:t.Site||"",Type:t.Type||"",Make:t.Make||"",Model:t.Model||"",SerialNumber:t.SerialNumber||"",InstallDate:t.InstallDate||"",WarrantyExpires:t.WarrantyExpires||"",Status:t.Status||"Active",Location:t.Location||"",IPAddress:t.IPAddress||""};return await it(100),Cn.push(i),console.log("JsonApiService.createAsset: Created asset:",i.AssetID),i}async getVendors(){return console.log("JsonApiService.getVendors: Starting..."),await gi(),console.log("JsonApiService.getVendors: Returning",It.length,"vendors"),await it(50),[...It]}async createVendor(t){console.log("JsonApiService.createVendor: Creating vendor:",t);const i={VendorID:t.VendorID||`VND-${Date.now()}`,Name:t.Name||"",Contact:t.Contact||"",Phone:t.Phone||"",Email:t.Email||"",ServiceAreas:t.ServiceAreas||[],Specialties:t.Specialties||[],Rating:t.Rating||5,ServicesTexas:t.ServicesTexas||!0,Notes:t.Notes||"",CreatedAt:t.CreatedAt||new Date().toISOString()};return await it(100),It.push(i),console.log("JsonApiService.createVendor: Created vendor:",i.VendorID),i}async updateVendor(t,i){console.log("JsonApiService.updateVendor: Updating vendor:",t,"with updates:",i);const s=It.findIndex(c=>c.VendorID===t);if(s===-1)throw new Error(`Vendor with ID ${t} not found`);const a={...It[s],...i,VendorID:t};return await it(150),It[s]=a,console.log("JsonApiService.updateVendor: Updated vendor:",t),a}async exportData(){return{tickets:ct,customers:wn,sites:ut,assets:Cn,vendors:It,exportedAt:new Date().toISOString()}}async importData(t){t.tickets&&(ct=[...t.tickets]),t.customers&&(wn=[...t.customers]),t.sites&&(ut=[...t.sites]),t.assets&&(Cn=[...t.assets]),t.vendors&&(It=[...t.vendors]),console.log("JsonApiService: Data imported successfully")}}const Hx=new Wx;class Zx{constructor(t){pi(this,"baseUrl");pi(this,"currentTenant",null);pi(this,"authToken",null);this.baseUrl=t||"https://field-service-api.azurewebsites.net/api",console.log("🔗 TenantApiService initialized with baseUrl:",this.baseUrl),this.loadStoredSession()}loadStoredSession(){try{const t=localStorage.getItem("tenant_session");if(t){const i=JSON.parse(t);this.currentTenant=i.tenantCode,this.authToken=i.token}}catch(t){console.warn("Failed to load stored session:",t)}}saveSession(t,i){const s=t.trim().toUpperCase();try{localStorage.setItem("tenant_session",JSON.stringify({tenantCode:s,token:i,timestamp:Date.now()})),this.currentTenant=s,this.authToken=i}catch(a){console.warn("Failed to save session:",a)}}clearSession(){localStorage.removeItem("tenant_session"),localStorage.removeItem("sqlUser"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userName"),localStorage.removeItem("userId"),localStorage.removeItem("tenantCode"),this.currentTenant=null,this.authToken=null}async makeRequest(t,i={}){const s=t,c=s.toLowerCase()==="/auth/login",d=`${this.baseUrl}${s}`,p={"Content-Type":"application/json",...i.headers||{}};if(!c){const m=localStorage.getItem("sqlUser");if(m)try{const g=JSON.parse(m);g.id&&(p["x-user-id"]=g.id,p["x-user-name"]=g.username||g.fullName||"",p["x-user-role"]=g.role||"",g.companyCode&&(p["x-company-code"]=g.companyCode),g.companyName&&(p["x-company-name"]=g.companyName))}catch{console.warn("Failed to parse sqlUser from localStorage")}!p["x-company-code"]&&this.currentTenant&&(p["x-company-code"]=this.currentTenant),this.authToken&&(p.Authorization=`Bearer ${this.authToken}`)}try{const m=await fetch(d,{...i,headers:p}),g=await m.json();if(!m.ok)throw new Error(g.error||`HTTP ${m.status}: ${m.statusText}`);return g}catch(m){throw console.error(`API request failed: ${t}`,m),m}}async registerTenant(t){return this.makeRequest("/tenant/register",{method:"POST",body:JSON.stringify(t)})}async validateTenant(t){return this.makeRequest(`/tenant/validate/${encodeURIComponent(t)}`)}async login(t,i,s){const a=t.trim().toUpperCase(),c=await this.makeRequest("/auth/login",{method:"POST",headers:{"X-Company-Code":a},body:JSON.stringify({tenantCode:a,username:i,password:s})}),d=c;return d.success&&d.token?(this.saveSession(a,d.token),d.user&&!d.user.companyCode&&(d.user.companyCode=a),{success:!0,data:{token:d.token,user:d.user,tenant:{code:a,name:a}}}):c}async logout(){try{this.authToken&&await this.makeRequest("/auth/logout",{method:"POST"})}catch(t){console.warn("Logout request failed:",t)}finally{this.clearSession()}}async getCurrentUser(){return this.makeRequest("/auth/me")}async getCustomers(){return this.makeRequest("/customers")}async createCustomer(t){return this.makeRequest("/customers",{method:"POST",body:JSON.stringify(t)})}async updateCustomer(t,i){return this.makeRequest(`/customers/${t}`,{method:"PUT",body:JSON.stringify(i)})}async deleteCustomer(t){return this.makeRequest(`/customers/${t}`,{method:"DELETE"})}async getUsers(){return this.makeRequest("/users")}async createUser(t){return this.makeRequest("/users",{method:"POST",body:JSON.stringify(t)})}async updateUser(t,i){return this.makeRequest(`/users/${t}`,{method:"PUT",body:JSON.stringify(i)})}async deleteUser(t){return this.makeRequest(`/users/${t}`,{method:"DELETE"})}async getTickets(){return this.makeRequest("/tickets")}async getSites(){return this.makeRequest("/sites")}async createTicket(t){return this.makeRequest("/tickets",{method:"POST",body:JSON.stringify(t)})}async updateTicket(t,i){return this.makeRequest(`/tickets/${t}`,{method:"PUT",body:JSON.stringify(i)})}async deleteTicket(t){return this.makeRequest(`/tickets/${t}`,{method:"DELETE"})}async getAssets(){return this.makeRequest("/assets")}async createAsset(t){return this.makeRequest("/assets",{method:"POST",body:JSON.stringify(t)})}async updateAsset(t,i){return this.makeRequest(`/assets/${t}`,{method:"PUT",body:JSON.stringify(i)})}async deleteAsset(t){return this.makeRequest(`/assets/${t}`,{method:"DELETE"})}async getLicenses(){return this.makeRequest("/licenses")}async createLicense(t){return this.makeRequest("/licenses",{method:"POST",body:JSON.stringify(t)})}async updateLicense(t,i){return this.makeRequest(`/licenses/${t}`,{method:"PUT",body:JSON.stringify(i)})}async deleteLicense(t){return this.makeRequest(`/licenses/${t}`,{method:"DELETE"})}async getActivityLogs(t){const i=new URLSearchParams;t&&Object.entries(t).forEach(([a,c])=>{c&&i.append(a,c)});const s=i.toString();return this.makeRequest(`/activity-logs${s?`?${s}`:""}`)}getCurrentTenant(){return this.currentTenant}isAuthenticated(){return!!this.authToken&&!!this.currentTenant}async testConnection(){return this.makeRequest("/health")}async checkTenantDatabase(){return this.makeRequest("/tenant/database/health")}}const Vl=new Zx;function Vx(){try{return localStorage.getItem("tenant_session")!==null}catch{return!1}}async function qx(){if(Vx()){console.log("api-json.listSites: SaaS mode detected, using TenantApiService");const e=await Vl.getSites();return e.success&&e.data?e.data:[]}return console.log("api-json.listSites: Self-hosted mode, using JsonApiService"),await Hx.getSites()}function hh(e){if(e==null)return"";const t=String(e);return t.includes(",")||t.includes(`
`)||t.includes("\r")||t.includes('"')?`"${t.replace(/"/g,'""')}"`:t}function ri(e,t,i){if(e.length===0){alert("No data to export");return}const a=t.map(p=>p.label).map(hh).join(","),c=e.map(p=>t.map(g=>{const _=p[g.key];return hh(_)}).join(",")),d=[a,...c].join(`
`);Jx(d,i)}function Jx(e,t){const i="\uFEFF",s=new Blob([i+e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),c=URL.createObjectURL(s);a.setAttribute("href",c),a.setAttribute("download",`${t}_${new Date().toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}function Gt(e){if(!e)return"";const t=new Date(e);return isNaN(t.getTime())?String(e):t.toLocaleString()}function Dp(e){switch(e){case"Critical":return"🔴 Critical";case"High":return"🟠 High";case"Normal":return"🟡 Normal";case"Low":return"🔵 Low";default:return e}}function Ip(e){switch(e){case"Open":return"🆕 Open";case"In Progress":return"⚡ In Progress";case"Complete":return"✅ Complete";case"Closed":return"🔒 Closed";case"On Hold":return"⏸️ On Hold";default:return e}}const Gx="https://field-service-api.azurewebsites.net/api";function Kx(){const[e,t]=P.useState([]),[i,s]=P.useState(!0);function a(){const g={},_=localStorage.getItem("authToken");_&&(g.Authorization=`Bearer ${_}`);const j=localStorage.getItem("sqlUser");if(j)try{const b=JSON.parse(j);b!=null&&b.id&&(g["x-user-id"]=b.id,g["x-user-name"]=b.username||b.fullName||"",g["x-user-role"]=b.role||"",b.companyCode&&(g["x-company-code"]=b.companyCode),b.companyName&&(g["x-company-name"]=b.companyName))}catch{console.warn("RecentActivityWidget: Failed to parse sqlUser from localStorage")}return g}P.useEffect(()=>{c();const g=setInterval(c,3e4);return()=>clearInterval(g)},[]);async function c(){try{s(!0);const g=await fetch(`${Gx}/activity-log?hours=8`,{headers:a()});if(!g.ok)throw new Error("Failed to fetch activity logs");const _=await g.json();t(_.slice(0,50))}catch(g){console.error("Error loading recent activities:",g),t([])}finally{s(!1)}}const d=g=>{const _=new Date(g),b=new Date().getTime()-_.getTime(),D=Math.floor(b/(1e3*60)),k=Math.floor(D/60);return D<1?"Just now":D<60?`${D}m ago`:k<24?`${k}h ago`:`${Math.floor(k/24)}d ago`},p=g=>{switch(g.toLowerCase()){case"login":return"🔐";case"ticket created":return"🎫";case"ticket updated":return"✏️";case"site created":return"🏢";case"site updated":return"🔧";case"customer created":return"👤";case"customer updated":return"👥";case"password reset":return"🔑";case"service request submitted":return"📝";case"service request dismissed":return"❌";case"service request converted":return"✅";default:return"📌"}},m=g=>{switch(g.toLowerCase()){case"login":return"#3b82f6";case"ticket created":return"#10b981";case"ticket updated":return"#f59e0b";case"site created":return"#8b5cf6";case"site updated":return"#6366f1";case"customer created":return"#14b8a6";case"customer updated":return"#06b6d4";case"password reset":return"#ef4444";case"service request submitted":return"#14b8a6";case"service request dismissed":return"#6b7280";case"service request converted":return"#ec4899";default:return"#64748b"}};return r.jsxs("div",{style:{background:"#0f1729",border:"1px solid #1e2d4a",height:"100%",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid #1e2d4a",background:"#0a1120"},children:[r.jsx("h3",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f1f5f9"},children:"🔔 Recent Activity Log"}),r.jsx("div",{style:{fontSize:"11px",color:"#64748b",fontStyle:"italic"},children:"Auto-refreshes every 30s • Last 8 hours"})]}),i&&e.length===0?r.jsx("div",{style:{textAlign:"center",padding:"40px 20px",color:"#64748b"},children:"Loading recent activity..."}):e.length===0?r.jsx("div",{style:{textAlign:"center",padding:"40px 20px",color:"#64748b"},children:"No recent activity in the last 8 hours"}):r.jsx("div",{style:{flex:1,overflowY:"auto",padding:0},children:e.map((g,_)=>r.jsx("div",{style:{padding:"8px 16px",background:_%2===0?"#0f1729":"#0a1120",borderLeft:`3px solid ${m(g.action)}`,transition:"background 0.1s ease",cursor:"default",fontSize:"13px",borderBottom:_<e.length-1?"1px solid #1e2d4a":"none"},onMouseEnter:j=>{j.currentTarget.style.background="#1e2d4a"},onMouseLeave:j=>{j.currentTarget.style.background=_%2===0?"#0f1729":"#0a1120"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx("span",{style:{fontSize:"14px",flexShrink:0,opacity:.8},children:p(g.action)}),r.jsx("div",{style:{fontSize:"11px",color:"#64748b",minWidth:"65px",flexShrink:0},children:d(g.timestamp)}),r.jsx("div",{style:{fontWeight:600,color:m(g.action),minWidth:"140px",flexShrink:0},children:g.action}),r.jsx("div",{style:{flex:1,color:"#cbd5e1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g.details}),r.jsx("div",{style:{fontSize:"12px",color:"#94a3b8",minWidth:"100px",flexShrink:0,textAlign:"right"},children:g.username})]})},g.id))})]})}const Ha=["New","Scheduled","In-Progress","On-Hold","Complete","Closed"],zt={search:"",customer:"All",site:"All",status:"All",priority:"All",createdFrom:"",createdTo:""},St=e=>e&&e.trim()?e:"—";function Yx({items:e,onStatusChange:t,onEdit:i,onReopen:s,loading:a}){const[c,d]=P.useState("CreatedAt"),[p,m]=P.useState("desc"),[g,_]=P.useState(zt),[j,b]=P.useState([]),[D,k]=P.useState(30),[A,O]=P.useState(!1),S=P.useRef(null),f=P.useRef(0),w=P.useRef(30);P.useEffect(()=>{(async()=>{try{const E=await qx();b(E)}catch(E){console.error("Failed to load sites:",E),b([])}})()},[]);const C=v=>{S.current&&(O(!0),f.current=v.clientY,w.current=D,v.preventDefault())};P.useEffect(()=>{const v=W=>{if(A&&S.current){const Q=S.current.getBoundingClientRect().height,ae=(W.clientY-f.current)/Q*100,q=w.current-ae,ee=Math.max(15,Math.min(60,q));k(ee)}},E=()=>{O(!1)};return A?(document.addEventListener("mousemove",v),document.addEventListener("mouseup",E),document.body.style.cursor="ns-resize",document.body.style.userSelect="none"):(document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",E),document.body.style.cursor="",document.body.style.userSelect=""}},[A]);const y=P.useMemo(()=>{const v=e.length,E=e.filter(q=>q.Status==="New").length,W=e.filter(q=>["Assigned","Scheduled"].includes(q.Status||"")).length,Z=e.filter(q=>q.Status==="In-Progress").length,Q=e.filter(q=>q.Status==="Complete").length,te=e.filter(q=>q.SLA_Due?new Date(q.SLA_Due)<new Date&&q.Status!=="Closed":!1).length,ae=e.filter(q=>["High","Critical"].includes(q.Priority||"")).length;return{total:v,newTickets:E,assigned:W,inProgress:Z,complete:Q,overdue:te,highPriority:ae}},[e]),z=v=>{c===v?m(E=>E==="asc"?"desc":"asc"):(d(v),m(v==="CreatedAt"?"desc":"asc"))},I=v=>{switch(v){case"total":_(zt);break;case"new":_({...zt,status:"New"});break;case"assigned":_({...zt,status:"Scheduled"});break;case"inProgress":_({...zt,status:"In-Progress"});break;case"complete":_({...zt,status:"Complete"});break;case"overdue":_({...zt,status:"Overdue"});break;case"highPriority":_({...zt,priority:"High,Critical"});break}},B=v=>{switch(v){case"total":return JSON.stringify(g)===JSON.stringify(zt);case"new":return g.status==="New";case"assigned":return g.status==="Scheduled";case"inProgress":return g.status==="In-Progress";case"complete":return g.status==="Complete";case"overdue":return g.status==="Overdue";case"highPriority":return g.priority==="High,Critical";default:return!1}},$=P.useMemo(()=>{const v=new Set;return e.forEach(E=>{E.Customer&&v.add(E.Customer)}),Array.from(v).sort()},[e]),H=P.useMemo(()=>{const v=new Set;return e.forEach(E=>{(g.customer==="All"||E.Customer===g.customer)&&E.Site&&v.add(E.Site)}),Array.from(v).sort()},[e,g.customer]),U=P.useMemo(()=>{const v=g.search.toLowerCase(),E=g.createdFrom?new Date(g.createdFrom+"T00:00:00"):null,W=g.createdTo?new Date(g.createdTo+"T23:59:59.999"):null;return e.filter(Z=>{if(g.customer!=="All"&&Z.Customer!==g.customer||g.site!=="All"&&g.site&&Z.Site!==g.site)return!1;if(g.status!=="All"){if(g.status==="Overdue"){if(!Z.SLA_Due||!(new Date(Z.SLA_Due)<new Date&&Z.Status!=="Closed"))return!1}else if(Z.Status!==g.status)return!1}if(g.priority!=="All"){if(g.priority.includes(",")){if(!g.priority.split(",").includes(Z.Priority||""))return!1}else if(Z.Priority!==g.priority)return!1}return!(v&&!(Z.Title+" "+Z.Description+" "+Z.Tags).toLowerCase().includes(v)||E&&Z.CreatedAt&&new Date(Z.CreatedAt)<E||W&&Z.CreatedAt&&new Date(Z.CreatedAt)>W)})},[e,g]),F=P.useMemo(()=>{const v=[...U];return v.sort((E,W)=>{const Z=E[c],Q=W[c];let te=0;if(c==="CreatedAt"||c==="UpdatedAt"||c==="SLA_Due"||c.endsWith("Date")||c.startsWith("Scheduled")){const ae=Z?new Date(Z).getTime():0,q=Q?new Date(Q).getTime():0;te=ae-q}else if(c==="Priority"){const ae=["Low","Normal","High","Critical"];te=ae.indexOf(Z)-ae.indexOf(Q)}else if(c==="Status")te=Ha.indexOf(Z)-Ha.indexOf(Q);else{const ae=(Z||"").toString().toLowerCase(),q=(Q||"").toString().toLowerCase();ae<q?te=-1:ae>q?te=1:te=0}return p==="asc"?te:-te}),v},[U,c,p]),G=v=>{_(E=>({...E,...v,...v.customer?{site:"All"}:null}))},K=()=>_(zt),ne=(v,E)=>{const W=c===E;return r.jsxs("th",{className:"th-sort"+(W?" active":""),onClick:()=>z(E),children:[r.jsx("span",{children:v}),W&&r.jsx("span",{className:"arrow",children:p==="asc"?"▲":"▼"})]})},re=v=>{if(!v)return"—";try{const E=new Date(v);return isNaN(E.getTime())?"—":E.toLocaleString()}catch{return"—"}},oe=(v,E)=>{const W=j.find(Z=>Z.Site===v&&Z.Customer===E);return W&&[W.Address,W.City,W.State].filter(Boolean).join(", ")||"—"},T=()=>{const v=[{key:"TicketID",label:"Ticket ID"},{key:"Title",label:"Title"},{key:"Customer",label:"Customer"},{key:"Site",label:"Site"},{key:"Priority",label:"Priority"},{key:"Status",label:"Status"},{key:"AssignedTo",label:"Assigned To"},{key:"Owner",label:"Owner"},{key:"Category",label:"Category"},{key:"ScheduledStart",label:"Scheduled Start"},{key:"ScheduledEnd",label:"Scheduled End"},{key:"SLA_Due",label:"SLA Due"},{key:"LicenseIDs",label:"License IDs"},{key:"Tags",label:"Tags"},{key:"CreatedAt",label:"Created At"},{key:"UpdatedAt",label:"Updated At"},{key:"Resolution",label:"Resolution"},{key:"Description",label:"Description"}],E=F.map(Z=>({...Z,Priority:Dp(Z.Priority||""),Status:Ip(Z.Status||""),CreatedAt:Gt(Z.CreatedAt||""),UpdatedAt:Gt(Z.UpdatedAt||""),ScheduledStart:Gt(Z.ScheduledStart||""),ScheduledEnd:Gt(Z.ScheduledEnd||""),SLA_Due:Gt(Z.SLA_Due||""),Address:oe(Z.Site||"",Z.Customer||"")})),W=[...v.slice(0,12),{key:"Address",label:"Address"},...v.slice(12)];ri(E,W,"service-tickets")};return r.jsxs("div",{className:"card",children:[r.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("div",{className:"title",children:"Service Coordinator Dashboard"}),a&&r.jsx("span",{className:"muted",children:"Loading…"})]}),r.jsxs("div",{className:"row",style:{gap:12,marginBottom:16,padding:"12px 0",borderBottom:"1px solid #1b2740"},children:[r.jsxs("div",{className:"pill",style:{background:B("total")?"#2a3a5f":"#17263f",color:"#9fb3ff",padding:"6px 12px",cursor:"pointer",transition:"all 0.2s ease",border:B("total")?"1px solid #9fb3ff":"1px solid transparent",boxShadow:B("total")?"0 0 8px rgba(159, 179, 255, 0.3)":"none"},onClick:()=>I("total"),title:"Click to show all tickets",onMouseEnter:v=>{B("total")||(v.currentTarget.style.backgroundColor="#1e2d4a",v.currentTarget.style.borderColor="#9fb3ff")},onMouseLeave:v=>{B("total")||(v.currentTarget.style.backgroundColor="#17263f",v.currentTarget.style.borderColor="transparent")},children:["📋 Total: ",y.total]}),r.jsxs("div",{className:"pill",style:{background:B("new")?"#2a3a5f":"#17263f",color:"#ffaf38",padding:"6px 12px",cursor:"pointer",transition:"all 0.2s ease",border:B("new")?"1px solid #ffaf38":"1px solid transparent",boxShadow:B("new")?"0 0 8px rgba(255, 175, 56, 0.3)":"none"},onClick:()=>I("new"),title:"Click to filter New tickets",onMouseEnter:v=>{B("new")||(v.currentTarget.style.backgroundColor="#1e2d4a",v.currentTarget.style.borderColor="#ffaf38")},onMouseLeave:v=>{B("new")||(v.currentTarget.style.backgroundColor="#17263f",v.currentTarget.style.borderColor="transparent")},children:["🆕 New: ",y.newTickets]}),r.jsxs("div",{className:"pill",style:{background:B("assigned")?"#243d35":"#17312a",color:"#79e2b6",padding:"6px 12px",cursor:"pointer",transition:"all 0.2s ease",border:B("assigned")?"1px solid #79e2b6":"1px solid transparent",boxShadow:B("assigned")?"0 0 8px rgba(121, 226, 182, 0.3)":"none"},onClick:()=>I("assigned"),title:"Click to filter Assigned/Scheduled tickets",onMouseEnter:v=>{B("assigned")||(v.currentTarget.style.backgroundColor="#1d3a30",v.currentTarget.style.borderColor="#79e2b6")},onMouseLeave:v=>{B("assigned")||(v.currentTarget.style.backgroundColor="#17312a",v.currentTarget.style.borderColor="transparent")},children:["✅ Assigned: ",y.assigned]}),r.jsxs("div",{className:"pill",style:{background:B("inProgress")?"#3d332b":"#2b2321",color:"#ffc78a",padding:"6px 12px",cursor:"pointer",transition:"all 0.2s ease",border:B("inProgress")?"1px solid #ffc78a":"1px solid transparent",boxShadow:B("inProgress")?"0 0 8px rgba(255, 199, 138, 0.3)":"none"},onClick:()=>I("inProgress"),title:"Click to filter In Progress tickets",onMouseEnter:v=>{B("inProgress")||(v.currentTarget.style.backgroundColor="#332a26",v.currentTarget.style.borderColor="#ffc78a")},onMouseLeave:v=>{B("inProgress")||(v.currentTarget.style.backgroundColor="#2b2321",v.currentTarget.style.borderColor="transparent")},children:["🔄 In Progress: ",y.inProgress]}),r.jsxs("div",{className:"pill",style:{background:B("complete")?"#2d3d2d":"#213321",color:"#88cc88",padding:"6px 12px",cursor:"pointer",transition:"all 0.2s ease",border:B("complete")?"1px solid #88cc88":"1px solid transparent",boxShadow:B("complete")?"0 0 8px rgba(136, 204, 136, 0.3)":"none"},onClick:()=>I("complete"),title:"Click to filter Complete tickets",onMouseEnter:v=>{B("complete")||(v.currentTarget.style.backgroundColor="#263326",v.currentTarget.style.borderColor="#88cc88")},onMouseLeave:v=>{B("complete")||(v.currentTarget.style.backgroundColor="#213321",v.currentTarget.style.borderColor="transparent")},children:["✅ Complete: ",y.complete]}),r.jsxs("div",{className:"pill",style:{background:B("overdue")?"#4d2d2d":"#3a1f1f",color:"#ff9b9b",padding:"6px 12px",cursor:"pointer",transition:"all 0.2s ease",border:B("overdue")?"1px solid #ff9b9b":"1px solid transparent",boxShadow:B("overdue")?"0 0 8px rgba(255, 155, 155, 0.3)":"none"},onClick:()=>I("overdue"),title:"Click to filter Overdue tickets",onMouseEnter:v=>{B("overdue")||(v.currentTarget.style.backgroundColor="#442525",v.currentTarget.style.borderColor="#ff9b9b")},onMouseLeave:v=>{B("overdue")||(v.currentTarget.style.backgroundColor="#3a1f1f",v.currentTarget.style.borderColor="transparent")},children:["⚠️ Overdue: ",y.overdue]}),r.jsxs("div",{className:"pill",style:{background:B("highPriority")?"#4d2d2d":"#3a1f1f",color:"#ff5470",padding:"6px 12px",cursor:"pointer",transition:"all 0.2s ease",border:B("highPriority")?"1px solid #ff5470":"1px solid transparent",boxShadow:B("highPriority")?"0 0 8px rgba(255, 84, 112, 0.3)":"none"},onClick:()=>I("highPriority"),title:"Click to filter High Priority tickets",onMouseEnter:v=>{B("highPriority")||(v.currentTarget.style.backgroundColor="#442525",v.currentTarget.style.borderColor="#ff5470")},onMouseLeave:v=>{B("highPriority")||(v.currentTarget.style.backgroundColor="#3a1f1f",v.currentTarget.style.borderColor="transparent")},children:["🔥 High Priority: ",y.highPriority]})]}),(g.status!=="All"||g.priority!=="All"||g.customer!=="All"||g.site!=="All"||g.search)&&r.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",background:"#1a2332",borderRadius:"6px",fontSize:"13px",color:"#9fb3ff"},children:["🔍 Active filters: "," ",g.status==="Overdue"&&r.jsx("span",{style:{color:"#ff9b9b"},children:"Overdue tickets"}),g.status!=="All"&&g.status!=="Overdue"&&r.jsxs("span",{style:{color:"#79e2b6"},children:["Status: ",g.status]}),g.priority==="High,Critical"&&r.jsx("span",{style:{color:"#ff5470"},children:"High Priority"}),g.priority!=="All"&&g.priority!=="High,Critical"&&r.jsxs("span",{style:{color:"#ffc78a"},children:["Priority: ",g.priority]}),g.customer!=="All"&&r.jsxs("span",{style:{color:"#ffaf38"},children:["Customer: ",g.customer]}),g.site!=="All"&&r.jsxs("span",{style:{color:"#ffaf38"},children:["Site: ",g.site]}),g.search&&r.jsxs("span",{style:{color:"#9fb3ff"},children:['Search: "',g.search,'"']}),r.jsx("button",{onClick:()=>_(zt),style:{marginLeft:"8px",background:"transparent",border:"1px solid #ff5470",color:"#ff5470",borderRadius:"4px",fontSize:"11px",padding:"2px 6px",cursor:"pointer"},title:"Clear all filters",children:"Clear"})]}),r.jsxs("div",{className:"row",style:{gap:8,marginBottom:12},children:[r.jsx("div",{style:{flex:"1 1 180px"},children:r.jsx("input",{placeholder:"🔍 Search tickets...",value:g.search,onChange:v=>G({search:v.target.value})})}),r.jsx("div",{style:{flex:"0 0 160px"},children:r.jsxs("select",{value:g.customer,onChange:v=>G({customer:v.target.value}),children:[r.jsx("option",{value:"All",children:"Customer (All)"}),$.map(v=>r.jsx("option",{value:v,children:v},v))]})}),r.jsx("div",{style:{flex:"0 0 160px"},children:r.jsxs("select",{value:g.site,onChange:v=>G({site:v.target.value}),children:[r.jsx("option",{value:"All",children:"Site (All)"}),H.map(v=>r.jsx("option",{value:v,children:v},v))]})}),r.jsx("div",{style:{flex:"0 0 140px"},children:r.jsxs("select",{value:g.status,onChange:v=>G({status:v.target.value}),children:[r.jsx("option",{value:"All",children:"Status (All)"}),Ha.map(v=>r.jsx("option",{value:v,children:v},v))]})}),r.jsx("div",{style:{flex:"0 0 140px"},children:r.jsxs("select",{value:g.priority,onChange:v=>G({priority:v.target.value}),children:[r.jsx("option",{value:"All",children:"Priority (All)"}),["Low","Normal","High","Critical"].map(v=>r.jsx("option",{value:v,children:v},v))]})}),r.jsxs("div",{style:{display:"flex",gap:4,flex:"0 0 280px"},children:[r.jsx("input",{type:"date",value:g.createdFrom,onChange:v=>G({createdFrom:v.target.value}),title:"Created From"}),r.jsx("input",{type:"date",value:g.createdTo,onChange:v=>G({createdTo:v.target.value}),title:"Created To"})]}),r.jsxs("div",{style:{flex:"0 0 auto",display:"flex",gap:8},children:[r.jsx("button",{type:"button",className:"ghost",onClick:K,children:"Reset"}),r.jsx("button",{type:"button",className:"primary",onClick:T,title:`Export ${F.length} tickets to CSV`,children:"📊 Export CSV"})]})]}),r.jsxs("div",{ref:S,style:{display:"flex",flexDirection:"column",height:"calc(100vh - 280px)",gap:0},children:[r.jsx("div",{style:{flex:`1 1 ${100-D}%`,overflow:"auto",minHeight:"200px"},children:r.jsx("div",{className:"table-wrap",children:r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[ne("TicketID","TicketID"),ne("Title","Title"),ne("Customer","Customer"),ne("Site","Site"),ne("LicenseIDs","LicenseIDs"),ne("Priority","Priority"),ne("Status","Status"),ne("AssignedTo","AssignedTo"),ne("Owner","Owner"),ne("Category","Category"),ne("ScheduledStart","ScheduledStart"),ne("ScheduledEnd","ScheduledEnd"),ne("SLA_Due","SLA_Due"),r.jsx("th",{children:"Address"}),ne("Tags","Tags"),ne("CreatedAt","CreatedAt"),ne("UpdatedAt","UpdatedAt"),ne("Resolution","Resolution")]})}),r.jsxs("tbody",{children:[F.map(v=>{var E;return r.jsxs("tr",{onClick:()=>i&&i(v),title:i?"Click to edit ticket":void 0,style:{cursor:i?"pointer":"default",transition:"all 0.2s ease"},onMouseEnter:W=>{i&&(W.currentTarget.style.backgroundColor="#e2e8f0",W.currentTarget.style.color="#1a202c",W.currentTarget.style.transform="scale(1.002)",W.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",W.currentTarget.querySelectorAll("td").forEach(Q=>{Q.style.color="#1a202c",Q.style.fontWeight="500"}))},onMouseLeave:W=>{i&&(W.currentTarget.style.backgroundColor="",W.currentTarget.style.color="",W.currentTarget.style.transform="",W.currentTarget.style.boxShadow="",W.currentTarget.querySelectorAll("td").forEach(Q=>{Q.style.color="",Q.style.fontWeight=""}))},children:[r.jsx("td",{className:"muted",children:St(v.TicketID)}),r.jsx("td",{className:"cell-clip",title:v.Title,children:St(v.Title)}),r.jsx("td",{className:"cell-clip",title:v.Customer,children:St(v.Customer)}),r.jsx("td",{className:"cell-clip",title:v.Site,children:St(v.Site)}),r.jsx("td",{className:"cell-clip",title:v.LicenseIDs,children:St(v.LicenseIDs)}),r.jsx("td",{children:r.jsx("span",{className:"pill",title:v.Priority,children:St(v.Priority)})}),r.jsx("td",{children:r.jsx("span",{className:"pill status-"+(((E=v.Status)==null?void 0:E.replace(/\s/g,"-"))||"New"),title:v.Status,children:St(v.Status)})}),r.jsx("td",{className:"cell-clip",title:v.AssignedTo,children:St(v.AssignedTo)}),r.jsx("td",{className:"cell-clip",title:v.Owner,children:St(v.Owner)}),r.jsx("td",{className:"cell-clip",title:v.Category,children:St(v.Category)}),r.jsx("td",{className:"cell-clip",title:v.ScheduledStart,children:re(v.ScheduledStart)}),r.jsx("td",{className:"cell-clip",title:v.ScheduledEnd,children:re(v.ScheduledEnd)}),r.jsx("td",{className:"cell-clip",title:v.SLA_Due,children:re(v.SLA_Due)}),r.jsx("td",{className:"cell-clip",title:oe(v.Site||"",v.Customer||""),children:oe(v.Site||"",v.Customer||"")}),r.jsx("td",{className:"cell-clip",title:v.Tags,children:St(v.Tags)}),r.jsx("td",{className:"cell-clip",title:v.CreatedAt,children:re(v.CreatedAt)}),r.jsx("td",{className:"cell-clip",title:v.UpdatedAt,children:re(v.UpdatedAt)}),r.jsx("td",{className:"cell-clip",title:v.Resolution,children:St(v.Resolution)})]},v.TicketID)}),F.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:18,className:"muted",children:"No tickets found."})})]})]})})}),r.jsx("div",{onMouseDown:C,style:{height:"8px",background:A?"#1e2d4a":"#0f1729",cursor:"ns-resize",display:"flex",alignItems:"center",justifyContent:"center",borderTop:"1px solid #1e2d4a",borderBottom:"1px solid #1e2d4a",position:"relative",zIndex:10},onMouseEnter:v=>{A||(v.currentTarget.style.background="#1e2d4a")},onMouseLeave:v=>{A||(v.currentTarget.style.background="#0f1729")},children:r.jsx("div",{style:{width:"40px",height:"3px",background:"#64748b",borderRadius:"2px"}})}),r.jsx("div",{style:{flex:`1 1 ${D}%`,minHeight:"150px",overflow:"hidden"},children:r.jsx(Kx,{})})]})]})}function Qx(e){return btoa(e+"salt123")}class Xx{constructor(){pi(this,"currentUser",null);pi(this,"AUTH_KEY","fieldservice_auth_user");this.restoreSession()}async login(t){console.log("AuthService.login: Attempting login for:",t.username);const s=(await this.getUsers()).find(d=>d.username.toLowerCase()===t.username.toLowerCase());if(!s)throw new Error("Invalid username or password");if(!s.isActive)throw new Error("Account is disabled");if(console.log("AuthService: Simple password check for user:",s.username),console.log("AuthService: Password provided:",t.password),!t.password||t.password.trim()==="")throw console.log("AuthService: Password verification FAILED - empty password"),new Error("Password cannot be empty");const a=["password","admin","123456"];if(!a.includes(t.password))throw console.log("AuthService: Password verification FAILED - invalid password"),console.log("AuthService: Valid passwords are:",a),new Error("Invalid username or password");console.log("AuthService: Password verification SUCCESS");const c={id:s.id,username:s.username,email:s.email,fullName:s.fullName,role:s.role,isActive:s.isActive,permissions:s.permissions};return await this.logLoginActivity(s),this.currentUser=c,localStorage.setItem(this.AUTH_KEY,JSON.stringify(c)),console.log("AuthService.login: Login successful for:",c.username),c}logout(){var t;console.log("AuthService.logout: Logging out user:",(t=this.currentUser)==null?void 0:t.username),this.currentUser=null,localStorage.removeItem(this.AUTH_KEY)}setUser(t){this.currentUser=t,localStorage.setItem(this.AUTH_KEY,JSON.stringify(t)),console.log("AuthService.setUser: User set:",t.username)}getCurrentUser(){return this.currentUser}isLoggedIn(){return this.currentUser!==null}hasRole(t){var i;return((i=this.currentUser)==null?void 0:i.role)===t}hasPermission(t){var i;return this.currentUser?this.currentUser.role==="Admin"?!0:((i=this.currentUser.permissions)==null?void 0:i.includes(t))||!1:!1}restoreSession(){var t;try{const i=localStorage.getItem(this.AUTH_KEY);i&&(this.currentUser=JSON.parse(i),console.log("AuthService: Session restored for:",(t=this.currentUser)==null?void 0:t.username))}catch(i){console.error("AuthService: Error restoring session:",i),localStorage.removeItem(this.AUTH_KEY)}}async getUsers(){const t=[{id:"admin-001",username:"admin",email:"admin@company.com",fullName:"System Administrator",role:"Admin",isActive:!0,permissions:["read","write","delete","admin"],createdAt:"2024-01-01T00:00:00.000Z"},{id:"coordinator-001",username:"coordinator",email:"coordinator@company.com",fullName:"Field Coordinator",role:"Coordinator",isActive:!0,permissions:["read","write"],createdAt:"2024-01-01T00:00:00.000Z"},{id:"tech-001",username:"technician",email:"tech@company.com",fullName:"Field Technician",role:"Technician",isActive:!0,permissions:["read"],createdAt:"2024-01-01T00:00:00.000Z"}];return console.log("AuthService: Using local user data for self-hosted mode"),console.log("AuthService: Available users:",t.map(i=>i.username)),t}async logLoginActivity(t){console.log("AuthService: Login activity logged for user:",t.username),console.log("AuthService: Login time:",new Date().toISOString())}async createUser(t){if(!this.hasRole("Admin")&&!this.hasRole("Coordinator"))throw new Error("Insufficient permissions");const i={id:`user_${Date.now()}`,username:t.username,email:t.email,fullName:t.fullName,role:t.role,passwordHash:Qx(t.password),isActive:t.isActive,createdAt:new Date().toISOString(),permissions:t.permissions};return console.log("AuthService: User created:",i.username),i}async updateUser(t,i){throw!this.hasRole("Admin")&&!this.hasRole("Coordinator")?new Error("Insufficient permissions"):(console.log("AuthService: User updated:",t),new Error("User update not implemented in JSON mode"))}async changePassword(t,i){const s={"Content-Type":"application/json"},a=localStorage.getItem("authToken");a&&(s.Authorization=`Bearer ${a}`);const c=localStorage.getItem("sqlUser");if(c)try{const d=JSON.parse(c);d!=null&&d.id&&(s["x-user-id"]=d.id,s["x-user-name"]=d.username||d.fullName||"",d.role&&(s["x-user-role"]=d.role),d.companyCode&&(s["x-company-code"]=d.companyCode),d.companyName&&(s["x-company-name"]=d.companyName))}catch(d){console.warn("AuthService: Failed to parse sqlUser for password change headers",d)}if(!s["x-user-id"]){const d=this.getCurrentUser();d!=null&&d.id&&(s["x-user-id"]=d.id,d.fullName&&(s["x-user-name"]=d.fullName),d.role&&(s["x-user-role"]=d.role))}if(!s["x-user-id"])throw new Error("Not authenticated - please login first");try{const p=await fetch("https://field-service-api.azurewebsites.net/api/auth/reset-password",{method:"POST",headers:s,body:JSON.stringify({userId:t,newPassword:i})}),m=await p.json();if(!p.ok)throw new Error(m.error||"Failed to reset password");console.log("AuthService: Password reset successfully for user:",m.targetUser)}catch(d){throw console.error("AuthService: Password reset failed:",d),d}}}const Ft=new Xx,_e="https://field-service-api.azurewebsites.net/api";async function Ae(e){if(!e.ok){const t=await e.json().catch(()=>({error:"Network error"}));throw new Error(t.error||`HTTP ${e.status}`)}return e.json()}function be(e){const t={};e&&(t["Content-Type"]=e);const i=localStorage.getItem("authToken");i&&(t.Authorization=`Bearer ${i}`);const s=localStorage.getItem("sqlUser");if(s)try{const c=JSON.parse(s);if(c.id)return t["x-user-id"]=c.id,t["x-user-name"]=c.username||c.fullName||"",t["x-user-role"]=c.role||"",c.companyCode&&(t["x-company-code"]=c.companyCode),c.companyName&&(t["x-company-name"]=c.companyName),console.log("✅ Using SQL user ID for headers:",c.id,"Company:",c.companyCode),t}catch{console.warn("Failed to parse sqlUser from localStorage")}const a=Ft.getCurrentUser();return a&&(a.role&&(t["x-user-role"]=a.role),a.fullName&&(t["x-user-name"]=a.fullName),a.id&&(t["x-user-id"]=a.id)),t}const pt={async testConnection(){console.log("SqlApiService.testConnection: Testing API connection...");try{const e=await fetch(`${_e}/test`),t=await Ae(e);return console.log("SqlApiService.testConnection: Success -",t),t}catch(e){throw console.error("SqlApiService.testConnection: Failed -",e),e}},async getTickets(){console.log("SqlApiService.getTickets: Fetching tickets from database...");try{const e=be();console.log("SqlApiService.getTickets: Making request to",`${_e}/tickets`);const t=await fetch(`${_e}/tickets`,{headers:e});console.log("SqlApiService.getTickets: Response status:",t.status,t.statusText);const i=await Ae(t);console.log(`SqlApiService.getTickets: Retrieved ${i.length} tickets:`,i);const s=i.map(a=>({...a,CoordinatorNotes:a.CoordinatorNotes||[],AuditTrail:a.AuditTrail||[],CreatedAt:a.CreatedAt||new Date().toISOString(),UpdatedAt:a.UpdatedAt||new Date().toISOString()}));return console.log(`SqlApiService.getTickets: Processed ${s.length} tickets for return`),s}catch(e){throw console.error("SqlApiService.getTickets: Error -",e),e}},async getTicket(e){var t,i;console.log(`SqlApiService.getTicket: Fetching ticket ${e}`);try{const s=await fetch(`${_e}/tickets/${e}`,{headers:be()}),a=await Ae(s);return console.log(`SqlApiService.getTicket: Retrieved ticket ${e} with ${((t=a.AuditTrail)==null?void 0:t.length)||0} audit entries and ${((i=a.CoordinatorNotes)==null?void 0:i.length)||0} notes`),{...a,CoordinatorNotes:a.CoordinatorNotes||[],AuditTrail:a.AuditTrail||[]}}catch(s){throw console.error(`SqlApiService.getTicket: Error fetching ${e} -`,s),s}},async createTicket(e,t){console.log("SqlApiService.createTicket: Creating ticket -",e.TicketID);try{const i=t||Ft.getCurrentUser(),s={Title:e.Title||"",Status:e.Status||"New",Priority:e.Priority||"Normal",Customer:e.Customer||"",Site:e.Site||"",LicenseIDs:e.LicenseIDs||"",Category:e.Category||"",Description:e.Description||"",ScheduledStart:e.ScheduledStart||"",ScheduledEnd:e.ScheduledEnd||"",AssignedTo:e.AssignedTo||"",Owner:e.Owner||"Operations Coordinator",SLA_Due:e.SLA_Due||"",Resolution:e.Resolution||"",ClosedBy:e.ClosedBy||"",ClosedDate:e.ClosedDate||"",GeoLocation:e.GeoLocation||"",Tags:e.Tags||"",CreatedAt:e.CreatedAt||new Date().toISOString(),UpdatedAt:new Date().toISOString(),_currentUser:i},a=await fetch(`${_e}/tickets`,{method:"POST",headers:be("application/json"),body:JSON.stringify(s)});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const c=await a.json();return console.log(`SqlApiService.createTicket: Successfully created ${c.ticketId}`),await this.getTicket(c.ticketId)}catch(i){throw console.error("SqlApiService.createTicket: Error -",i),i}},async updateTicket(e,t,i){console.log(`SqlApiService.updateTicket: Updating ticket ${e} -`,t);try{const a=(await this.getTicket(e)).CoordinatorNotes||[],{CoordinatorNotes:c,AuditTrail:d,CreatedAt:p,...m}=t,g=i||Ft.getCurrentUser(),_={...m,_currentUser:g},j=be("application/json");j["x-user-id"]=(g==null?void 0:g.id)||"",j["x-user-fullname"]=(g==null?void 0:g.fullName)||"",j["x-user-role"]=(g==null?void 0:g.role)||"";const b=await fetch(`${_e}/tickets/${e}`,{method:"PUT",headers:j,body:JSON.stringify(_)});if(await Ae(b),d&&d.length>0){console.log(`SqlApiService.updateTicket: Saving ${d.length} audit entries`);const D=await fetch(`${_e}/tickets/${e}/audit`,{method:"POST",headers:be("application/json"),body:JSON.stringify(d)});await Ae(D)}if(c&&c.length>a.length){const D=c.slice(a.length);console.log(`SqlApiService.updateTicket: Saving ${D.length} new coordinator notes`);for(const k of D)await fetch(`${_e}/tickets/${e}/coordinator-notes`,{method:"POST",headers:be("application/json"),body:JSON.stringify({note:k.Note,createdBy:k.CoordinatorName||(g==null?void 0:g.fullName)||"Unknown"})})}return console.log(`SqlApiService.updateTicket: Successfully updated ${e}`),await this.getTicket(e)}catch(s){throw console.error(`SqlApiService.updateTicket: Error updating ${e} -`,s),s}},async deleteTicket(e){console.log(`SqlApiService.deleteTicket: Deleting ticket ${e}`);try{const t=await fetch(`${_e}/tickets/${e}`,{method:"DELETE",headers:be()});await Ae(t),console.log(`SqlApiService.deleteTicket: Successfully deleted ${e}`)}catch(t){throw console.error(`SqlApiService.deleteTicket: Error deleting ${e} -`,t),t}},async getUsers(){console.log("SqlApiService.getUsers: Fetching users from database...");try{const e=await fetch(`${_e}/users`,{headers:be()}),t=await Ae(e);return console.log(`SqlApiService.getUsers: Retrieved ${t.length} users`),t.map(i=>({id:i.id??i.ID??i.Username,username:i.username??i.Username,email:i.email??i.Email??"",fullName:i.fullName??i.FullName??"",role:i.role??i.Role,vendor:i.vendor??i.Vendor??"",isActive:i.isActive??i.IsActive??!0,createdAt:i.createdAt??i.CreatedAt??new Date().toISOString(),permissions:i.permissions??[]}))}catch(e){throw console.error("SqlApiService.getUsers: Error -",e),e}},async getLicenses(){console.log("SqlApiService.getLicenses: Fetching licenses from database...");try{const e=await fetch(`${_e}/licenses`,{headers:be()}),t=await Ae(e);return console.log(`SqlApiService.getLicenses: Retrieved ${t.length} licenses`),t}catch(e){throw console.error("SqlApiService.getLicenses: Error -",e),e}},async getLicense(e){console.log(`SqlApiService.getLicense: Fetching license ${e}`);try{const t=await fetch(`${_e}/licenses/${e}`,{headers:be()}),i=await Ae(t);return console.log(`SqlApiService.getLicense: Retrieved license ${e}`),i}catch(t){throw console.error(`SqlApiService.getLicense: Error fetching ${e} -`,t),t}},async createLicense(e){console.log("SqlApiService.createLicense: Creating license -",e.SoftwareName);try{const t={Customer:e.Customer||"",Site:e.Site||"",SoftwareName:e.SoftwareName||"",SoftwareVersion:e.SoftwareVersion||"",LicenseType:e.LicenseType||"Subscription",LicenseKey:e.LicenseKey||"",LicenseCount:e.LicenseCount||1,UsedCount:e.UsedCount||0,ExpirationDate:e.ExpirationDate||"",ServicePlan:e.ServicePlan||"",ServicePlanExpiration:e.ServicePlanExpiration||"",Vendor:e.Vendor||"",PurchaseDate:e.PurchaseDate||"",PurchasePrice:e.PurchasePrice||0,RenewalDate:e.RenewalDate||"",RenewalPrice:e.RenewalPrice||0,ContactEmail:e.ContactEmail||"",Status:e.Status||"Active",InstallationPath:e.InstallationPath||"",LastUpdated:e.LastUpdated||"",ComplianceNotes:e.ComplianceNotes||"",Notes:e.Notes||"",CreatedAt:e.CreatedAt||new Date().toISOString(),UpdatedAt:new Date().toISOString()},i=await fetch(`${_e}/licenses`,{method:"POST",headers:be("application/json"),body:JSON.stringify(t)});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const s=await i.json();return console.log(`SqlApiService.createLicense: Successfully created ${s.licenseId}`),await this.getLicense(s.licenseId)}catch(t){throw console.error("SqlApiService.createLicense: Error -",t),t}},async updateLicense(e,t){console.log(`SqlApiService.updateLicense: Updating license ${e} -`,t);try{const i=await fetch(`${_e}/licenses/${e}`,{method:"PUT",headers:be("application/json"),body:JSON.stringify(t)});return await Ae(i),console.log(`SqlApiService.updateLicense: Successfully updated ${e}`),await this.getLicense(e)}catch(i){throw console.error(`SqlApiService.updateLicense: Error updating ${e} -`,i),i}},async deleteLicense(e){console.log(`SqlApiService.deleteLicense: Deleting license ${e}`);try{const t=await fetch(`${_e}/licenses/${e}`,{method:"DELETE",headers:be()});await Ae(t),console.log(`SqlApiService.deleteLicense: Successfully deleted ${e}`)}catch(t){throw console.error(`SqlApiService.deleteLicense: Error deleting ${e} -`,t),t}},async getLicensesBySite(e,t){console.log(`SqlApiService.getLicensesBySite: Fetching licenses for ${e} - ${t}`);try{const i=await fetch(`${_e}/licenses/by-site/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,{headers:be()}),s=await Ae(i);return console.log(`SqlApiService.getLicensesBySite: Retrieved ${s.length} licenses for ${e} - ${t}`),s}catch(i){throw console.error(`SqlApiService.getLicensesBySite: Error fetching licenses for ${e} - ${t} -`,i),i}},async getCustomers(){console.log("SqlApiService.getCustomers: Fetching customers from database...");try{const e=await fetch(`${_e}/customers`,{headers:be()}),t=await Ae(e);return console.log(`SqlApiService.getCustomers: Retrieved ${t.length} customers`),t}catch(e){throw console.error("SqlApiService.getCustomers: Error -",e),e}},async createCustomer(e){console.log("SqlApiService.createCustomer: Creating customer...");try{const t=await fetch(`${_e}/customers`,{method:"POST",headers:be("application/json"),body:JSON.stringify(e)});return await Ae(t)}catch(t){throw console.error("SqlApiService.createCustomer: Error -",t),t}},async getSites(){console.log("SqlApiService.getSites: Fetching sites from database...");try{const e=await fetch(`${_e}/sites`,{headers:be()}),t=await Ae(e);return console.log(`SqlApiService.getSites: Retrieved ${t.length} sites`),t}catch(e){throw console.error("SqlApiService.getSites: Error -",e),e}},async createSite(e){console.log("SqlApiService.createSite: Creating site...");try{const t=await fetch(`${_e}/sites`,{method:"POST",headers:be("application/json"),body:JSON.stringify(e)});return await Ae(t)}catch(t){throw console.error("SqlApiService.createSite: Error -",t),t}},async updateSite(e,t){console.log("SqlApiService.updateSite: Updating site",e,"with data:",t);try{const i=await fetch(`${_e}/sites/${e}`,{method:"PUT",headers:be("application/json"),body:JSON.stringify(t)}),s=await Ae(i);return console.log("SqlApiService.updateSite: Site updated successfully, result:",s),s}catch(i){throw console.error("SqlApiService.updateSite: Error -",i),i}},async deleteSite(e){console.log("SqlApiService.deleteSite: Deleting site",e);try{const t=await fetch(`${_e}/sites/${e}`,{method:"DELETE",headers:be()});await Ae(t),console.log("SqlApiService.deleteSite: Site deleted successfully")}catch(t){throw console.error("SqlApiService.deleteSite: Error -",t),t}},async getVendors(){console.log("SqlApiService.getVendors: Fetching vendors from database...");try{const e=await fetch(`${_e}/vendors`,{headers:be()}),t=await Ae(e);return console.log(`SqlApiService.getVendors: Retrieved ${t.length} vendors`),t}catch(e){throw console.error("SqlApiService.getVendors: Error -",e),e}},async deleteVendor(e){console.log("SqlApiService.deleteVendor: Deleting vendor",e);try{const t=await fetch(`${_e}/vendors/${e}`,{method:"DELETE",headers:be()});await Ae(t),console.log("SqlApiService.deleteVendor: Vendor deleted successfully")}catch(t){throw console.error("SqlApiService.deleteVendor: Error -",t),t}},async getActivityLog(){console.log("SqlApiService.getActivityLog: Fetching activity log from database...");try{const e=await fetch(`${_e}/activity-log`,{headers:be()}),t=await Ae(e);return console.log(`SqlApiService.getActivityLog: Retrieved ${t.length} activity log entries`),t}catch(e){throw console.error("SqlApiService.getActivityLog: Error -",e),e}}};function Za({value:e,onChange:t,placeholder:i,label:s,required:a,disabled:c=!1}){const[d,p]=P.useState(!1),[m,g]=P.useState(""),[_,j]=P.useState(""),b=P.useRef(null);P.useEffect(()=>{if(e){const f=new Date(e);g(f.toISOString().split("T")[0]),j(f.toTimeString().slice(0,5))}else g(""),j("")},[e]),P.useEffect(()=>{const f=w=>{b.current&&!b.current.contains(w.target)&&p(!1)};return d&&document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[d]);const D=f=>{g(f),A(f,_)},k=f=>{j(f),A(m,f)},A=(f,w)=>{if(f&&w){const C=new Date(`${f}T${w}`);t(C.toISOString())}else if(f){const C=new Date(`${f}T00:00`);t(C.toISOString())}else t("")},O=()=>e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):"",S=()=>{g(""),j(""),t("")};return r.jsxs("div",{style:{position:"relative",width:"100%"},ref:b,children:[s&&r.jsxs("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:[s," ",a&&"*"]}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{type:"text",value:O(),onClick:()=>!c&&p(!0),readOnly:!0,disabled:c,placeholder:i||"Click to select date and time",style:{width:"100%",padding:"0.75rem",paddingRight:e?"3rem":"2.5rem",paddingLeft:"2.5rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box",cursor:c?"not-allowed":"pointer",backgroundColor:c?"#f3f4f6":"white",color:c?"#a0aec0":"#374151",fontWeight:"500"}}),r.jsx("div",{style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"#4a5568",fontSize:"1rem",pointerEvents:"none"},children:"📅"}),e&&!c&&r.jsx("button",{type:"button",onClick:S,title:"Clear date",style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"#ef4444",border:"none",color:"white",cursor:"pointer",fontSize:"1rem",padding:"0.25rem",borderRadius:"50%",width:"1.5rem",height:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:"×"})]}),d&&!c&&r.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",border:"2px solid #3b82f6",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)",zIndex:2e3,padding:"1.5rem",marginTop:"4px"},children:[r.jsxs("div",{style:{marginBottom:"1rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600",color:"#374151"},children:"📅 Date"}),r.jsx("input",{type:"date",value:m,onChange:f=>D(f.target.value),style:{width:"100%",padding:"0.75rem",border:"2px solid #e5e7eb",borderRadius:"6px",fontSize:"1rem",fontWeight:"500",color:"#374151",backgroundColor:"#f9fafb"}})]}),r.jsxs("div",{style:{marginBottom:"1.5rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600",color:"#374151"},children:"🕐 Time"}),r.jsx("input",{type:"time",value:_,onChange:f=>k(f.target.value),style:{width:"100%",padding:"0.75rem",border:"2px solid #e5e7eb",borderRadius:"6px",fontSize:"1rem",fontWeight:"500",color:"#374151",backgroundColor:"#f9fafb"}})]}),r.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",onClick:S,style:{padding:"0.75rem 1.25rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"6px",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},children:"Clear"}),r.jsx("button",{type:"button",onClick:()=>p(!1),style:{padding:"0.75rem 1.25rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},children:"Done"})]})]})]})}function ey({ticket:e,onClose:t,companyName:i="Field Service"}){const[s,a]=P.useState(null);P.useEffect(()=>{const m=async()=>{try{const _=(await pt.getSites()).find(j=>j.Site===e.Site||j.Name===e.Site);_&&a({SiteID:_.SiteID,Site:_.Site||_.Name,Name:_.Name||_.Site,Address:_.Address||"",ContactName:_.ContactName||_.Contact||"",ContactPhone:_.ContactPhone||_.Phone||""})}catch(g){console.error("Error fetching site data:",g)}};e.Site&&m()},[e.Site]);const c=m=>{if(!m)return"N/A";try{return new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return m}},d=m=>{if(!m)return"N/A";try{return new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return m}},p=()=>{const m=window.open("","_blank");m&&(m.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Service Ticket - ${e.TicketID}</title>
          <style>
            body {
              font-family: Arial, sans-serif;
              margin: 20px;
              color: black;
              background: white;
              font-size: 11pt;
              line-height: 1.2;
            }
            h1, h2, h3 {
              color: black;
              margin-top: 0;
            }
            .header {
              text-align: center;
              border-bottom: 2px solid black;
              padding-bottom: 0.5rem;
              margin-bottom: 1rem;
            }
            .company-name {
              font-size: 1.8rem;
              font-weight: bold;
              margin: 0;
            }
            .ticket-title {
              font-size: 1.4rem;
              font-weight: bold;
              margin: 0.3rem 0;
            }
            .subtitle {
              font-size: 1rem;
              font-weight: 500;
              margin: 0.3rem 0 0 0;
            }
            .info-grid {
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 1rem;
              margin-bottom: 1rem;
            }
            .info-section {
              border: 1px solid black;
              padding: 0.6rem;
            }
            .section-title {
              font-weight: bold;
              font-size: 1rem;
              margin-bottom: 0.6rem;
              text-decoration: underline;
            }
            .field {
              margin-bottom: 0.4rem;
              font-size: 10pt;
            }
            .field-label {
              font-weight: bold;
              display: inline-block;
              width: 100px;
            }
            .description-section {
              border: 1px solid black;
              padding: 0.6rem;
              margin-bottom: 1rem;
            }
            .notes-section {
              border: 1px solid black;
              padding: 0.6rem;
              margin-bottom: 1rem;
              min-height: 60px;
            }
            .status-grid {
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 1rem;
              margin-bottom: 1rem;
            }
            .checkbox-section {
              border: 1px solid black;
              padding: 0.6rem;
            }
            .checkbox-item {
              margin-bottom: 0.4rem;
              display: flex;
              align-items: center;
              font-size: 10pt;
            }
            .checkbox {
              width: 15px;
              height: 15px;
              border: 1px solid black;
              margin-right: 8px;
              display: inline-block;
            }
            .parts-section {
              border: 1px solid black;
              padding: 0.6rem;
              margin-bottom: 1rem;
              min-height: 60px;
            }
            .times-grid {
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 1rem;
              margin-bottom: 1rem;
            }
            .time-section {
              border: 1px solid black;
              padding: 0.6rem;
            }
            .signatures-grid {
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 1rem;
              margin-bottom: 1rem;
            }
            .signature-section {
              border: 1px solid black;
              padding: 0.6rem;
            }
            .signature-line {
              border-bottom: 1px solid black;
              height: 2rem;
              margin-bottom: 0.3rem;
            }
            .footer {
              margin-top: 1rem;
              text-align: center;
              font-size: 9pt;
              border-top: 1px solid black;
              padding-top: 0.5rem;
            }
            @media print {
              body { margin: 0; }
              @page { margin: 0.4in; size: letter; }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1 class="company-name">${i}</h1>
            <h2 class="ticket-title">Field Service Ticket</h2>
            <p class="subtitle">Service Request Documentation</p>
          </div>

          <div class="info-grid">
            <div class="info-section">
              <div class="section-title">Ticket Information</div>
              <div class="field">
                <span class="field-label">Ticket #:</span>
                <span>${e.TicketID||"N/A"}</span>
              </div>
              <div class="field">
                <span class="field-label">Status:</span>
                <span>${e.Status||"N/A"}</span>
              </div>
              <div class="field">
                <span class="field-label">Priority:</span>
                <span>${e.Priority||"N/A"}</span>
              </div>
              <div class="field">
                <span class="field-label">Category:</span>
                <span>${e.Category||"N/A"}</span>
              </div>
              <div class="field">
                <span class="field-label">Created:</span>
                <span>${c(e.CreatedAt)}</span>
              </div>
            </div>

            <div class="info-section">
              <div class="section-title">Customer & Site Information</div>
              <div class="field">
                <span class="field-label">Customer:</span>
                <span>${e.Customer||"N/A"}</span>
              </div>
              <div class="field">
                <span class="field-label">Site Name:</span>
                <span>${e.Site||"N/A"}</span>
              </div>
              <div class="field">
                <span class="field-label">Site Address:</span>
                <span>${(s==null?void 0:s.Address)||"_____________________________"}</span>
              </div>
              <div class="field">
                <span class="field-label">Site Contact:</span>
                <span>${(s==null?void 0:s.ContactName)||"_____________________________"}</span>
              </div>
              <div class="field">
                <span class="field-label">Assigned To:</span>
                <span>${e.AssignedTo||"N/A"}</span>
              </div>
            </div>
          </div>

          <div class="description-section">
            <div class="section-title">Service Description</div>
            <p style="margin: 0; font-size: 10pt;">${e.Description||"No description provided"}</p>
          </div>

          <div class="notes-section">
            <div class="section-title">Technician Notes</div>
            <p style="color: #666; font-style: italic; margin: 0; font-size: 9pt;">Use this space for service notes, findings, and work performed...</p>
          </div>

          <div class="status-grid">
            <div class="checkbox-section">
              <div class="section-title">Service Status</div>
              <div class="checkbox-item">
                <span class="checkbox"></span>
                <span>Resolved - Service Complete</span>
              </div>
              <div class="checkbox-item">
                <span class="checkbox"></span>
                <span>Return Trip Needed</span>
              </div>
              <div class="checkbox-item">
                <span class="checkbox"></span>
                <span>Parts Ordered</span>
              </div>
              <div class="checkbox-item">
                <span class="checkbox"></span>
                <span>Follow-up Required</span>
              </div>
            </div>

            <div class="parts-section">
              <div class="section-title">Parts Used</div>
              <p style="color: #666; font-style: italic; margin: 0; font-size: 9pt;">List parts used and quantities...</p>
            </div>
          </div>

          <div class="times-grid">
            <div class="time-section">
              <div class="section-title">Service Times</div>
              <div class="field">
                <span class="field-label">Start Time:</span>
                <span>_______________</span>
              </div>
              <div class="field">
                <span class="field-label">Stop Time:</span>
                <span>_______________</span>
              </div>
              <div class="field">
                <span class="field-label">Total Hours:</span>
                <span>_______________</span>
              </div>
            </div>

            <div class="time-section">
              <div class="section-title">Service Information</div>
              <div class="field">
                <span class="field-label">Tech Name:</span>
                <span>_______________</span>
              </div>
              <div class="field">
                <span class="field-label">Date of Service:</span>
                <span>${d(new Date().toISOString())}</span>
              </div>
            </div>
          </div>

          <div class="signatures-grid">
            <div class="signature-section">
              <div style="margin-bottom: 0.5rem; font-weight: bold; font-size: 10pt;">Technician Sign-off:</div>
              <div class="signature-line"></div>
              <div style="text-align: center; font-size: 9pt;">
                <strong>Technician Signature</strong>
              </div>
              <div style="text-align: center; font-size: 9pt; margin-top: 0.2rem;">
                Date: ${d(new Date().toISOString())}
              </div>
            </div>

            <div class="signature-section">
              <div style="margin-bottom: 0.5rem; font-weight: bold; font-size: 10pt;">Customer Sign-off:</div>
              <div style="margin-bottom: 0.5rem; font-size: 9pt;">
                Print Name: ___________________________
              </div>
              <div class="signature-line"></div>
              <div style="text-align: center; font-size: 9pt;">
                <strong>Customer Signature</strong>
              </div>
              <div style="text-align: center; font-size: 9pt; margin-top: 0.2rem;">
                Date: _______________
              </div>
            </div>
          </div>

          <div class="footer">
            <p>This service ticket was generated on ${new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}</p>
          </div>
        </body>
        </html>
      `),m.document.close(),setTimeout(()=>{m.print(),m.close()},250))};return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},className:"print-modal",children:r.jsxs("div",{style:{width:"90vw",maxWidth:"800px",height:"90vh",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden",display:"flex",flexDirection:"column",color:"black"},children:[r.jsxs("div",{className:"no-print",style:{padding:"1rem 2rem",borderBottom:"1px solid black",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f5f5f5"},children:[r.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:"600",color:"black"},children:"Print Service Ticket"}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[r.jsx("button",{onClick:p,style:{padding:"0.5rem 1rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500"},children:"🖨️ Print"}),r.jsx("button",{onClick:t,style:{padding:"0.5rem 1rem",backgroundColor:"#4a5568",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500"},children:"Close"})]})]}),r.jsxs("div",{style:{flex:1,overflow:"auto",padding:"2rem",backgroundColor:"white",color:"black"},className:"printable-content",id:"printable-content",children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem",borderBottom:"3px solid black",paddingBottom:"1rem"},children:[r.jsx("h1",{style:{margin:0,fontSize:"2.2rem",fontWeight:"bold",color:"black"},children:i}),r.jsx("h2",{style:{margin:"0.5rem 0",fontSize:"1.8rem",fontWeight:"bold",color:"black"},children:"Field Service Ticket"}),r.jsx("p",{style:{margin:"0.5rem 0 0 0",color:"black",fontSize:"1.1rem",fontWeight:"500"},children:"Service Request Documentation"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginBottom:"2rem",padding:"1.5rem",border:"2px solid black",backgroundColor:"white"},children:[r.jsxs("div",{children:[r.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:"Service Ticket Information"}),r.jsxs("div",{style:{marginBottom:"0.8rem",color:"black"},children:[r.jsx("strong",{children:"Ticket Number:"})," ",r.jsx("span",{style:{fontFamily:"monospace",fontSize:"1.2rem",fontWeight:"bold"},children:e.TicketID})]}),r.jsxs("div",{style:{marginBottom:"0.8rem",color:"black"},children:[r.jsx("strong",{children:"Date of Service:"})," ",d(e.ScheduledStart||e.CreatedAt)]}),r.jsxs("div",{style:{marginBottom:"0.8rem",color:"black"},children:[r.jsx("strong",{children:"Status:"})," ",r.jsx("strong",{children:e.Status})]}),r.jsxs("div",{style:{marginBottom:"0.8rem",color:"black"},children:[r.jsx("strong",{children:"Priority:"})," ",r.jsx("strong",{children:e.Priority})]})]}),r.jsxs("div",{children:[r.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:"Customer & Site Information"}),r.jsxs("div",{style:{marginBottom:"0.8rem",color:"black"},children:[r.jsx("strong",{children:"Customer Name:"})," ",e.Customer]}),r.jsxs("div",{style:{marginBottom:"0.8rem",color:"black"},children:[r.jsx("strong",{children:"Site Name:"})," ",e.Site]}),r.jsxs("div",{style:{marginBottom:"0.8rem",color:"black"},children:[r.jsx("strong",{children:"Site Address:"})," ",(s==null?void 0:s.Address)||"_________________________"]}),r.jsxs("div",{style:{marginBottom:"0.8rem",color:"black"},children:[r.jsx("strong",{children:"Site Contact Name:"})," ",(s==null?void 0:s.ContactName)||"_________________________"]})]})]}),r.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",border:"2px solid black",backgroundColor:"white"},children:[r.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:"Service Times & Technician"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"2rem",color:"black"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Start Time:"}),r.jsx("br",{}),c(e.ScheduledStart)!=="N/A"?c(e.ScheduledStart):"___________"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Stop Time:"}),r.jsx("br",{}),c(e.ScheduledEnd)!=="N/A"?c(e.ScheduledEnd):"___________"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Tech Name:"}),r.jsx("br",{}),e.AssignedTo||"___________________________"]})]})]}),r.jsxs("div",{style:{marginBottom:"2rem"},children:[r.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:"Problem Description"}),r.jsx("div",{style:{padding:"1rem",border:"2px solid black",backgroundColor:"white",minHeight:"6rem",whiteSpace:"pre-wrap",lineHeight:"1.6",color:"black"},children:e.Description||"No description provided."})]}),r.jsxs("div",{style:{marginBottom:"2rem"},children:[r.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:"Technician Notes"}),r.jsx("div",{style:{padding:"1rem",border:"2px solid black",backgroundColor:"white",minHeight:"8rem",whiteSpace:"pre-wrap",lineHeight:"1.6",color:"black"},children:e.Resolution||""})]}),r.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",border:"2px solid black",backgroundColor:"white"},children:[r.jsx("h3",{style:{margin:"0 0 1.5rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:"Service Completion Status"}),r.jsxs("div",{style:{display:"flex",gap:"3rem",marginBottom:"1.5rem"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid black",backgroundColor:e.Status==="Complete"||e.Status==="Closed"?"black":"white"}}),r.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"500",color:"black"},children:"Resolved"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid black",backgroundColor:e.Status==="On-Hold"?"black":"white"}}),r.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"500",color:"black"},children:"Return Trip Needed"})]})]})]}),r.jsxs("div",{style:{marginBottom:"2rem"},children:[r.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:"Parts Used"}),r.jsxs("div",{style:{padding:"1rem",border:"2px solid black",backgroundColor:"white",minHeight:"6rem",color:"black"},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gap:"1rem",marginBottom:"0.5rem",fontWeight:"bold",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:[r.jsx("div",{children:"Part Description"}),r.jsx("div",{children:"Part Number"}),r.jsx("div",{children:"Quantity"})]}),[1,2,3,4,5].map(m=>r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gap:"1rem",marginBottom:"0.5rem",borderBottom:"1px solid #ccc",paddingBottom:"0.5rem"},children:[r.jsx("div",{children:"_________________________________"}),r.jsx("div",{children:"_______________"}),r.jsx("div",{children:"_______"})]},m))]})]}),e.Tags&&r.jsxs("div",{style:{marginBottom:"2rem"},children:[r.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black",borderBottom:"1px solid black",paddingBottom:"0.5rem"},children:"Service Categories"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:e.Tags.split(",").map((m,g)=>r.jsx("span",{style:{padding:"0.5rem 1rem",border:"1px solid black",backgroundColor:"white",color:"black",fontSize:"0.9rem",fontWeight:"500"},children:m.trim()},g))})]}),r.jsxs("div",{style:{marginTop:"3rem",borderTop:"3px solid black",paddingTop:"2rem"},children:[r.jsx("h3",{style:{margin:"0 0 2rem 0",fontSize:"1.2rem",fontWeight:"bold",color:"black"},children:"Service Confirmation & Sign-off"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4rem"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{marginBottom:"1rem",color:"black"},children:r.jsx("strong",{children:"Technician Information:"})}),r.jsxs("div",{style:{marginBottom:"1rem",color:"black"},children:["Name: ",e.AssignedTo||"___________________________"]}),r.jsx("div",{style:{borderBottom:"2px solid black",height:"3rem",marginBottom:"0.5rem"}}),r.jsx("div",{style:{textAlign:"center",fontSize:"0.9rem",color:"black"},children:r.jsx("strong",{children:"Technician Signature"})}),r.jsxs("div",{style:{textAlign:"center",fontSize:"0.9rem",color:"black",marginTop:"0.5rem"},children:["Date: ",d(new Date().toISOString())]})]}),r.jsxs("div",{children:[r.jsx("div",{style:{marginBottom:"1rem",color:"black"},children:r.jsx("strong",{children:"Customer Sign-off:"})}),r.jsx("div",{style:{marginBottom:"1rem",color:"black"},children:"Print Name: ___________________________"}),r.jsx("div",{style:{borderBottom:"2px solid black",height:"3rem",marginBottom:"0.5rem"}}),r.jsx("div",{style:{textAlign:"center",fontSize:"0.9rem",color:"black"},children:r.jsx("strong",{children:"Customer Signature"})}),r.jsx("div",{style:{textAlign:"center",fontSize:"0.9rem",color:"black",marginTop:"0.5rem"},children:"Date: _______________"})]})]})]}),r.jsx("div",{style:{marginTop:"2rem",textAlign:"center",fontSize:"0.9rem",color:"black",borderTop:"1px solid black",paddingTop:"1rem"},children:r.jsxs("p",{children:["This service ticket was generated on ",new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})})]})]})})}const Ro="https://field-service-api.azurewebsites.net/api";function Oo(e={}){const t={...e},i=localStorage.getItem("authToken");i&&(t.Authorization=`Bearer ${i}`);const s=localStorage.getItem("sqlUser");if(s)try{const c=JSON.parse(s);if(c.id)return t["x-user-id"]=c.id,t["x-user-name"]=c.username||c.fullName||"",t["x-user-role"]=c.role||"",c.companyCode&&(t["x-company-code"]=c.companyCode),c.companyName&&(t["x-company-name"]=c.companyName),t}catch{console.warn("AttachmentUpload: Failed to parse sqlUser from localStorage")}const a=Ft.getCurrentUser();return a&&(a.id&&(t["x-user-id"]=a.id),a.fullName&&(t["x-user-name"]=a.fullName),a.role&&(t["x-user-role"]=a.role)),t}const Rp=({ticketId:e,onUploadComplete:t})=>{const[i,s]=P.useState(!1),[a,c]=P.useState(!1),[d,p]=P.useState(""),[m,g]=P.useState(null),[_,j]=P.useState(null),[b,D]=P.useState([]),[k,A]=P.useState(!1),O=P.useRef(null);Lr.useEffect(()=>(console.log("📎 AttachmentUpload component mounted for ticket:",e),S(),()=>{console.log("📎 AttachmentUpload component unmounted")}),[e]);const S=async()=>{A(!0);try{const F=await fetch(`${Ro}/tickets/${e}/attachments`,{headers:Oo()});if(F.ok){const G=await F.json();D(G)}}catch(F){console.error("Error loading attachments:",F)}finally{A(!1)}},f=async(F,G)=>{try{const K=Intl.DateTimeFormat().resolvedOptions().timeZone,ne=Oo({"x-user-timezone":K}),re=`${Ro}/attachments/${F}`;console.log("📎 Downloading:",G);const oe=await fetch(re,{headers:ne});if(!oe.ok)throw new Error(`Download failed with status ${oe.status}`);const T=await oe.blob(),v=window.URL.createObjectURL(T),E=document.createElement("a");E.href=v,E.download=G,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(v)}catch(K){console.error("Download error:",K),g("Failed to download file")}},w=["image/jpeg","image/jpg","image/png","image/gif","image/webp","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain"],C=10*1024*1024,y=F=>w.includes(F.type)?F.size>C?"File too large. Maximum size is 10MB":null:"Invalid file type. Allowed: images, PDF, Word, Excel, text files",z=async F=>{console.log("📎 AttachmentUpload: Starting upload for file:",F.name),g(null);const G=y(F);if(G){console.error("❌ File validation failed:",G),g(G);return}c(!0);try{const K=Ft.getCurrentUser();console.log("📎 User from authService:",K),console.log("📎 User ID being sent:",(K==null?void 0:K.id)||"(EMPTY)");const ne=new FormData;ne.append("file",F),d.trim()&&ne.append("description",d.trim());const re=Intl.DateTimeFormat().resolvedOptions().timeZone,oe=Oo({"x-user-timezone":re}),T=`${Ro}/tickets/${e}/attachments`;console.log("📎 Uploading to:",T);const v=await fetch(T,{method:"POST",headers:oe,body:ne});if(console.log("📎 Upload response status:",v.status),!v.ok){const W=await v.json();throw console.error("❌ Upload failed:",W),new Error(W.error||"Upload failed")}const E=await v.json();if(console.log("✅ Upload successful:",E),j(`✅ ${F.name} uploaded successfully!`),setTimeout(()=>j(null),5e3),await S(),t){const W=await fetch(`${Ro}/tickets/${e}/attachments`,{headers:Oo()});if(W.ok){const Q=(await W.json()).find(te=>te.AttachmentID===E.attachment.id);Q&&t(Q)}}p(""),O.current&&(O.current.value="")}catch(K){console.error("❌ AttachmentUpload error:",K),g(K instanceof Error?K.message:"Failed to upload file")}finally{c(!1)}},I=F=>{var K;const G=(K=F.target.files)==null?void 0:K[0];G&&z(G)},B=F=>{F.preventDefault(),s(!0)},$=F=>{F.preventDefault(),s(!1)},H=F=>{var K;F.preventDefault(),s(!1);const G=(K=F.dataTransfer.files)==null?void 0:K[0];G&&z(G)},U=()=>{var F;(F=O.current)==null||F.click()};return r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsxs("div",{onClick:U,onDragOver:B,onDragLeave:$,onDrop:H,style:{border:i?"2px dashed #007bff":"2px dashed #ccc",borderRadius:"8px",padding:"30px",textAlign:"center",cursor:a?"not-allowed":"pointer",backgroundColor:i?"#f0f8ff":"#fafafa",transition:"all 0.2s ease",opacity:a?.6:1},children:[r.jsx("input",{ref:O,type:"file",onChange:I,style:{display:"none"},disabled:a,accept:".jpg,.jpeg,.png,.gif,.webp,.pdf,.doc,.docx,.xls,.xlsx,.txt"}),a?r.jsx("div",{children:r.jsx("p",{style:{margin:"0 0 10px 0",fontSize:"16px",color:"#666"},children:"⏳ Uploading..."})}):r.jsxs("div",{children:[r.jsx("p",{style:{margin:"0 0 10px 0",fontSize:"16px",color:"#333"},children:"📎 Drop file here or click to browse"}),r.jsx("p",{style:{margin:0,fontSize:"13px",color:"#666"},children:"Allowed: Images, PDF, Word, Excel, Text (Max 10MB)"})]})]}),r.jsx("div",{style:{marginTop:"10px"},children:r.jsx("input",{type:"text",placeholder:"Optional description...",value:d,onChange:F=>p(F.target.value),disabled:a,style:{width:"100%",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})}),m&&r.jsxs("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:"4px",color:"#c00",fontSize:"14px"},children:["⚠️ ",m]}),_&&r.jsx("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#e7f7e7",border:"1px solid #c3e6c3",borderRadius:"4px",color:"#28a745",fontSize:"14px"},children:_}),k?r.jsx("div",{style:{marginTop:"20px",textAlign:"center",color:"#666"},children:"Loading attachments..."}):b.length>0?r.jsxs("div",{style:{marginTop:"20px"},children:[r.jsxs("h3",{style:{fontSize:"16px",marginBottom:"10px",color:"#333"},children:["📎 Uploaded Files (",b.length,")"]}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:b.map(F=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#f8f9fa",borderRadius:"4px",border:"1px solid #dee2e6"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{fontWeight:500,color:"#333"},children:F.OriginalFileName}),r.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:[(F.FileSize/1024).toFixed(1)," KB • ",new Date(F.UploadedAt).toLocaleDateString()]})]}),r.jsx("button",{onClick:()=>f(F.AttachmentID,F.OriginalFileName),style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},onMouseOver:G=>G.currentTarget.style.backgroundColor="#0056b3",onMouseOut:G=>G.currentTarget.style.backgroundColor="#007bff",children:"⬇ Download"})]},F.AttachmentID))})]}):r.jsx("div",{style:{marginTop:"20px",textAlign:"center",color:"#999"},children:"No files uploaded yet"})]})},Va="https://field-service-api.azurewebsites.net/api";function qa(e={}){const t={...e},i=localStorage.getItem("authToken");i&&(t.Authorization=`Bearer ${i}`);const s=localStorage.getItem("sqlUser");if(s)try{const c=JSON.parse(s);if(c.id)return t["x-user-id"]=c.id,t["x-user-name"]=c.username||c.fullName||"",t["x-user-role"]=c.role||"",c.companyCode&&(t["x-company-code"]=c.companyCode),c.companyName&&(t["x-company-name"]=c.companyName),t}catch{console.warn("AttachmentList: Failed to parse sqlUser from localStorage")}const a=Ft.getCurrentUser();return a&&(a.id&&(t["x-user-id"]=a.id),a.fullName&&(t["x-user-name"]=a.fullName),a.role&&(t["x-user-role"]=a.role)),t}const ty=({ticketId:e,refreshTrigger:t})=>{const[i,s]=P.useState([]),[a,c]=P.useState(!0),[d,p]=P.useState(null),m=async()=>{try{const k=await fetch(`${Va}/tickets/${e}/attachments`,{headers:qa()});if(!k.ok)throw new Error("Failed to fetch attachments");const A=await k.json();s(A)}catch(k){console.error("Error fetching attachments:",k),p(k instanceof Error?k.message:"Failed to load attachments")}finally{c(!1)}};P.useEffect(()=>{m()},[e,t]);const g=async(k,A)=>{try{const O=Intl.DateTimeFormat().resolvedOptions().timeZone,S=await fetch(`${Va}/attachments/${k}`,{headers:qa({"x-user-timezone":O})});if(!S.ok)throw new Error("Download failed");const f=await S.blob(),w=window.URL.createObjectURL(f),C=document.createElement("a");C.href=w,C.download=A,document.body.appendChild(C),C.click(),window.URL.revokeObjectURL(w),document.body.removeChild(C)}catch(O){console.error("Download error:",O),alert("Failed to download file")}},_=async(k,A)=>{if(confirm(`Delete ${A}?`))try{const O=Intl.DateTimeFormat().resolvedOptions().timeZone;if(!(await fetch(`${Va}/attachments/${k}`,{method:"DELETE",headers:qa({"x-user-timezone":O})})).ok)throw new Error("Delete failed");m()}catch(O){console.error("Delete error:",O),alert("Failed to delete file")}},j=k=>k<1024?`${k} B`:k<1024*1024?`${(k/1024).toFixed(1)} KB`:`${(k/(1024*1024)).toFixed(1)} MB`,b=k=>new Date(k).toLocaleString(),D=k=>k.startsWith("image/")?"🖼️":k==="application/pdf"?"📄":k.includes("word")?"📝":k.includes("excel")||k.includes("spreadsheet")?"📊":k==="text/plain"?"📃":"📎";return a?r.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Loading attachments..."}):d?r.jsxs("div",{style:{padding:"20px",color:"#c00"},children:["Error: ",d]}):i.length===0?r.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"No attachments yet"}):r.jsx("div",{children:i.map(k=>r.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"15px",marginBottom:"10px",backgroundColor:"#fff",display:"flex",alignItems:"center",gap:"15px"},children:[r.jsx("div",{style:{fontSize:"32px",flexShrink:0},children:D(k.FileType)}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontWeight:"bold",fontSize:"14px",marginBottom:"5px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:k.OriginalFileName}),r.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"3px"},children:[j(k.FileSize)," • ",b(k.UploadedAt),k.UploadedByName&&` • ${k.UploadedByName}`]}),k.Description&&r.jsx("div",{style:{fontSize:"12px",color:"#888",fontStyle:"italic"},children:k.Description})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",flexShrink:0},children:[r.jsx("button",{onClick:()=>g(k.AttachmentID,k.OriginalFileName),style:{padding:"6px 12px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"📥 Download"}),r.jsx("button",{onClick:()=>_(k.AttachmentID,k.OriginalFileName),style:{padding:"6px 12px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"🗑️ Delete"})]})]},k.AttachmentID))})};function fh(e){const t={...e};return["TicketID","Title","Status","Priority","Customer","Site","AssetIDs","LicenseIDs","Category","Description","ScheduledStart","ScheduledEnd","AssignedTo","Owner","SLA_Due","Resolution","ClosedBy","ClosedDate","GeoLocation","Tags","CreatedAt","UpdatedAt"].forEach(s=>{const a=t[s];a==null&&(t[s]="")}),t.CoordinatorNotes=e.CoordinatorNotes?[...e.CoordinatorNotes]:[],t.AuditTrail=e.AuditTrail?[...e.AuditTrail]:[],t}function ny({ticket:e,onClose:t,onSave:i,readonly:s=!1,companyName:a="Field Service"}){const[c,d]=P.useState(()=>fh(e)),[p,m]=P.useState(!1),[g,_]=P.useState(""),[j,b]=P.useState("details"),[D,k]=P.useState([]),[A,O]=P.useState([]),[S,f]=P.useState([]),[w,C]=P.useState([]),[y,z]=P.useState([]),[I,B]=P.useState(!1),[$,H]=P.useState(0);P.useEffect(()=>{d(fh(e)),U()},[e]),P.useEffect(()=>{if(c.Customer){const v=A.filter(E=>E.Customer===c.Customer).map(E=>E.Site);f(v)}else f([])},[c.Customer,A]);const U=async()=>{try{const[v,E,W]=await Promise.all([pt.getCustomers(),pt.getSites(),pt.getUsers()]),Z=(Array.isArray(v)?v:[]).map(ee=>ee.Name||ee.Customer||ee.name||ee.customer).filter(ee=>typeof ee=="string"&&ee.trim().length>0).sort((ee,ge)=>ee.localeCompare(ge)),Q=[...new Set(Z)];let te=[];try{const ee=await fetch("/data.json");if(ee.ok){const ge=await ee.json();if(Array.isArray(ge==null?void 0:ge.assets)){const Pt=ge.assets.reduce((Qt,Me)=>{const Lt=(Me==null?void 0:Me.AssetID)||(Me==null?void 0:Me.assetId)||(Me==null?void 0:Me.id);if(typeof Lt=="string"){const tt=Lt.trim();tt.length>0&&Qt.push(tt)}return Qt},[]);te=[...new Set(Pt)]}}}catch(ee){console.warn("TicketEditModal: Skipping asset preload due to error",ee)}const ae=Array.isArray(E)?E:[],q=(Array.isArray(W)?W:[]).filter(ee=>ee.isActive);k(Q),O(ae),C(te),z(q)}catch(v){console.error("Failed to load dropdown data:",v),k([]),O([]),C([]),z([])}},F=y.filter(v=>v.isActive&&(v.role==="Coordinator"||v.role==="Admin")),G=y.filter(v=>v.isActive&&v.role==="Technician"),K=(v,E,W)=>{const Z=Ft.getCurrentUser();return{id:Date.now().toString(),timestamp:new Date().toISOString(),user:(Z==null?void 0:Z.fullName)||"Unknown User",action:"Field Updated",field:v,oldValue:(E==null?void 0:E.toString())||"",newValue:(W==null?void 0:W.toString())||""}},ne=async()=>{try{if(m(!0),c.Status==="Closed"&&(!c.Resolution||c.Resolution.trim()==="")){alert("A Resolution note is required before closing a ticket. Please provide a resolution description."),m(!1);return}let v={...c};if(c.Status==="Closed"&&e.Status!=="Closed"){const Z=Ft.getCurrentUser();v.ClosedBy=(Z==null?void 0:Z.fullName)||"Unknown User",v.ClosedDate=new Date().toISOString()}const E=[];Object.keys(v).forEach(Z=>{const Q=Z;Q!=="AuditTrail"&&Q!=="UpdatedAt"&&Q!=="CoordinatorNotes"&&v[Q]!==e[Q]&&E.push(K(Q,e[Q],v[Q]))});const W={...v,UpdatedAt:new Date().toISOString(),AuditTrail:[...e.AuditTrail||[],...E]};await i(W),t()}catch(v){console.error("Failed to save ticket:",v)}finally{m(!1)}},re=(v,E=new Date)=>{const Z={Critical:4,High:8,Normal:24,Low:72}[v]||24,Q=new Date(E);return Q.setHours(Q.getHours()+Z),Q.toISOString().slice(0,16)},oe=(v,E)=>{d(W=>{const Z={...W,[v]:E};if(v==="Customer"&&E!==W.Customer&&(Z.Site=""),v==="Site"&&E){const Q=A.find(te=>te.Customer===W.Customer&&te.Site===E);Q&&(Z.GeoLocation=Q.GeoLocation||"")}if(v==="Priority"){const Q=W.ScheduledStart?new Date(W.ScheduledStart):new Date;Z.SLA_Due=re(E,Q)}return v==="ScheduledStart"&&W.Priority&&(Z.SLA_Due=re(W.Priority,new Date(E))),Z})},T=()=>{if(!g.trim())return;const v=Ft.getCurrentUser(),E={NoteID:Date.now().toString(),CoordinatorName:(v==null?void 0:v.fullName)||"Unknown User",Timestamp:new Date().toISOString(),Note:g.trim()},W=K("Note Added","",`Added by ${E.CoordinatorName}: ${E.Note.substring(0,50)}${E.Note.length>50?"...":""}`);d(Z=>({...Z,CoordinatorNotes:[...Z.CoordinatorNotes||[],E],AuditTrail:[...Z.AuditTrail||[],W]})),_("")};return r.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:[r.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"95%",maxWidth:"900px",height:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.5rem 2rem",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,color:"#1f2937",fontSize:"1.5rem"},children:s?"📋 Ticket History":"Edit Ticket"}),r.jsxs("p",{style:{margin:"0.25rem 0 0 0",color:"#4a5568",fontSize:"0.875rem"},children:["Ticket ID: ",c.TicketID]})]}),r.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#4a5568",padding:"0.25rem"},children:"×"})]}),r.jsx("div",{style:{display:"flex",borderBottom:"1px solid #e5e7eb",backgroundColor:"#f9fafb"},children:["details","notes","attachments","history"].map(v=>r.jsx("button",{onClick:()=>b(v),style:{padding:"1rem 1.5rem",border:"none",backgroundColor:j===v?"white":"transparent",color:j===v?"#3b82f6":"#4a5568",fontWeight:j===v?"500":"normal",cursor:"pointer",borderBottom:j===v?"2px solid #3b82f6":"none",textTransform:"capitalize"},children:v},v))}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"2rem"},children:[j==="details"&&r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[r.jsxs("div",{style:{gridColumn:"1 / -1"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Title *"}),r.jsx("input",{type:"text",value:c.Title??"",onChange:v=>oe("Title",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Customer *"}),r.jsxs("select",{value:c.Customer??"",onChange:v=>oe("Customer",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},children:[r.jsx("option",{value:"",children:"Select Customer"}),D.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Site *"}),r.jsxs("select",{value:c.Site??"",onChange:v=>oe("Site",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},children:[r.jsx("option",{value:"",children:"Select Site"}),S.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Category *"}),r.jsxs("select",{value:c.Category??"",onChange:v=>oe("Category",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},children:[r.jsx("option",{value:"",children:"Select Category"}),r.jsx("option",{value:"Access Control",children:"Access Control"}),r.jsx("option",{value:"Video Management",children:"Video Management"}),r.jsx("option",{value:"Intrusion Alarm",children:"Intrusion Alarm"}),r.jsx("option",{value:"Fire Safety",children:"Fire Safety"}),r.jsx("option",{value:"Network",children:"Network"}),r.jsx("option",{value:"Maintenance",children:"Maintenance"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Priority *"}),r.jsxs("select",{value:c.Priority??"",onChange:v=>oe("Priority",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},children:[r.jsx("option",{value:"Low",children:"Low"}),r.jsx("option",{value:"Normal",children:"Normal"}),r.jsx("option",{value:"High",children:"High"}),r.jsx("option",{value:"Critical",children:"Critical"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Status *"}),r.jsxs("select",{value:c.Status??"",onChange:v=>oe("Status",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},children:[r.jsx("option",{value:"New",children:"New"}),r.jsx("option",{value:"Scheduled",children:"Scheduled"}),r.jsx("option",{value:"In-Progress",children:"In Progress"}),r.jsx("option",{value:"On-Hold",children:"On Hold"}),r.jsx("option",{value:"Complete",children:"Complete"}),r.jsx("option",{value:"Closed",children:"Closed"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Owner (Coordinator) *"}),r.jsxs("select",{value:c.Owner||"",onChange:v=>oe("Owner",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},children:[r.jsx("option",{value:"",children:"Select Owner"}),F.map(v=>r.jsxs("option",{value:v.username,children:[v.fullName," (",v.role,")"]},v.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Assigned To"}),r.jsxs("select",{value:c.AssignedTo??"",onChange:v=>oe("AssignedTo",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},children:[r.jsx("option",{value:"",children:"— Select Technician —"}),G.map(v=>r.jsxs("option",{value:v.fullName,children:[v.fullName," ",v.vendor?`(${v.vendor})`:""]},v.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"License IDs"}),r.jsx("input",{type:"text",value:c.LicenseIDs??"",onChange:v=>oe("LicenseIDs",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},placeholder:"Comma-separated license IDs"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Tags"}),r.jsx("input",{type:"text",value:c.Tags??"",onChange:v=>oe("Tags",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},placeholder:"Comma-separated tags"})]}),r.jsx("div",{children:r.jsx(Za,{label:"Scheduled Start",value:c.ScheduledStart??"",onChange:v=>oe("ScheduledStart",v),placeholder:"Select start date and time",disabled:s})}),r.jsx("div",{children:r.jsx(Za,{label:"Scheduled End",value:c.ScheduledEnd??"",onChange:v=>oe("ScheduledEnd",v),placeholder:"Select end date and time",disabled:s})}),r.jsx("div",{children:r.jsx(Za,{label:"SLA Due",value:c.SLA_Due??"",onChange:v=>oe("SLA_Due",v),placeholder:"Select SLA due date and time",disabled:s})}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Geo Location"}),r.jsx("input",{type:"text",value:c.GeoLocation??"",onChange:v=>oe("GeoLocation",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"0.875rem",boxSizing:"border-box"},placeholder:"Latitude,Longitude"})]}),r.jsxs("div",{style:{gridColumn:"1 / -1"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Description *"}),r.jsx("textarea",{value:c.Description||"",onChange:v=>oe("Description",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",minHeight:"100px",fontSize:"0.875rem",boxSizing:"border-box",resize:"vertical"},placeholder:"Describe the issue or work to be performed..."})]}),r.jsxs("div",{style:{gridColumn:"1 / -1"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Resolution"}),r.jsx("textarea",{value:c.Resolution||"",onChange:v=>oe("Resolution",v.target.value),disabled:s,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",minHeight:"80px",fontSize:"0.875rem",boxSizing:"border-box",resize:"vertical"},placeholder:"Enter resolution details or work performed..."})]})]}),j==="notes"&&r.jsxs("div",{children:[!s&&r.jsxs("div",{style:{marginBottom:"2rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Add Note"}),r.jsx("textarea",{value:g,onChange:v=>_(v.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",minHeight:"80px",fontSize:"0.875rem",boxSizing:"border-box",resize:"vertical"},placeholder:"Add a note or update..."}),r.jsx("button",{onClick:T,disabled:!g.trim(),style:{marginTop:"0.5rem",padding:"0.5rem 1rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:g.trim()?"pointer":"not-allowed",opacity:g.trim()?1:.5},children:"Add Note"})]}),r.jsxs("div",{children:[r.jsx("h4",{style:{marginBottom:"1rem",color:"#374151"},children:"Notes History"}),c.CoordinatorNotes&&c.CoordinatorNotes.length>0?r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:c.CoordinatorNotes.map(v=>r.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"6px",border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[r.jsx("strong",{style:{color:"#374151"},children:v.CoordinatorName}),r.jsx("span",{style:{color:"#4a5568",fontSize:"0.875rem"},children:new Date(v.Timestamp).toLocaleString()})]}),r.jsx("p",{style:{margin:0,color:"#4b5563"},children:v.Note})]},v.NoteID))}):r.jsx("p",{style:{color:"#4a5568",fontStyle:"italic"},children:"No notes yet"})]})]}),j==="history"&&r.jsxs("div",{children:[r.jsx("h4",{style:{marginBottom:"1rem",color:"#374151"},children:"Audit Trail"}),c.AuditTrail&&c.AuditTrail.length>0?r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:c.AuditTrail.map(v=>r.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"6px",border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[r.jsx("strong",{style:{color:"#374151"},children:v.action}),r.jsx("span",{style:{color:"#4a5568",fontSize:"0.875rem"},children:new Date(v.timestamp).toLocaleString()})]}),r.jsxs("div",{style:{fontSize:"0.875rem",color:"#4b5563"},children:[r.jsxs("p",{style:{margin:"0.25rem 0"},children:["User: ",v.user]}),v.field&&r.jsxs("p",{style:{margin:"0.25rem 0"},children:["Field: ",r.jsx("strong",{children:v.field})]}),v.oldValue!==void 0&&v.newValue!==void 0&&r.jsxs("p",{style:{margin:"0.25rem 0"},children:['Changed from "',v.oldValue,'" to "',v.newValue,'"']}),v.notes&&r.jsxs("p",{style:{margin:"0.25rem 0"},children:["Notes: ",v.notes]})]})]},v.id))}):r.jsx("p",{style:{color:"#4a5568",fontStyle:"italic"},children:"No audit trail entries yet"})]}),j==="attachments"&&r.jsxs("div",{children:[r.jsx("h4",{style:{marginBottom:"1rem",color:"#374151"},children:"File Attachments"}),!s&&r.jsx("div",{style:{marginBottom:"2rem"},children:r.jsx(Rp,{ticketId:e.TicketID,onUploadComplete:()=>H(v=>v+1)})}),r.jsx(ty,{ticketId:e.TicketID,refreshTrigger:$})]})]}),r.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end",borderTop:"1px solid #e5e7eb",padding:"1.5rem 2rem"},children:[r.jsx("button",{onClick:()=>B(!0),disabled:p,style:{padding:"0.75rem 1.5rem",border:"1px solid #059669",borderRadius:"6px",backgroundColor:"white",color:"#059669",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500"},children:"🖨️ Print Ticket"}),r.jsx("button",{onClick:t,disabled:p,style:{padding:"0.75rem 1.5rem",border:"1px solid #d1d5db",borderRadius:"6px",backgroundColor:"white",color:"#374151",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500"},children:s?"Close":"Cancel"}),!s&&r.jsx("button",{onClick:ne,disabled:p,style:{padding:"0.75rem 1.5rem",border:"none",borderRadius:"6px",backgroundColor:"#3b82f6",color:"white",cursor:p?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:"500",opacity:p?.6:1},children:p?"Saving...":"Save Changes"})]})]}),I&&r.jsx(ey,{ticket:c,onClose:()=>B(!1),companyName:a})]})}function Op(e,t){const i=P.useRef(t);P.useEffect(function(){t!==i.current&&e.attributionControl!=null&&(i.current!=null&&e.attributionControl.removeAttribution(i.current),t!=null&&e.attributionControl.addAttribution(t)),i.current=t},[e,t])}const iy=1;function ry(e){return Object.freeze({__version:iy,map:e})}function oy(e,t){return Object.freeze({...e,...t})}const Mp=P.createContext(null),Bp=Mp.Provider;function Hc(){const e=P.useContext(Mp);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function sy(e){function t(i,s){const{instance:a,context:c}=e(i).current;return P.useImperativeHandle(s,()=>a),i.children==null?null:Lr.createElement(Bp,{value:c},i.children)}return P.forwardRef(t)}function ay(e){function t(i,s){const[a,c]=P.useState(!1),{instance:d}=e(i,c).current;P.useImperativeHandle(s,()=>d),P.useEffect(function(){a&&d.update()},[d,a,i.children]);const p=d._contentNode;return p?zp.createPortal(i.children,p):null}return P.forwardRef(t)}function ly(e){function t(i,s){const{instance:a}=e(i).current;return P.useImperativeHandle(s,()=>a),null}return P.forwardRef(t)}function Fp(e,t){const i=P.useRef();P.useEffect(function(){return t!=null&&e.instance.on(t),i.current=t,function(){i.current!=null&&e.instance.off(i.current),i.current=null}},[e,t])}function Zc(e,t){const i=e.pane??t.pane;return i?{...e,pane:i}:e}function cy(e,t){return function(s,a){const c=Hc(),d=e(Zc(s,c),c);return Op(c.map,s.attribution),Fp(d.current,s.eventHandlers),t(d.current,c,s,a),d}}var ql={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(i,s){s(t)})(gg,function(i){var s="1.9.4";function a(n){var o,l,u,h;for(l=1,u=arguments.length;l<u;l++){h=arguments[l];for(o in h)n[o]=h[o]}return n}var c=Object.create||function(){function n(){}return function(o){return n.prototype=o,new n}}();function d(n,o){var l=Array.prototype.slice;if(n.bind)return n.bind.apply(n,l.call(arguments,1));var u=l.call(arguments,2);return function(){return n.apply(o,u.length?u.concat(l.call(arguments)):arguments)}}var p=0;function m(n){return"_leaflet_id"in n||(n._leaflet_id=++p),n._leaflet_id}function g(n,o,l){var u,h,x,N;return N=function(){u=!1,h&&(x.apply(l,h),h=!1)},x=function(){u?h=arguments:(n.apply(l,arguments),setTimeout(N,o),u=!0)},x}function _(n,o,l){var u=o[1],h=o[0],x=u-h;return n===u&&l?n:((n-h)%x+x)%x+h}function j(){return!1}function b(n,o){if(o===!1)return n;var l=Math.pow(10,o===void 0?6:o);return Math.round(n*l)/l}function D(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function k(n){return D(n).split(/\s+/)}function A(n,o){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?c(n.options):{});for(var l in o)n.options[l]=o[l];return n.options}function O(n,o,l){var u=[];for(var h in n)u.push(encodeURIComponent(l?h.toUpperCase():h)+"="+encodeURIComponent(n[h]));return(!o||o.indexOf("?")===-1?"?":"&")+u.join("&")}var S=/\{ *([\w_ -]+) *\}/g;function f(n,o){return n.replace(S,function(l,u){var h=o[u];if(h===void 0)throw new Error("No value provided for variable "+l);return typeof h=="function"&&(h=h(o)),h})}var w=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function C(n,o){for(var l=0;l<n.length;l++)if(n[l]===o)return l;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function z(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var I=0;function B(n){var o=+new Date,l=Math.max(0,16-(o-I));return I=o+l,window.setTimeout(n,l)}var $=window.requestAnimationFrame||z("RequestAnimationFrame")||B,H=window.cancelAnimationFrame||z("CancelAnimationFrame")||z("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function U(n,o,l){if(l&&$===B)n.call(o);else return $.call(window,d(n,o))}function F(n){n&&H.call(window,n)}var G={__proto__:null,extend:a,create:c,bind:d,get lastId(){return p},stamp:m,throttle:g,wrapNum:_,falseFn:j,formatNum:b,trim:D,splitWords:k,setOptions:A,getParamString:O,template:f,isArray:w,indexOf:C,emptyImageUrl:y,requestFn:$,cancelFn:H,requestAnimFrame:U,cancelAnimFrame:F};function K(){}K.extend=function(n){var o=function(){A(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},l=o.__super__=this.prototype,u=c(l);u.constructor=o,o.prototype=u;for(var h in this)Object.prototype.hasOwnProperty.call(this,h)&&h!=="prototype"&&h!=="__super__"&&(o[h]=this[h]);return n.statics&&a(o,n.statics),n.includes&&(ne(n.includes),a.apply(null,[u].concat(n.includes))),a(u,n),delete u.statics,delete u.includes,u.options&&(u.options=l.options?c(l.options):{},a(u.options,n.options)),u._initHooks=[],u.callInitHooks=function(){if(!this._initHooksCalled){l.callInitHooks&&l.callInitHooks.call(this),this._initHooksCalled=!0;for(var x=0,N=u._initHooks.length;x<N;x++)u._initHooks[x].call(this)}},o},K.include=function(n){var o=this.prototype.options;return a(this.prototype,n),n.options&&(this.prototype.options=o,this.mergeOptions(n.options)),this},K.mergeOptions=function(n){return a(this.prototype.options,n),this},K.addInitHook=function(n){var o=Array.prototype.slice.call(arguments,1),l=typeof n=="function"?n:function(){this[n].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(l),this};function ne(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=w(n)?n:[n];for(var o=0;o<n.length;o++)n[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var re={on:function(n,o,l){if(typeof n=="object")for(var u in n)this._on(u,n[u],o);else{n=k(n);for(var h=0,x=n.length;h<x;h++)this._on(n[h],o,l)}return this},off:function(n,o,l){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var u in n)this._off(u,n[u],o);else{n=k(n);for(var h=arguments.length===1,x=0,N=n.length;x<N;x++)h?this._off(n[x]):this._off(n[x],o,l)}return this},_on:function(n,o,l,u){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(n,o,l)===!1){l===this&&(l=void 0);var h={fn:o,ctx:l};u&&(h.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(h)}},_off:function(n,o,l){var u,h,x;if(this._events&&(u=this._events[n],!!u)){if(arguments.length===1){if(this._firingCount)for(h=0,x=u.length;h<x;h++)u[h].fn=j;delete this._events[n];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var N=this._listens(n,o,l);if(N!==!1){var R=u[N];this._firingCount&&(R.fn=j,this._events[n]=u=u.slice()),u.splice(N,1)}}},fire:function(n,o,l){if(!this.listens(n,l))return this;var u=a({},o,{type:n,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var h=this._events[n];if(h){this._firingCount=this._firingCount+1||1;for(var x=0,N=h.length;x<N;x++){var R=h[x],M=R.fn;R.once&&this.off(n,M,R.ctx),M.call(R.ctx||this,u)}this._firingCount--}}return l&&this._propagateEvent(u),this},listens:function(n,o,l,u){typeof n!="string"&&console.warn('"string" type argument expected');var h=o;typeof o!="function"&&(u=!!o,h=void 0,l=void 0);var x=this._events&&this._events[n];if(x&&x.length&&this._listens(n,h,l)!==!1)return!0;if(u){for(var N in this._eventParents)if(this._eventParents[N].listens(n,o,l,u))return!0}return!1},_listens:function(n,o,l){if(!this._events)return!1;var u=this._events[n]||[];if(!o)return!!u.length;l===this&&(l=void 0);for(var h=0,x=u.length;h<x;h++)if(u[h].fn===o&&u[h].ctx===l)return h;return!1},once:function(n,o,l){if(typeof n=="object")for(var u in n)this._on(u,n[u],o,!0);else{n=k(n);for(var h=0,x=n.length;h<x;h++)this._on(n[h],o,l,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[m(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[m(n)],this},_propagateEvent:function(n){for(var o in this._eventParents)this._eventParents[o].fire(n.type,a({layer:n.target,propagatedFrom:n.target},n),!0)}};re.addEventListener=re.on,re.removeEventListener=re.clearAllEventListeners=re.off,re.addOneTimeEventListener=re.once,re.fireEvent=re.fire,re.hasEventListeners=re.listens;var oe=K.extend(re);function T(n,o,l){this.x=l?Math.round(n):n,this.y=l?Math.round(o):o}var v=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};T.prototype={clone:function(){return new T(this.x,this.y)},add:function(n){return this.clone()._add(E(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(E(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new T(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new T(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=v(this.x),this.y=v(this.y),this},distanceTo:function(n){n=E(n);var o=n.x-this.x,l=n.y-this.y;return Math.sqrt(o*o+l*l)},equals:function(n){return n=E(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=E(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function E(n,o,l){return n instanceof T?n:w(n)?new T(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new T(n.x,n.y):new T(n,o,l)}function W(n,o){if(n)for(var l=o?[n,o]:n,u=0,h=l.length;u<h;u++)this.extend(l[u])}W.prototype={extend:function(n){var o,l;if(!n)return this;if(n instanceof T||typeof n[0]=="number"||"x"in n)o=l=E(n);else if(n=Z(n),o=n.min,l=n.max,!o||!l)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=l.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(l.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(l.y,this.max.y)),this},getCenter:function(n){return E((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return E(this.min.x,this.max.y)},getTopRight:function(){return E(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var o,l;return typeof n[0]=="number"||n instanceof T?n=E(n):n=Z(n),n instanceof W?(o=n.min,l=n.max):o=l=n,o.x>=this.min.x&&l.x<=this.max.x&&o.y>=this.min.y&&l.y<=this.max.y},intersects:function(n){n=Z(n);var o=this.min,l=this.max,u=n.min,h=n.max,x=h.x>=o.x&&u.x<=l.x,N=h.y>=o.y&&u.y<=l.y;return x&&N},overlaps:function(n){n=Z(n);var o=this.min,l=this.max,u=n.min,h=n.max,x=h.x>o.x&&u.x<l.x,N=h.y>o.y&&u.y<l.y;return x&&N},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var o=this.min,l=this.max,u=Math.abs(o.x-l.x)*n,h=Math.abs(o.y-l.y)*n;return Z(E(o.x-u,o.y-h),E(l.x+u,l.y+h))},equals:function(n){return n?(n=Z(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Z(n,o){return!n||n instanceof W?n:new W(n,o)}function Q(n,o){if(n)for(var l=o?[n,o]:n,u=0,h=l.length;u<h;u++)this.extend(l[u])}Q.prototype={extend:function(n){var o=this._southWest,l=this._northEast,u,h;if(n instanceof ae)u=n,h=n;else if(n instanceof Q){if(u=n._southWest,h=n._northEast,!u||!h)return this}else return n?this.extend(q(n)||te(n)):this;return!o&&!l?(this._southWest=new ae(u.lat,u.lng),this._northEast=new ae(h.lat,h.lng)):(o.lat=Math.min(u.lat,o.lat),o.lng=Math.min(u.lng,o.lng),l.lat=Math.max(h.lat,l.lat),l.lng=Math.max(h.lng,l.lng)),this},pad:function(n){var o=this._southWest,l=this._northEast,u=Math.abs(o.lat-l.lat)*n,h=Math.abs(o.lng-l.lng)*n;return new Q(new ae(o.lat-u,o.lng-h),new ae(l.lat+u,l.lng+h))},getCenter:function(){return new ae((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ae(this.getNorth(),this.getWest())},getSouthEast:function(){return new ae(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof ae||"lat"in n?n=q(n):n=te(n);var o=this._southWest,l=this._northEast,u,h;return n instanceof Q?(u=n.getSouthWest(),h=n.getNorthEast()):u=h=n,u.lat>=o.lat&&h.lat<=l.lat&&u.lng>=o.lng&&h.lng<=l.lng},intersects:function(n){n=te(n);var o=this._southWest,l=this._northEast,u=n.getSouthWest(),h=n.getNorthEast(),x=h.lat>=o.lat&&u.lat<=l.lat,N=h.lng>=o.lng&&u.lng<=l.lng;return x&&N},overlaps:function(n){n=te(n);var o=this._southWest,l=this._northEast,u=n.getSouthWest(),h=n.getNorthEast(),x=h.lat>o.lat&&u.lat<l.lat,N=h.lng>o.lng&&u.lng<l.lng;return x&&N},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,o){return n?(n=te(n),this._southWest.equals(n.getSouthWest(),o)&&this._northEast.equals(n.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function te(n,o){return n instanceof Q?n:new Q(n,o)}function ae(n,o,l){if(isNaN(n)||isNaN(o))throw new Error("Invalid LatLng object: ("+n+", "+o+")");this.lat=+n,this.lng=+o,l!==void 0&&(this.alt=+l)}ae.prototype={equals:function(n,o){if(!n)return!1;n=q(n);var l=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return l<=(o===void 0?1e-9:o)},toString:function(n){return"LatLng("+b(this.lat,n)+", "+b(this.lng,n)+")"},distanceTo:function(n){return ge.distance(this,q(n))},wrap:function(){return ge.wrapLatLng(this)},toBounds:function(n){var o=180*n/40075017,l=o/Math.cos(Math.PI/180*this.lat);return te([this.lat-o,this.lng-l],[this.lat+o,this.lng+l])},clone:function(){return new ae(this.lat,this.lng,this.alt)}};function q(n,o,l){return n instanceof ae?n:w(n)&&typeof n[0]!="object"?n.length===3?new ae(n[0],n[1],n[2]):n.length===2?new ae(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new ae(n.lat,"lng"in n?n.lng:n.lon,n.alt):o===void 0?null:new ae(n,o,l)}var ee={latLngToPoint:function(n,o){var l=this.projection.project(n),u=this.scale(o);return this.transformation._transform(l,u)},pointToLatLng:function(n,o){var l=this.scale(o),u=this.transformation.untransform(n,l);return this.projection.unproject(u)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var o=this.projection.bounds,l=this.scale(n),u=this.transformation.transform(o.min,l),h=this.transformation.transform(o.max,l);return new W(u,h)},infinite:!1,wrapLatLng:function(n){var o=this.wrapLng?_(n.lng,this.wrapLng,!0):n.lng,l=this.wrapLat?_(n.lat,this.wrapLat,!0):n.lat,u=n.alt;return new ae(l,o,u)},wrapLatLngBounds:function(n){var o=n.getCenter(),l=this.wrapLatLng(o),u=o.lat-l.lat,h=o.lng-l.lng;if(u===0&&h===0)return n;var x=n.getSouthWest(),N=n.getNorthEast(),R=new ae(x.lat-u,x.lng-h),M=new ae(N.lat-u,N.lng-h);return new Q(R,M)}},ge=a({},ee,{wrapLng:[-180,180],R:6371e3,distance:function(n,o){var l=Math.PI/180,u=n.lat*l,h=o.lat*l,x=Math.sin((o.lat-n.lat)*l/2),N=Math.sin((o.lng-n.lng)*l/2),R=x*x+Math.cos(u)*Math.cos(h)*N*N,M=2*Math.atan2(Math.sqrt(R),Math.sqrt(1-R));return this.R*M}}),le=6378137,Pt={R:le,MAX_LATITUDE:85.0511287798,project:function(n){var o=Math.PI/180,l=this.MAX_LATITUDE,u=Math.max(Math.min(l,n.lat),-l),h=Math.sin(u*o);return new T(this.R*n.lng*o,this.R*Math.log((1+h)/(1-h))/2)},unproject:function(n){var o=180/Math.PI;return new ae((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*o,n.x*o/this.R)},bounds:function(){var n=le*Math.PI;return new W([-n,-n],[n,n])}()};function Qt(n,o,l,u){if(w(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=o,this._c=l,this._d=u}Qt.prototype={transform:function(n,o){return this._transform(n.clone(),o)},_transform:function(n,o){return o=o||1,n.x=o*(this._a*n.x+this._b),n.y=o*(this._c*n.y+this._d),n},untransform:function(n,o){return o=o||1,new T((n.x/o-this._b)/this._a,(n.y/o-this._d)/this._c)}};function Me(n,o,l,u){return new Qt(n,o,l,u)}var Lt=a({},ge,{code:"EPSG:3857",projection:Pt,transformation:function(){var n=.5/(Math.PI*Pt.R);return Me(n,.5,-n,.5)}()}),tt=a({},Lt,{code:"EPSG:900913"});function Jc(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Gc(n,o){var l="",u,h,x,N,R,M;for(u=0,x=n.length;u<x;u++){for(R=n[u],h=0,N=R.length;h<N;h++)M=R[h],l+=(h?"L":"M")+M.x+" "+M.y;l+=o?ie.svg?"z":"x":""}return l||"M0 0"}var Us=document.documentElement.style,Xr="ActiveXObject"in window,Zp=Xr&&!document.addEventListener,Kc="msLaunchUri"in navigator&&!("documentMode"in document),$s=$t("webkit"),Yc=$t("android"),Qc=$t("android 2")||$t("android 3"),Vp=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),qp=Yc&&$t("Google")&&Vp<537&&!("AudioNode"in window),Ws=!!window.opera,Xc=!Kc&&$t("chrome"),eu=$t("gecko")&&!$s&&!Ws&&!Xr,Jp=!Xc&&$t("safari"),tu=$t("phantom"),nu="OTransition"in Us,Gp=navigator.platform.indexOf("Win")===0,iu=Xr&&"transition"in Us,Hs="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Qc,ru="MozPerspective"in Us,Kp=!window.L_DISABLE_3D&&(iu||Hs||ru)&&!nu&&!tu,qi=typeof orientation<"u"||$t("mobile"),Yp=qi&&$s,Qp=qi&&Hs,ou=!window.PointerEvent&&window.MSPointerEvent,su=!!(window.PointerEvent||ou),au="ontouchstart"in window||!!window.TouchEvent,Xp=!window.L_NO_TOUCH&&(au||su),em=qi&&Ws,tm=qi&&eu,nm=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,im=function(){var n=!1;try{var o=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",j,o),window.removeEventListener("testPassiveEventSupport",j,o)}catch{}return n}(),rm=function(){return!!document.createElement("canvas").getContext}(),Zs=!!(document.createElementNS&&Jc("svg").createSVGRect),om=!!Zs&&function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),sm=!Zs&&function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var o=n.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),am=navigator.platform.indexOf("Mac")===0,lm=navigator.platform.indexOf("Linux")===0;function $t(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var ie={ie:Xr,ielt9:Zp,edge:Kc,webkit:$s,android:Yc,android23:Qc,androidStock:qp,opera:Ws,chrome:Xc,gecko:eu,safari:Jp,phantom:tu,opera12:nu,win:Gp,ie3d:iu,webkit3d:Hs,gecko3d:ru,any3d:Kp,mobile:qi,mobileWebkit:Yp,mobileWebkit3d:Qp,msPointer:ou,pointer:su,touch:Xp,touchNative:au,mobileOpera:em,mobileGecko:tm,retina:nm,passiveEvents:im,canvas:rm,svg:Zs,vml:sm,inlineSvg:om,mac:am,linux:lm},lu=ie.msPointer?"MSPointerDown":"pointerdown",cu=ie.msPointer?"MSPointerMove":"pointermove",uu=ie.msPointer?"MSPointerUp":"pointerup",du=ie.msPointer?"MSPointerCancel":"pointercancel",Vs={touchstart:lu,touchmove:cu,touchend:uu,touchcancel:du},hu={touchstart:pm,touchmove:eo,touchend:eo,touchcancel:eo},oi={},fu=!1;function cm(n,o,l){return o==="touchstart"&&fm(),hu[o]?(l=hu[o].bind(this,l),n.addEventListener(Vs[o],l,!1),l):(console.warn("wrong event specified:",o),j)}function um(n,o,l){if(!Vs[o]){console.warn("wrong event specified:",o);return}n.removeEventListener(Vs[o],l,!1)}function dm(n){oi[n.pointerId]=n}function hm(n){oi[n.pointerId]&&(oi[n.pointerId]=n)}function pu(n){delete oi[n.pointerId]}function fm(){fu||(document.addEventListener(lu,dm,!0),document.addEventListener(cu,hm,!0),document.addEventListener(uu,pu,!0),document.addEventListener(du,pu,!0),fu=!0)}function eo(n,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var l in oi)o.touches.push(oi[l]);o.changedTouches=[o],n(o)}}function pm(n,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&$e(o),eo(n,o)}function mm(n){var o={},l,u;for(u in n)l=n[u],o[u]=l&&l.bind?l.bind(n):l;return n=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var gm=200;function vm(n,o){n.addEventListener("dblclick",o);var l=0,u;function h(x){if(x.detail!==1){u=x.detail;return}if(!(x.pointerType==="mouse"||x.sourceCapabilities&&!x.sourceCapabilities.firesTouchEvents)){var N=yu(x);if(!(N.some(function(M){return M instanceof HTMLLabelElement&&M.attributes.for})&&!N.some(function(M){return M instanceof HTMLInputElement||M instanceof HTMLSelectElement}))){var R=Date.now();R-l<=gm?(u++,u===2&&o(mm(x))):u=1,l=R}}}return n.addEventListener("click",h),{dblclick:o,simDblclick:h}}function xm(n,o){n.removeEventListener("dblclick",o.dblclick),n.removeEventListener("click",o.simDblclick)}var qs=io(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ji=io(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),mu=Ji==="webkitTransition"||Ji==="OTransition"?Ji+"End":"transitionend";function gu(n){return typeof n=="string"?document.getElementById(n):n}function Gi(n,o){var l=n.style[o]||n.currentStyle&&n.currentStyle[o];if((!l||l==="auto")&&document.defaultView){var u=document.defaultView.getComputedStyle(n,null);l=u?u[o]:null}return l==="auto"?null:l}function me(n,o,l){var u=document.createElement(n);return u.className=o||"",l&&l.appendChild(u),u}function je(n){var o=n.parentNode;o&&o.removeChild(n)}function to(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function si(n){var o=n.parentNode;o&&o.lastChild!==n&&o.appendChild(n)}function ai(n){var o=n.parentNode;o&&o.firstChild!==n&&o.insertBefore(n,o.firstChild)}function Js(n,o){if(n.classList!==void 0)return n.classList.contains(o);var l=no(n);return l.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(l)}function ue(n,o){if(n.classList!==void 0)for(var l=k(o),u=0,h=l.length;u<h;u++)n.classList.add(l[u]);else if(!Js(n,o)){var x=no(n);Gs(n,(x?x+" ":"")+o)}}function Ne(n,o){n.classList!==void 0?n.classList.remove(o):Gs(n,D((" "+no(n)+" ").replace(" "+o+" "," ")))}function Gs(n,o){n.className.baseVal===void 0?n.className=o:n.className.baseVal=o}function no(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function xt(n,o){"opacity"in n.style?n.style.opacity=o:"filter"in n.style&&ym(n,o)}function ym(n,o){var l=!1,u="DXImageTransform.Microsoft.Alpha";try{l=n.filters.item(u)}catch{if(o===1)return}o=Math.round(o*100),l?(l.Enabled=o!==100,l.Opacity=o):n.style.filter+=" progid:"+u+"(opacity="+o+")"}function io(n){for(var o=document.documentElement.style,l=0;l<n.length;l++)if(n[l]in o)return n[l];return!1}function Bn(n,o,l){var u=o||new T(0,0);n.style[qs]=(ie.ie3d?"translate("+u.x+"px,"+u.y+"px)":"translate3d("+u.x+"px,"+u.y+"px,0)")+(l?" scale("+l+")":"")}function ze(n,o){n._leaflet_pos=o,ie.any3d?Bn(n,o):(n.style.left=o.x+"px",n.style.top=o.y+"px")}function Fn(n){return n._leaflet_pos||new T(0,0)}var Ki,Yi,Ks;if("onselectstart"in document)Ki=function(){ce(window,"selectstart",$e)},Yi=function(){xe(window,"selectstart",$e)};else{var Qi=io(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ki=function(){if(Qi){var n=document.documentElement.style;Ks=n[Qi],n[Qi]="none"}},Yi=function(){Qi&&(document.documentElement.style[Qi]=Ks,Ks=void 0)}}function Ys(){ce(window,"dragstart",$e)}function Qs(){xe(window,"dragstart",$e)}var ro,Xs;function ea(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(oo(),ro=n,Xs=n.style.outlineStyle,n.style.outlineStyle="none",ce(window,"keydown",oo))}function oo(){ro&&(ro.style.outlineStyle=Xs,ro=void 0,Xs=void 0,xe(window,"keydown",oo))}function vu(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function ta(n){var o=n.getBoundingClientRect();return{x:o.width/n.offsetWidth||1,y:o.height/n.offsetHeight||1,boundingClientRect:o}}var _m={__proto__:null,TRANSFORM:qs,TRANSITION:Ji,TRANSITION_END:mu,get:gu,getStyle:Gi,create:me,remove:je,empty:to,toFront:si,toBack:ai,hasClass:Js,addClass:ue,removeClass:Ne,setClass:Gs,getClass:no,setOpacity:xt,testProp:io,setTransform:Bn,setPosition:ze,getPosition:Fn,get disableTextSelection(){return Ki},get enableTextSelection(){return Yi},disableImageDrag:Ys,enableImageDrag:Qs,preventOutline:ea,restoreOutline:oo,getSizedParentNode:vu,getScale:ta};function ce(n,o,l,u){if(o&&typeof o=="object")for(var h in o)ia(n,h,o[h],l);else{o=k(o);for(var x=0,N=o.length;x<N;x++)ia(n,o[x],l,u)}return this}var Wt="_leaflet_events";function xe(n,o,l,u){if(arguments.length===1)xu(n),delete n[Wt];else if(o&&typeof o=="object")for(var h in o)ra(n,h,o[h],l);else if(o=k(o),arguments.length===2)xu(n,function(R){return C(o,R)!==-1});else for(var x=0,N=o.length;x<N;x++)ra(n,o[x],l,u);return this}function xu(n,o){for(var l in n[Wt]){var u=l.split(/\d/)[0];(!o||o(u))&&ra(n,u,null,null,l)}}var na={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ia(n,o,l,u){var h=o+m(l)+(u?"_"+m(u):"");if(n[Wt]&&n[Wt][h])return this;var x=function(R){return l.call(u||n,R||window.event)},N=x;!ie.touchNative&&ie.pointer&&o.indexOf("touch")===0?x=cm(n,o,x):ie.touch&&o==="dblclick"?x=vm(n,x):"addEventListener"in n?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?n.addEventListener(na[o]||o,x,ie.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(x=function(R){R=R||window.event,sa(n,R)&&N(R)},n.addEventListener(na[o],x,!1)):n.addEventListener(o,N,!1):n.attachEvent("on"+o,x),n[Wt]=n[Wt]||{},n[Wt][h]=x}function ra(n,o,l,u,h){h=h||o+m(l)+(u?"_"+m(u):"");var x=n[Wt]&&n[Wt][h];if(!x)return this;!ie.touchNative&&ie.pointer&&o.indexOf("touch")===0?um(n,o,x):ie.touch&&o==="dblclick"?xm(n,x):"removeEventListener"in n?n.removeEventListener(na[o]||o,x,!1):n.detachEvent("on"+o,x),n[Wt][h]=null}function Un(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function oa(n){return ia(n,"wheel",Un),this}function Xi(n){return ce(n,"mousedown touchstart dblclick contextmenu",Un),n._leaflet_disable_click=!0,this}function $e(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function $n(n){return $e(n),Un(n),this}function yu(n){if(n.composedPath)return n.composedPath();for(var o=[],l=n.target;l;)o.push(l),l=l.parentNode;return o}function _u(n,o){if(!o)return new T(n.clientX,n.clientY);var l=ta(o),u=l.boundingClientRect;return new T((n.clientX-u.left)/l.x-o.clientLeft,(n.clientY-u.top)/l.y-o.clientTop)}var Sm=ie.linux&&ie.chrome?window.devicePixelRatio:ie.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Su(n){return ie.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Sm:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function sa(n,o){var l=o.relatedTarget;if(!l)return!0;try{for(;l&&l!==n;)l=l.parentNode}catch{return!1}return l!==n}var wm={__proto__:null,on:ce,off:xe,stopPropagation:Un,disableScrollPropagation:oa,disableClickPropagation:Xi,preventDefault:$e,stop:$n,getPropagationPath:yu,getMousePosition:_u,getWheelDelta:Su,isExternalTarget:sa,addListener:ce,removeListener:xe},wu=oe.extend({run:function(n,o,l,u){this.stop(),this._el=n,this._inProgress=!0,this._duration=l||.25,this._easeOutPower=1/Math.max(u||.5,.2),this._startPos=Fn(n),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=U(this._animate,this),this._step()},_step:function(n){var o=+new Date-this._startTime,l=this._duration*1e3;o<l?this._runFrame(this._easeOut(o/l),n):(this._runFrame(1),this._complete())},_runFrame:function(n,o){var l=this._startPos.add(this._offset.multiplyBy(n));o&&l._round(),ze(this._el,l),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),fe=oe.extend({options:{crs:Lt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,o){o=A(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=d(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(q(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ji&&ie.any3d&&!ie.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ce(this._proxy,mu,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,o,l){if(o=o===void 0?this._zoom:this._limitZoom(o),n=this._limitCenter(q(n),o,this.options.maxBounds),l=l||{},this._stop(),this._loaded&&!l.reset&&l!==!0){l.animate!==void 0&&(l.zoom=a({animate:l.animate},l.zoom),l.pan=a({animate:l.animate,duration:l.duration},l.pan));var u=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,o,l.zoom):this._tryAnimatedPan(n,l.pan);if(u)return clearTimeout(this._sizeTimer),this}return this._resetView(n,o,l.pan&&l.pan.noMoveStart),this},setZoom:function(n,o){return this._loaded?this.setView(this.getCenter(),n,{zoom:o}):(this._zoom=n,this)},zoomIn:function(n,o){return n=n||(ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,o)},zoomOut:function(n,o){return n=n||(ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,o)},setZoomAround:function(n,o,l){var u=this.getZoomScale(o),h=this.getSize().divideBy(2),x=n instanceof T?n:this.latLngToContainerPoint(n),N=x.subtract(h).multiplyBy(1-1/u),R=this.containerPointToLatLng(h.add(N));return this.setView(R,o,{zoom:l})},_getBoundsCenterZoom:function(n,o){o=o||{},n=n.getBounds?n.getBounds():te(n);var l=E(o.paddingTopLeft||o.padding||[0,0]),u=E(o.paddingBottomRight||o.padding||[0,0]),h=this.getBoundsZoom(n,!1,l.add(u));if(h=typeof o.maxZoom=="number"?Math.min(o.maxZoom,h):h,h===1/0)return{center:n.getCenter(),zoom:h};var x=u.subtract(l).divideBy(2),N=this.project(n.getSouthWest(),h),R=this.project(n.getNorthEast(),h),M=this.unproject(N.add(R).divideBy(2).add(x),h);return{center:M,zoom:h}},fitBounds:function(n,o){if(n=te(n),!n.isValid())throw new Error("Bounds are not valid.");var l=this._getBoundsCenterZoom(n,o);return this.setView(l.center,l.zoom,o)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,o){return this.setView(n,this._zoom,{pan:o})},panBy:function(n,o){if(n=E(n).round(),o=o||{},!n.x&&!n.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new wu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){ue(this._mapPane,"leaflet-pan-anim");var l=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,l,o.duration||.25,o.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,o,l){if(l=l||{},l.animate===!1||!ie.any3d)return this.setView(n,o,l);this._stop();var u=this.project(this.getCenter()),h=this.project(n),x=this.getSize(),N=this._zoom;n=q(n),o=o===void 0?N:o;var R=Math.max(x.x,x.y),M=R*this.getZoomScale(N,o),V=h.distanceTo(u)||1,Y=1.42,se=Y*Y;function de(De){var xo=De?-1:1,ug=De?M:R,dg=M*M-R*R+xo*se*se*V*V,hg=2*ug*se*V,va=dg/hg,nd=Math.sqrt(va*va+1)-va,fg=nd<1e-9?-18:Math.log(nd);return fg}function Ke(De){return(Math.exp(De)-Math.exp(-De))/2}function Be(De){return(Math.exp(De)+Math.exp(-De))/2}function _t(De){return Ke(De)/Be(De)}var nt=de(0);function fi(De){return R*(Be(nt)/Be(nt+Y*De))}function sg(De){return R*(Be(nt)*_t(nt+Y*De)-Ke(nt))/se}function ag(De){return 1-Math.pow(1-De,1.5)}var lg=Date.now(),ed=(de(1)-nt)/Y,cg=l.duration?1e3*l.duration:1e3*ed*.8;function td(){var De=(Date.now()-lg)/cg,xo=ag(De)*ed;De<=1?(this._flyToFrame=U(td,this),this._move(this.unproject(u.add(h.subtract(u).multiplyBy(sg(xo)/V)),N),this.getScaleZoom(R/fi(xo),N),{flyTo:!0})):this._move(n,o)._moveEnd(!0)}return this._moveStart(!0,l.noMoveStart),td.call(this),this},flyToBounds:function(n,o){var l=this._getBoundsCenterZoom(n,o);return this.flyTo(l.center,l.zoom,o)},setMaxBounds:function(n){return n=te(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var o=this.options.minZoom;return this.options.minZoom=n,this._loaded&&o!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var o=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&o!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,o){this._enforcingBounds=!0;var l=this.getCenter(),u=this._limitCenter(l,this._zoom,te(n));return l.equals(u)||this.panTo(u,o),this._enforcingBounds=!1,this},panInside:function(n,o){o=o||{};var l=E(o.paddingTopLeft||o.padding||[0,0]),u=E(o.paddingBottomRight||o.padding||[0,0]),h=this.project(this.getCenter()),x=this.project(n),N=this.getPixelBounds(),R=Z([N.min.add(l),N.max.subtract(u)]),M=R.getSize();if(!R.contains(x)){this._enforcingBounds=!0;var V=x.subtract(R.getCenter()),Y=R.extend(x).getSize().subtract(M);h.x+=V.x<0?-Y.x:Y.x,h.y+=V.y<0?-Y.y:Y.y,this.panTo(this.unproject(h),o),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=a({animate:!1,pan:!0},n===!0?{animate:!0}:n);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var l=this.getSize(),u=o.divideBy(2).round(),h=l.divideBy(2).round(),x=u.subtract(h);return!x.x&&!x.y?this:(n.animate&&n.pan?this.panBy(x):(n.pan&&this._rawPanBy(x),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(d(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:l}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=a({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=d(this._handleGeolocationResponse,this),l=d(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,l,n):navigator.geolocation.getCurrentPosition(o,l,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var o=n.code,l=n.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+l+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var o=n.coords.latitude,l=n.coords.longitude,u=new ae(o,l),h=u.toBounds(n.coords.accuracy*2),x=this._locateOptions;if(x.setView){var N=this.getBoundsZoom(h);this.setView(u,x.maxZoom?Math.min(N,x.maxZoom):N)}var R={latlng:u,bounds:h,timestamp:n.timestamp};for(var M in n.coords)typeof n.coords[M]=="number"&&(R[M]=n.coords[M]);this.fire("locationfound",R)}},addHandler:function(n,o){if(!o)return this;var l=this[n]=new o(this);return this._handlers.push(l),this.options[n]&&l.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),je(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)je(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,o){var l="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),u=me("div",l,o||this._mapPane);return n&&(this._panes[n]=u),u},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),o=this.unproject(n.getBottomLeft()),l=this.unproject(n.getTopRight());return new Q(o,l)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,o,l){n=te(n),l=E(l||[0,0]);var u=this.getZoom()||0,h=this.getMinZoom(),x=this.getMaxZoom(),N=n.getNorthWest(),R=n.getSouthEast(),M=this.getSize().subtract(l),V=Z(this.project(R,u),this.project(N,u)).getSize(),Y=ie.any3d?this.options.zoomSnap:1,se=M.x/V.x,de=M.y/V.y,Ke=o?Math.max(se,de):Math.min(se,de);return u=this.getScaleZoom(Ke,u),Y&&(u=Math.round(u/(Y/100))*(Y/100),u=o?Math.ceil(u/Y)*Y:Math.floor(u/Y)*Y),Math.max(h,Math.min(x,u))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new T(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,o){var l=this._getTopLeftPoint(n,o);return new W(l,l.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,o){var l=this.options.crs;return o=o===void 0?this._zoom:o,l.scale(n)/l.scale(o)},getScaleZoom:function(n,o){var l=this.options.crs;o=o===void 0?this._zoom:o;var u=l.zoom(n*l.scale(o));return isNaN(u)?1/0:u},project:function(n,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(q(n),o)},unproject:function(n,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(E(n),o)},layerPointToLatLng:function(n){var o=E(n).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(n){var o=this.project(q(n))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(q(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(te(n))},distance:function(n,o){return this.options.crs.distance(q(n),q(o))},containerPointToLayerPoint:function(n){return E(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return E(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var o=this.containerPointToLayerPoint(E(n));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(q(n)))},mouseEventToContainerPoint:function(n){return _u(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var o=this._container=gu(n);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ce(o,"scroll",this._onScroll,this),this._containerId=m(o)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&ie.any3d,ue(n,"leaflet-container"+(ie.touch?" leaflet-touch":"")+(ie.retina?" leaflet-retina":"")+(ie.ielt9?" leaflet-oldie":"")+(ie.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=Gi(n,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ze(this._mapPane,new T(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ue(n.markerPane,"leaflet-zoom-hide"),ue(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,o,l){ze(this._mapPane,new T(0,0));var u=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var h=this._zoom!==o;this._moveStart(h,l)._move(n,o)._moveEnd(h),this.fire("viewreset"),u&&this.fire("load")},_moveStart:function(n,o){return n&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(n,o,l,u){o===void 0&&(o=this._zoom);var h=this._zoom!==o;return this._zoom=o,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),u?l&&l.pinch&&this.fire("zoom",l):((h||l&&l.pinch)&&this.fire("zoom",l),this.fire("move",l)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){ze(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[m(this._container)]=this;var o=n?xe:ce;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),ie.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=U(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,o){for(var l=[],u,h=o==="mouseout"||o==="mouseover",x=n.target||n.srcElement,N=!1;x;){if(u=this._targets[m(x)],u&&(o==="click"||o==="preclick")&&this._draggableMoved(u)){N=!0;break}if(u&&u.listens(o,!0)&&(h&&!sa(x,n)||(l.push(u),h))||x===this._container)break;x=x.parentNode}return!l.length&&!N&&!h&&this.listens(o,!0)&&(l=[this]),l},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var o=n.target||n.srcElement;if(!(!this._loaded||o._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(o))){var l=n.type;l==="mousedown"&&ea(o),this._fireDOMEvent(n,l)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,o,l){if(n.type==="click"){var u=a({},n);u.type="preclick",this._fireDOMEvent(u,u.type,l)}var h=this._findEventTargets(n,o);if(l){for(var x=[],N=0;N<l.length;N++)l[N].listens(o,!0)&&x.push(l[N]);h=x.concat(h)}if(h.length){o==="contextmenu"&&$e(n);var R=h[0],M={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var V=R.getLatLng&&(!R._radius||R._radius<=10);M.containerPoint=V?this.latLngToContainerPoint(R.getLatLng()):this.mouseEventToContainerPoint(n),M.layerPoint=this.containerPointToLayerPoint(M.containerPoint),M.latlng=V?R.getLatLng():this.layerPointToLatLng(M.layerPoint)}for(N=0;N<h.length;N++)if(h[N].fire(o,M,!0),M.originalEvent._stopped||h[N].options.bubblingMouseEvents===!1&&C(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,o=this._handlers.length;n<o;n++)this._handlers[n].disable()},whenReady:function(n,o){return this._loaded?n.call(o||this,{target:this}):this.on("load",n,o),this},_getMapPanePos:function(){return Fn(this._mapPane)||new T(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,o){var l=n&&o!==void 0?this._getNewPixelOrigin(n,o):this.getPixelOrigin();return l.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,o){var l=this.getSize()._divideBy(2);return this.project(n,o)._subtract(l)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,o,l){var u=this._getNewPixelOrigin(l,o);return this.project(n,o)._subtract(u)},_latLngBoundsToNewLayerBounds:function(n,o,l){var u=this._getNewPixelOrigin(l,o);return Z([this.project(n.getSouthWest(),o)._subtract(u),this.project(n.getNorthWest(),o)._subtract(u),this.project(n.getSouthEast(),o)._subtract(u),this.project(n.getNorthEast(),o)._subtract(u)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,o,l){if(!l)return n;var u=this.project(n,o),h=this.getSize().divideBy(2),x=new W(u.subtract(h),u.add(h)),N=this._getBoundsOffset(x,l,o);return Math.abs(N.x)<=1&&Math.abs(N.y)<=1?n:this.unproject(u.add(N),o)},_limitOffset:function(n,o){if(!o)return n;var l=this.getPixelBounds(),u=new W(l.min.add(n),l.max.add(n));return n.add(this._getBoundsOffset(u,o))},_getBoundsOffset:function(n,o,l){var u=Z(this.project(o.getNorthEast(),l),this.project(o.getSouthWest(),l)),h=u.min.subtract(n.min),x=u.max.subtract(n.max),N=this._rebound(h.x,-x.x),R=this._rebound(h.y,-x.y);return new T(N,R)},_rebound:function(n,o){return n+o>0?Math.round(n-o)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(o))},_limitZoom:function(n){var o=this.getMinZoom(),l=this.getMaxZoom(),u=ie.any3d?this.options.zoomSnap:1;return u&&(n=Math.round(n/u)*u),Math.max(o,Math.min(l,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ne(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,o){var l=this._getCenterOffset(n)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(l)?!1:(this.panBy(l,o),!0)},_createAnimProxy:function(){var n=this._proxy=me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(o){var l=qs,u=this._proxy.style[l];Bn(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),u===this._proxy.style[l]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){je(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),o=this.getZoom();Bn(this._proxy,this.project(n,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,o,l){if(this._animatingZoom)return!0;if(l=l||{},!this._zoomAnimated||l.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var u=this.getZoomScale(o),h=this._getCenterOffset(n)._divideBy(1-1/u);return l.animate!==!0&&!this.getSize().contains(h)?!1:(U(function(){this._moveStart(!0,l.noMoveStart||!1)._animateZoom(n,o,!0)},this),!0)},_animateZoom:function(n,o,l,u){this._mapPane&&(l&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=o,ue(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:o,noUpdate:u}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(d(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ne(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Cm(n,o){return new fe(n,o)}var Nt=K.extend({options:{position:"topright"},initialize:function(n){A(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var o=this._map;return o&&o.removeControl(this),this.options.position=n,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var o=this._container=this.onAdd(n),l=this.getPosition(),u=n._controlCorners[l];return ue(o,"leaflet-control"),l.indexOf("bottom")!==-1?u.insertBefore(o,u.firstChild):u.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(je(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),er=function(n){return new Nt(n)};fe.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},o="leaflet-",l=this._controlContainer=me("div",o+"control-container",this._container);function u(h,x){var N=o+h+" "+o+x;n[h+x]=me("div",N,l)}u("top","left"),u("top","right"),u("bottom","left"),u("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)je(this._controlCorners[n]);je(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Cu=Nt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,o,l,u){return l<u?-1:u<l?1:0}},initialize:function(n,o,l){A(this,l),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var u in n)this._addLayer(n[u],u);for(u in o)this._addLayer(o[u],u,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return Nt.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,o){return this._addLayer(n,o),this._map?this._update():this},addOverlay:function(n,o){return this._addLayer(n,o,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var o=this._getLayer(m(n));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){ue(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ue(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Ne(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ne(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",o=this._container=me("div",n),l=this.options.collapsed;o.setAttribute("aria-haspopup",!0),Xi(o),oa(o);var u=this._section=me("section",n+"-list");l&&(this._map.on("click",this.collapse,this),ce(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var h=this._layersLink=me("a",n+"-toggle",o);h.href="#",h.title="Layers",h.setAttribute("role","button"),ce(h,{keydown:function(x){x.keyCode===13&&this._expandSafely()},click:function(x){$e(x),this._expandSafely()}},this),l||this.expand(),this._baseLayersList=me("div",n+"-base",u),this._separator=me("div",n+"-separator",u),this._overlaysList=me("div",n+"-overlays",u),o.appendChild(u)},_getLayer:function(n){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&m(this._layers[o].layer)===n)return this._layers[o]},_addLayer:function(n,o,l){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:o,overlay:l}),this.options.sortLayers&&this._layers.sort(d(function(u,h){return this.options.sortFunction(u.layer,h.layer,u.name,h.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;to(this._baseLayersList),to(this._overlaysList),this._layerControlInputs=[];var n,o,l,u,h=0;for(l=0;l<this._layers.length;l++)u=this._layers[l],this._addItem(u),o=o||u.overlay,n=n||!u.overlay,h+=u.overlay?0:1;return this.options.hideSingleBase&&(n=n&&h>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=o&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var o=this._getLayer(m(n.target)),l=o.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;l&&this._map.fire(l,o)},_createRadioElement:function(n,o){var l='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(o?' checked="checked"':"")+"/>",u=document.createElement("div");return u.innerHTML=l,u.firstChild},_addItem:function(n){var o=document.createElement("label"),l=this._map.hasLayer(n.layer),u;n.overlay?(u=document.createElement("input"),u.type="checkbox",u.className="leaflet-control-layers-selector",u.defaultChecked=l):u=this._createRadioElement("leaflet-base-layers_"+m(this),l),this._layerControlInputs.push(u),u.layerId=m(n.layer),ce(u,"click",this._onInputClick,this);var h=document.createElement("span");h.innerHTML=" "+n.name;var x=document.createElement("span");o.appendChild(x),x.appendChild(u),x.appendChild(h);var N=n.overlay?this._overlaysList:this._baseLayersList;return N.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,o,l,u=[],h=[];this._handlingClick=!0;for(var x=n.length-1;x>=0;x--)o=n[x],l=this._getLayer(o.layerId).layer,o.checked?u.push(l):o.checked||h.push(l);for(x=0;x<h.length;x++)this._map.hasLayer(h[x])&&this._map.removeLayer(h[x]);for(x=0;x<u.length;x++)this._map.hasLayer(u[x])||this._map.addLayer(u[x]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,o,l,u=this._map.getZoom(),h=n.length-1;h>=0;h--)o=n[h],l=this._getLayer(o.layerId).layer,o.disabled=l.options.minZoom!==void 0&&u<l.options.minZoom||l.options.maxZoom!==void 0&&u>l.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,ce(n,"click",$e),this.expand();var o=this;setTimeout(function(){xe(n,"click",$e),o._preventClick=!1})}}),jm=function(n,o,l){return new Cu(n,o,l)},aa=Nt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var o="leaflet-control-zoom",l=me("div",o+" leaflet-bar"),u=this.options;return this._zoomInButton=this._createButton(u.zoomInText,u.zoomInTitle,o+"-in",l,this._zoomIn),this._zoomOutButton=this._createButton(u.zoomOutText,u.zoomOutTitle,o+"-out",l,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),l},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,o,l,u,h){var x=me("a",l,u);return x.innerHTML=n,x.href="#",x.title=o,x.setAttribute("role","button"),x.setAttribute("aria-label",o),Xi(x),ce(x,"click",$n),ce(x,"click",h,this),ce(x,"click",this._refocusOnMap,this),x},_updateDisabled:function(){var n=this._map,o="leaflet-disabled";Ne(this._zoomInButton,o),Ne(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ue(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ue(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});fe.mergeOptions({zoomControl:!0}),fe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new aa,this.addControl(this.zoomControl))});var bm=function(n){return new aa(n)},ju=Nt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var o="leaflet-control-scale",l=me("div",o),u=this.options;return this._addScales(u,o+"-line",l),n.on(u.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),l},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,o,l){n.metric&&(this._mScale=me("div",o,l)),n.imperial&&(this._iScale=me("div",o,l))},_update:function(){var n=this._map,o=n.getSize().y/2,l=n.distance(n.containerPointToLatLng([0,o]),n.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(l)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var o=this._getRoundNum(n),l=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,l,o/n)},_updateImperial:function(n){var o=n*3.2808399,l,u,h;o>5280?(l=o/5280,u=this._getRoundNum(l),this._updateScale(this._iScale,u+" mi",u/l)):(h=this._getRoundNum(o),this._updateScale(this._iScale,h+" ft",h/o))},_updateScale:function(n,o,l){n.style.width=Math.round(this.options.maxWidth*l)+"px",n.innerHTML=o},_getRoundNum:function(n){var o=Math.pow(10,(Math.floor(n)+"").length-1),l=n/o;return l=l>=10?10:l>=5?5:l>=3?3:l>=2?2:1,o*l}}),km=function(n){return new ju(n)},Tm='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',la=Nt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ie.inlineSvg?Tm+" ":"")+"Leaflet</a>"},initialize:function(n){A(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=me("div","leaflet-control-attribution"),Xi(this._container);for(var o in n._layers)n._layers[o].getAttribution&&this.addAttribution(n._layers[o].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var o in this._attributions)this._attributions[o]&&n.push(o);var l=[];this.options.prefix&&l.push(this.options.prefix),n.length&&l.push(n.join(", ")),this._container.innerHTML=l.join(' <span aria-hidden="true">|</span> ')}}});fe.mergeOptions({attributionControl:!0}),fe.addInitHook(function(){this.options.attributionControl&&new la().addTo(this)});var Pm=function(n){return new la(n)};Nt.Layers=Cu,Nt.Zoom=aa,Nt.Scale=ju,Nt.Attribution=la,er.layers=jm,er.zoom=bm,er.scale=km,er.attribution=Pm;var Ht=K.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ht.addTo=function(n,o){return n.addHandler(o,this),this};var Lm={Events:re},bu=ie.touch?"touchstart mousedown":"mousedown",mn=oe.extend({options:{clickTolerance:3},initialize:function(n,o,l,u){A(this,u),this._element=n,this._dragStartTarget=o||n,this._preventOutline=l},enable:function(){this._enabled||(ce(this._dragStartTarget,bu,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(mn._dragging===this&&this.finishDrag(!0),xe(this._dragStartTarget,bu,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Js(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){mn._dragging===this&&this.finishDrag();return}if(!(mn._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(mn._dragging=this,this._preventOutline&&ea(this._element),Ys(),Ki(),!this._moving)){this.fire("down");var o=n.touches?n.touches[0]:n,l=vu(this._element);this._startPoint=new T(o.clientX,o.clientY),this._startPos=Fn(this._element),this._parentScale=ta(l);var u=n.type==="mousedown";ce(document,u?"mousemove":"touchmove",this._onMove,this),ce(document,u?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var o=n.touches&&n.touches.length===1?n.touches[0]:n,l=new T(o.clientX,o.clientY)._subtract(this._startPoint);!l.x&&!l.y||Math.abs(l.x)+Math.abs(l.y)<this.options.clickTolerance||(l.x/=this._parentScale.x,l.y/=this._parentScale.y,$e(n),this._moved||(this.fire("dragstart"),this._moved=!0,ue(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ue(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(l),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),ze(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Ne(document.body,"leaflet-dragging"),this._lastTarget&&(Ne(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),xe(document,"mousemove touchmove",this._onMove,this),xe(document,"mouseup touchend touchcancel",this._onUp,this),Qs(),Yi();var o=this._moved&&this._moving;this._moving=!1,mn._dragging=!1,o&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function ku(n,o,l){var u,h=[1,4,2,8],x,N,R,M,V,Y,se,de;for(x=0,Y=n.length;x<Y;x++)n[x]._code=Wn(n[x],o);for(R=0;R<4;R++){for(se=h[R],u=[],x=0,Y=n.length,N=Y-1;x<Y;N=x++)M=n[x],V=n[N],M._code&se?V._code&se||(de=so(V,M,se,o,l),de._code=Wn(de,o),u.push(de)):(V._code&se&&(de=so(V,M,se,o,l),de._code=Wn(de,o),u.push(de)),u.push(M));n=u}return n}function Tu(n,o){var l,u,h,x,N,R,M,V,Y;if(!n||n.length===0)throw new Error("latlngs not passed");yt(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var se=q([0,0]),de=te(n),Ke=de.getNorthWest().distanceTo(de.getSouthWest())*de.getNorthEast().distanceTo(de.getNorthWest());Ke<1700&&(se=ca(n));var Be=n.length,_t=[];for(l=0;l<Be;l++){var nt=q(n[l]);_t.push(o.project(q([nt.lat-se.lat,nt.lng-se.lng])))}for(R=M=V=0,l=0,u=Be-1;l<Be;u=l++)h=_t[l],x=_t[u],N=h.y*x.x-x.y*h.x,M+=(h.x+x.x)*N,V+=(h.y+x.y)*N,R+=N*3;R===0?Y=_t[0]:Y=[M/R,V/R];var fi=o.unproject(E(Y));return q([fi.lat+se.lat,fi.lng+se.lng])}function ca(n){for(var o=0,l=0,u=0,h=0;h<n.length;h++){var x=q(n[h]);o+=x.lat,l+=x.lng,u++}return q([o/u,l/u])}var Nm={__proto__:null,clipPolygon:ku,polygonCenter:Tu,centroid:ca};function Pu(n,o){if(!o||!n.length)return n.slice();var l=o*o;return n=zm(n,l),n=Em(n,l),n}function Lu(n,o,l){return Math.sqrt(tr(n,o,l,!0))}function Am(n,o,l){return tr(n,o,l)}function Em(n,o){var l=n.length,u=typeof Uint8Array<"u"?Uint8Array:Array,h=new u(l);h[0]=h[l-1]=1,ua(n,h,o,0,l-1);var x,N=[];for(x=0;x<l;x++)h[x]&&N.push(n[x]);return N}function ua(n,o,l,u,h){var x=0,N,R,M;for(R=u+1;R<=h-1;R++)M=tr(n[R],n[u],n[h],!0),M>x&&(N=R,x=M);x>l&&(o[N]=1,ua(n,o,l,u,N),ua(n,o,l,N,h))}function zm(n,o){for(var l=[n[0]],u=1,h=0,x=n.length;u<x;u++)Dm(n[u],n[h])>o&&(l.push(n[u]),h=u);return h<x-1&&l.push(n[x-1]),l}var Nu;function Au(n,o,l,u,h){var x=u?Nu:Wn(n,l),N=Wn(o,l),R,M,V;for(Nu=N;;){if(!(x|N))return[n,o];if(x&N)return!1;R=x||N,M=so(n,o,R,l,h),V=Wn(M,l),R===x?(n=M,x=V):(o=M,N=V)}}function so(n,o,l,u,h){var x=o.x-n.x,N=o.y-n.y,R=u.min,M=u.max,V,Y;return l&8?(V=n.x+x*(M.y-n.y)/N,Y=M.y):l&4?(V=n.x+x*(R.y-n.y)/N,Y=R.y):l&2?(V=M.x,Y=n.y+N*(M.x-n.x)/x):l&1&&(V=R.x,Y=n.y+N*(R.x-n.x)/x),new T(V,Y,h)}function Wn(n,o){var l=0;return n.x<o.min.x?l|=1:n.x>o.max.x&&(l|=2),n.y<o.min.y?l|=4:n.y>o.max.y&&(l|=8),l}function Dm(n,o){var l=o.x-n.x,u=o.y-n.y;return l*l+u*u}function tr(n,o,l,u){var h=o.x,x=o.y,N=l.x-h,R=l.y-x,M=N*N+R*R,V;return M>0&&(V=((n.x-h)*N+(n.y-x)*R)/M,V>1?(h=l.x,x=l.y):V>0&&(h+=N*V,x+=R*V)),N=n.x-h,R=n.y-x,u?N*N+R*R:new T(h,x)}function yt(n){return!w(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Eu(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),yt(n)}function zu(n,o){var l,u,h,x,N,R,M,V;if(!n||n.length===0)throw new Error("latlngs not passed");yt(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Y=q([0,0]),se=te(n),de=se.getNorthWest().distanceTo(se.getSouthWest())*se.getNorthEast().distanceTo(se.getNorthWest());de<1700&&(Y=ca(n));var Ke=n.length,Be=[];for(l=0;l<Ke;l++){var _t=q(n[l]);Be.push(o.project(q([_t.lat-Y.lat,_t.lng-Y.lng])))}for(l=0,u=0;l<Ke-1;l++)u+=Be[l].distanceTo(Be[l+1])/2;if(u===0)V=Be[0];else for(l=0,x=0;l<Ke-1;l++)if(N=Be[l],R=Be[l+1],h=N.distanceTo(R),x+=h,x>u){M=(x-u)/h,V=[R.x-M*(R.x-N.x),R.y-M*(R.y-N.y)];break}var nt=o.unproject(E(V));return q([nt.lat+Y.lat,nt.lng+Y.lng])}var Im={__proto__:null,simplify:Pu,pointToSegmentDistance:Lu,closestPointOnSegment:Am,clipSegment:Au,_getEdgeIntersection:so,_getBitCode:Wn,_sqClosestPointOnSegment:tr,isFlat:yt,_flat:Eu,polylineCenter:zu},da={project:function(n){return new T(n.lng,n.lat)},unproject:function(n){return new ae(n.y,n.x)},bounds:new W([-180,-90],[180,90])},ha={R:6378137,R_MINOR:6356752314245179e-9,bounds:new W([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var o=Math.PI/180,l=this.R,u=n.lat*o,h=this.R_MINOR/l,x=Math.sqrt(1-h*h),N=x*Math.sin(u),R=Math.tan(Math.PI/4-u/2)/Math.pow((1-N)/(1+N),x/2);return u=-l*Math.log(Math.max(R,1e-10)),new T(n.lng*o*l,u)},unproject:function(n){for(var o=180/Math.PI,l=this.R,u=this.R_MINOR/l,h=Math.sqrt(1-u*u),x=Math.exp(-n.y/l),N=Math.PI/2-2*Math.atan(x),R=0,M=.1,V;R<15&&Math.abs(M)>1e-7;R++)V=h*Math.sin(N),V=Math.pow((1-V)/(1+V),h/2),M=Math.PI/2-2*Math.atan(x*V)-N,N+=M;return new ae(N*o,n.x*o/l)}},Rm={__proto__:null,LonLat:da,Mercator:ha,SphericalMercator:Pt},Om=a({},ge,{code:"EPSG:3395",projection:ha,transformation:function(){var n=.5/(Math.PI*ha.R);return Me(n,.5,-n,.5)}()}),Du=a({},ge,{code:"EPSG:4326",projection:da,transformation:Me(1/180,1,-1/180,.5)}),Mm=a({},ee,{projection:da,transformation:Me(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,o){var l=o.lng-n.lng,u=o.lat-n.lat;return Math.sqrt(l*l+u*u)},infinite:!0});ee.Earth=ge,ee.EPSG3395=Om,ee.EPSG3857=Lt,ee.EPSG900913=tt,ee.EPSG4326=Du,ee.Simple=Mm;var At=oe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[m(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[m(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var o=n.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var l=this.getEvents();o.on(l,this),this.once("remove",function(){o.off(l,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});fe.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var o=m(n);return this._layers[o]?this:(this._layers[o]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var o=m(n);return this._layers[o]?(this._loaded&&n.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return m(n)in this._layers},eachLayer:function(n,o){for(var l in this._layers)n.call(o,this._layers[l]);return this},_addLayers:function(n){n=n?w(n)?n:[n]:[];for(var o=0,l=n.length;o<l;o++)this.addLayer(n[o])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[m(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var o=m(n);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,o=-1/0,l=this._getZoomSpan();for(var u in this._zoomBoundLayers){var h=this._zoomBoundLayers[u].options;n=h.minZoom===void 0?n:Math.min(n,h.minZoom),o=h.maxZoom===void 0?o:Math.max(o,h.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=n===1/0?void 0:n,l!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var li=At.extend({initialize:function(n,o){A(this,o),this._layers={};var l,u;if(n)for(l=0,u=n.length;l<u;l++)this.addLayer(n[l])},addLayer:function(n){var o=this.getLayerId(n);return this._layers[o]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var o=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(n){var o=typeof n=="number"?n:this.getLayerId(n);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var o=Array.prototype.slice.call(arguments,1),l,u;for(l in this._layers)u=this._layers[l],u[n]&&u[n].apply(u,o);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,o){for(var l in this._layers)n.call(o,this._layers[l]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return m(n)}}),Bm=function(n,o){return new li(n,o)},Xt=li.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),li.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),li.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new Q;for(var o in this._layers){var l=this._layers[o];n.extend(l.getBounds?l.getBounds():l.getLatLng())}return n}}),Fm=function(n,o){return new Xt(n,o)},ci=K.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){A(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,o){var l=this._getIconUrl(n);if(!l){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var u=this._createImg(l,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(u,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),u},_setIconStyles:function(n,o){var l=this.options,u=l[o+"Size"];typeof u=="number"&&(u=[u,u]);var h=E(u),x=E(o==="shadow"&&l.shadowAnchor||l.iconAnchor||h&&h.divideBy(2,!0));n.className="leaflet-marker-"+o+" "+(l.className||""),x&&(n.style.marginLeft=-x.x+"px",n.style.marginTop=-x.y+"px"),h&&(n.style.width=h.x+"px",n.style.height=h.y+"px")},_createImg:function(n,o){return o=o||document.createElement("img"),o.src=n,o},_getIconUrl:function(n){return ie.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Um(n){return new ci(n)}var nr=ci.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof nr.imagePath!="string"&&(nr.imagePath=this._detectIconPath()),(this.options.imagePath||nr.imagePath)+ci.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var o=function(l,u,h){var x=u.exec(l);return x&&x[h]};return n=o(n,/^url\((['"])?(.+)\1\)$/,2),n&&o(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=me("div","leaflet-default-icon-path",document.body),o=Gi(n,"background-image")||Gi(n,"backgroundImage");if(document.body.removeChild(n),o=this._stripUrl(o),o)return o;var l=document.querySelector('link[href$="leaflet.css"]');return l?l.href.substring(0,l.href.length-11-1):""}}),Iu=Ht.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new mn(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ue(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ne(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var o=this._marker,l=o._map,u=this._marker.options.autoPanSpeed,h=this._marker.options.autoPanPadding,x=Fn(o._icon),N=l.getPixelBounds(),R=l.getPixelOrigin(),M=Z(N.min._subtract(R).add(h),N.max._subtract(R).subtract(h));if(!M.contains(x)){var V=E((Math.max(M.max.x,x.x)-M.max.x)/(N.max.x-M.max.x)-(Math.min(M.min.x,x.x)-M.min.x)/(N.min.x-M.min.x),(Math.max(M.max.y,x.y)-M.max.y)/(N.max.y-M.max.y)-(Math.min(M.min.y,x.y)-M.min.y)/(N.min.y-M.min.y)).multiplyBy(u);l.panBy(V,{animate:!1}),this._draggable._newPos._add(V),this._draggable._startPos._add(V),ze(o._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=U(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=U(this._adjustPan.bind(this,n)))},_onDrag:function(n){var o=this._marker,l=o._shadow,u=Fn(o._icon),h=o._map.layerPointToLatLng(u);l&&ze(l,u),o._latlng=h,n.latlng=h,n.oldLatLng=this._oldLatLng,o.fire("move",n).fire("drag",n)},_onDragEnd:function(n){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),ao=At.extend({options:{icon:new nr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,o){A(this,o),this._latlng=q(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var o=this._latlng;return this._latlng=q(n),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),l=n.icon.createIcon(this._icon),u=!1;l!==this._icon&&(this._icon&&this._removeIcon(),u=!0,n.title&&(l.title=n.title),l.tagName==="IMG"&&(l.alt=n.alt||"")),ue(l,o),n.keyboard&&(l.tabIndex="0",l.setAttribute("role","button")),this._icon=l,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ce(l,"focus",this._panOnFocus,this);var h=n.icon.createShadow(this._shadow),x=!1;h!==this._shadow&&(this._removeShadow(),x=!0),h&&(ue(h,o),h.alt=""),this._shadow=h,n.opacity<1&&this._updateOpacity(),u&&this.getPane().appendChild(this._icon),this._initInteraction(),h&&x&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&xe(this._icon,"focus",this._panOnFocus,this),je(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&je(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&ze(this._icon,n),this._shadow&&ze(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var o=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(ue(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Iu)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Iu(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&xt(this._icon,n),this._shadow&&xt(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var o=this.options.icon.options,l=o.iconSize?E(o.iconSize):E(0,0),u=o.iconAnchor?E(o.iconAnchor):E(0,0);n.panInside(this._latlng,{paddingTopLeft:u,paddingBottomRight:l.subtract(u)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function $m(n,o){return new ao(n,o)}var gn=At.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return A(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),lo=gn.extend({options:{fill:!0,radius:10},initialize:function(n,o){A(this,o),this._latlng=q(n),this._radius=this.options.radius},setLatLng:function(n){var o=this._latlng;return this._latlng=q(n),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var o=n&&n.radius||this._radius;return gn.prototype.setStyle.call(this,n),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,o=this._radiusY||n,l=this._clickTolerance(),u=[n+l,o+l];this._pxBounds=new W(this._point.subtract(u),this._point.add(u))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Wm(n,o){return new lo(n,o)}var fa=lo.extend({initialize:function(n,o,l){if(typeof o=="number"&&(o=a({},l,{radius:o})),A(this,o),this._latlng=q(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new Q(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:gn.prototype.setStyle,_project:function(){var n=this._latlng.lng,o=this._latlng.lat,l=this._map,u=l.options.crs;if(u.distance===ge.distance){var h=Math.PI/180,x=this._mRadius/ge.R/h,N=l.project([o+x,n]),R=l.project([o-x,n]),M=N.add(R).divideBy(2),V=l.unproject(M).lat,Y=Math.acos((Math.cos(x*h)-Math.sin(o*h)*Math.sin(V*h))/(Math.cos(o*h)*Math.cos(V*h)))/h;(isNaN(Y)||Y===0)&&(Y=x/Math.cos(Math.PI/180*o)),this._point=M.subtract(l.getPixelOrigin()),this._radius=isNaN(Y)?0:M.x-l.project([V,n-Y]).x,this._radiusY=M.y-N.y}else{var se=u.unproject(u.project(this._latlng).subtract([this._mRadius,0]));this._point=l.latLngToLayerPoint(this._latlng),this._radius=this._point.x-l.latLngToLayerPoint(se).x}this._updateBounds()}});function Hm(n,o,l){return new fa(n,o,l)}var en=gn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,o){A(this,o),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var o=1/0,l=null,u=tr,h,x,N=0,R=this._parts.length;N<R;N++)for(var M=this._parts[N],V=1,Y=M.length;V<Y;V++){h=M[V-1],x=M[V];var se=u(n,h,x,!0);se<o&&(o=se,l=u(n,h,x))}return l&&(l.distance=Math.sqrt(o)),l},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,o){return o=o||this._defaultShape(),n=q(n),o.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new Q,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return yt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var o=[],l=yt(n),u=0,h=n.length;u<h;u++)l?(o[u]=q(n[u]),this._bounds.extend(o[u])):o[u]=this._convertLatLngs(n[u]);return o},_project:function(){var n=new W;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),o=new T(n,n);this._rawPxBounds&&(this._pxBounds=new W([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(n,o,l){var u=n[0]instanceof ae,h=n.length,x,N;if(u){for(N=[],x=0;x<h;x++)N[x]=this._map.latLngToLayerPoint(n[x]),l.extend(N[x]);o.push(N)}else for(x=0;x<h;x++)this._projectLatlngs(n[x],o,l)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,l,u,h,x,N,R,M;for(l=0,h=0,x=this._rings.length;l<x;l++)for(M=this._rings[l],u=0,N=M.length;u<N-1;u++)R=Au(M[u],M[u+1],n,u,!0),R&&(o[h]=o[h]||[],o[h].push(R[0]),(R[1]!==M[u+1]||u===N-2)&&(o[h].push(R[1]),h++))}},_simplifyPoints:function(){for(var n=this._parts,o=this.options.smoothFactor,l=0,u=n.length;l<u;l++)n[l]=Pu(n[l],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,o){var l,u,h,x,N,R,M=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(l=0,x=this._parts.length;l<x;l++)for(R=this._parts[l],u=0,N=R.length,h=N-1;u<N;h=u++)if(!(!o&&u===0)&&Lu(n,R[h],R[u])<=M)return!0;return!1}});function Zm(n,o){return new en(n,o)}en._flat=Eu;var ui=en.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Tu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var o=en.prototype._convertLatLngs.call(this,n),l=o.length;return l>=2&&o[0]instanceof ae&&o[0].equals(o[l-1])&&o.pop(),o},_setLatLngs:function(n){en.prototype._setLatLngs.call(this,n),yt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return yt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,o=this.options.weight,l=new T(o,o);if(n=new W(n.min.subtract(l),n.max.add(l)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var u=0,h=this._rings.length,x;u<h;u++)x=ku(this._rings[u],n,!0),x.length&&this._parts.push(x)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var o=!1,l,u,h,x,N,R,M,V;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(x=0,M=this._parts.length;x<M;x++)for(l=this._parts[x],N=0,V=l.length,R=V-1;N<V;R=N++)u=l[N],h=l[R],u.y>n.y!=h.y>n.y&&n.x<(h.x-u.x)*(n.y-u.y)/(h.y-u.y)+u.x&&(o=!o);return o||en.prototype._containsPoint.call(this,n,!0)}});function Vm(n,o){return new ui(n,o)}var tn=Xt.extend({initialize:function(n,o){A(this,o),this._layers={},n&&this.addData(n)},addData:function(n){var o=w(n)?n:n.features,l,u,h;if(o){for(l=0,u=o.length;l<u;l++)h=o[l],(h.geometries||h.geometry||h.features||h.coordinates)&&this.addData(h);return this}var x=this.options;if(x.filter&&!x.filter(n))return this;var N=co(n,x);return N?(N.feature=fo(n),N.defaultOptions=N.options,this.resetStyle(N),x.onEachFeature&&x.onEachFeature(n,N),this.addLayer(N)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=a({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(o){this._setLayerStyle(o,n)},this)},_setLayerStyle:function(n,o){n.setStyle&&(typeof o=="function"&&(o=o(n.feature)),n.setStyle(o))}});function co(n,o){var l=n.type==="Feature"?n.geometry:n,u=l?l.coordinates:null,h=[],x=o&&o.pointToLayer,N=o&&o.coordsToLatLng||pa,R,M,V,Y;if(!u&&!l)return null;switch(l.type){case"Point":return R=N(u),Ru(x,n,R,o);case"MultiPoint":for(V=0,Y=u.length;V<Y;V++)R=N(u[V]),h.push(Ru(x,n,R,o));return new Xt(h);case"LineString":case"MultiLineString":return M=uo(u,l.type==="LineString"?0:1,N),new en(M,o);case"Polygon":case"MultiPolygon":return M=uo(u,l.type==="Polygon"?1:2,N),new ui(M,o);case"GeometryCollection":for(V=0,Y=l.geometries.length;V<Y;V++){var se=co({geometry:l.geometries[V],type:"Feature",properties:n.properties},o);se&&h.push(se)}return new Xt(h);case"FeatureCollection":for(V=0,Y=l.features.length;V<Y;V++){var de=co(l.features[V],o);de&&h.push(de)}return new Xt(h);default:throw new Error("Invalid GeoJSON object.")}}function Ru(n,o,l,u){return n?n(o,l):new ao(l,u&&u.markersInheritOptions&&u)}function pa(n){return new ae(n[1],n[0],n[2])}function uo(n,o,l){for(var u=[],h=0,x=n.length,N;h<x;h++)N=o?uo(n[h],o-1,l):(l||pa)(n[h]),u.push(N);return u}function ma(n,o){return n=q(n),n.alt!==void 0?[b(n.lng,o),b(n.lat,o),b(n.alt,o)]:[b(n.lng,o),b(n.lat,o)]}function ho(n,o,l,u){for(var h=[],x=0,N=n.length;x<N;x++)h.push(o?ho(n[x],yt(n[x])?0:o-1,l,u):ma(n[x],u));return!o&&l&&h.length>0&&h.push(h[0].slice()),h}function di(n,o){return n.feature?a({},n.feature,{geometry:o}):fo(o)}function fo(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var ga={toGeoJSON:function(n){return di(this,{type:"Point",coordinates:ma(this.getLatLng(),n)})}};ao.include(ga),fa.include(ga),lo.include(ga),en.include({toGeoJSON:function(n){var o=!yt(this._latlngs),l=ho(this._latlngs,o?1:0,!1,n);return di(this,{type:(o?"Multi":"")+"LineString",coordinates:l})}}),ui.include({toGeoJSON:function(n){var o=!yt(this._latlngs),l=o&&!yt(this._latlngs[0]),u=ho(this._latlngs,l?2:o?1:0,!0,n);return o||(u=[u]),di(this,{type:(l?"Multi":"")+"Polygon",coordinates:u})}}),li.include({toMultiPoint:function(n){var o=[];return this.eachLayer(function(l){o.push(l.toGeoJSON(n).geometry.coordinates)}),di(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(n){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(n);var l=o==="GeometryCollection",u=[];return this.eachLayer(function(h){if(h.toGeoJSON){var x=h.toGeoJSON(n);if(l)u.push(x.geometry);else{var N=fo(x);N.type==="FeatureCollection"?u.push.apply(u,N.features):u.push(N)}}}),l?di(this,{geometries:u,type:"GeometryCollection"}):{type:"FeatureCollection",features:u}}});function Ou(n,o){return new tn(n,o)}var qm=Ou,po=At.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,o,l){this._url=n,this._bounds=te(o),A(this,l)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ue(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){je(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&si(this._image),this},bringToBack:function(){return this._map&&ai(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=te(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",o=this._image=n?this._url:me("img");if(ue(o,"leaflet-image-layer"),this._zoomAnimated&&ue(o,"leaflet-zoom-animated"),this.options.className&&ue(o,this.options.className),o.onselectstart=j,o.onmousemove=j,o.onload=d(this.fire,this,"load"),o.onerror=d(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(n){var o=this._map.getZoomScale(n.zoom),l=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;Bn(this._image,l,o)},_reset:function(){var n=this._image,o=new W(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),l=o.getSize();ze(n,o.min),n.style.width=l.x+"px",n.style.height=l.y+"px"},_updateOpacity:function(){xt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),Jm=function(n,o,l){return new po(n,o,l)},Mu=po.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",o=this._image=n?this._url:me("video");if(ue(o,"leaflet-image-layer"),this._zoomAnimated&&ue(o,"leaflet-zoom-animated"),this.options.className&&ue(o,this.options.className),o.onselectstart=j,o.onmousemove=j,o.onloadeddata=d(this.fire,this,"load"),n){for(var l=o.getElementsByTagName("source"),u=[],h=0;h<l.length;h++)u.push(l[h].src);this._url=l.length>0?u:[o.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var x=0;x<this._url.length;x++){var N=me("source");N.src=this._url[x],o.appendChild(N)}}});function Gm(n,o,l){return new Mu(n,o,l)}var Bu=po.extend({_initImage:function(){var n=this._image=this._url;ue(n,"leaflet-image-layer"),this._zoomAnimated&&ue(n,"leaflet-zoom-animated"),this.options.className&&ue(n,this.options.className),n.onselectstart=j,n.onmousemove=j}});function Km(n,o,l){return new Bu(n,o,l)}var Zt=At.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,o){n&&(n instanceof ae||w(n))?(this._latlng=q(n),A(this,o)):(A(this,n),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&xt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&xt(this._container,1),this.bringToFront(),this.options.interactive&&(ue(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(xt(this._container,0),this._removeTimeout=setTimeout(d(je,void 0,this._container),200)):je(this._container),this.options.interactive&&(Ne(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=q(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&si(this._container),this},bringToBack:function(){return this._map&&ai(this._container),this},_prepareOpen:function(n){var o=this._source;if(!o._map)return!1;if(o instanceof Xt){o=null;var l=this._source._layers;for(var u in l)if(l[u]._map){o=l[u];break}if(!o)return!1;this._source=o}if(!n)if(o.getCenter)n=o.getCenter();else if(o.getLatLng)n=o.getLatLng();else if(o.getBounds)n=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")n.innerHTML=o;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),o=E(this.options.offset),l=this._getAnchor();this._zoomAnimated?ze(this._container,n.add(l)):o=o.add(n).add(l);var u=this._containerBottom=-o.y,h=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=u+"px",this._container.style.left=h+"px"}},_getAnchor:function(){return[0,0]}});fe.include({_initOverlay:function(n,o,l,u){var h=o;return h instanceof n||(h=new n(u).setContent(o)),l&&h.setLatLng(l),h}}),At.include({_initOverlay:function(n,o,l,u){var h=l;return h instanceof n?(A(h,u),h._source=this):(h=o&&!u?o:new n(u,this),h.setContent(l)),h}});var mo=Zt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,Zt.prototype.openOn.call(this,n)},onAdd:function(n){Zt.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof gn||this._source.on("preclick",Un))},onRemove:function(n){Zt.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof gn||this._source.off("preclick",Un))},getEvents:function(){var n=Zt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",o=this._container=me("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),l=this._wrapper=me("div",n+"-content-wrapper",o);if(this._contentNode=me("div",n+"-content",l),Xi(o),oa(this._contentNode),ce(o,"contextmenu",Un),this._tipContainer=me("div",n+"-tip-container",o),this._tip=me("div",n+"-tip",this._tipContainer),this.options.closeButton){var u=this._closeButton=me("a",n+"-close-button",o);u.setAttribute("role","button"),u.setAttribute("aria-label","Close popup"),u.href="#close",u.innerHTML='<span aria-hidden="true">&#215;</span>',ce(u,"click",function(h){$e(h),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,o=n.style;o.width="",o.whiteSpace="nowrap";var l=n.offsetWidth;l=Math.min(l,this.options.maxWidth),l=Math.max(l,this.options.minWidth),o.width=l+1+"px",o.whiteSpace="",o.height="";var u=n.offsetHeight,h=this.options.maxHeight,x="leaflet-popup-scrolled";h&&u>h?(o.height=h+"px",ue(n,x)):Ne(n,x),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var o=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),l=this._getAnchor();ze(this._container,o.add(l))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,o=parseInt(Gi(this._container,"marginBottom"),10)||0,l=this._container.offsetHeight+o,u=this._containerWidth,h=new T(this._containerLeft,-l-this._containerBottom);h._add(Fn(this._container));var x=n.layerPointToContainerPoint(h),N=E(this.options.autoPanPadding),R=E(this.options.autoPanPaddingTopLeft||N),M=E(this.options.autoPanPaddingBottomRight||N),V=n.getSize(),Y=0,se=0;x.x+u+M.x>V.x&&(Y=x.x+u-V.x+M.x),x.x-Y-R.x<0&&(Y=x.x-R.x),x.y+l+M.y>V.y&&(se=x.y+l-V.y+M.y),x.y-se-R.y<0&&(se=x.y-R.y),(Y||se)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Y,se]))}},_getAnchor:function(){return E(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ym=function(n,o){return new mo(n,o)};fe.mergeOptions({closePopupOnClick:!0}),fe.include({openPopup:function(n,o,l){return this._initOverlay(mo,n,o,l).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),At.include({bindPopup:function(n,o){return this._popup=this._initOverlay(mo,this._popup,n,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Xt||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){$n(n);var o=n.layer||n.target;if(this._popup._source===o&&!(o instanceof gn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=o,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var go=Zt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){Zt.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){Zt.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=Zt.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",o=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=me("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+m(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var o,l,u=this._map,h=this._container,x=u.latLngToContainerPoint(u.getCenter()),N=u.layerPointToContainerPoint(n),R=this.options.direction,M=h.offsetWidth,V=h.offsetHeight,Y=E(this.options.offset),se=this._getAnchor();R==="top"?(o=M/2,l=V):R==="bottom"?(o=M/2,l=0):R==="center"?(o=M/2,l=V/2):R==="right"?(o=0,l=V/2):R==="left"?(o=M,l=V/2):N.x<x.x?(R="right",o=0,l=V/2):(R="left",o=M+(Y.x+se.x)*2,l=V/2),n=n.subtract(E(o,l,!0)).add(Y).add(se),Ne(h,"leaflet-tooltip-right"),Ne(h,"leaflet-tooltip-left"),Ne(h,"leaflet-tooltip-top"),Ne(h,"leaflet-tooltip-bottom"),ue(h,"leaflet-tooltip-"+R),ze(h,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&xt(this._container,n)},_animateZoom:function(n){var o=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(o)},_getAnchor:function(){return E(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Qm=function(n,o){return new go(n,o)};fe.include({openTooltip:function(n,o,l){return this._initOverlay(go,n,o,l).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),At.include({bindTooltip:function(n,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(go,this._tooltip,n,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var o=n?"off":"on",l={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?l.add=this._openTooltip:(l.mouseover=this._openTooltip,l.mouseout=this.closeTooltip,l.click=this._openTooltip,this._map?this._addFocusListeners():l.add=this._addFocusListeners),this._tooltip.options.sticky&&(l.mousemove=this._moveTooltip),this[o](l),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Xt||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var o=typeof n.getElement=="function"&&n.getElement();o&&(ce(o,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),ce(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var o=typeof n.getElement=="function"&&n.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var o=n.latlng,l,u;this._tooltip.options.sticky&&n.originalEvent&&(l=this._map.mouseEventToContainerPoint(n.originalEvent),u=this._map.containerPointToLayerPoint(l),o=this._map.layerPointToLatLng(u)),this._tooltip.setLatLng(o)}});var Fu=ci.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var o=n&&n.tagName==="DIV"?n:document.createElement("div"),l=this.options;if(l.html instanceof Element?(to(o),o.appendChild(l.html)):o.innerHTML=l.html!==!1?l.html:"",l.bgPos){var u=E(l.bgPos);o.style.backgroundPosition=-u.x+"px "+-u.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Xm(n){return new Fu(n)}ci.Default=nr;var ir=At.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ie.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){A(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),je(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(si(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ai(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=g(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof T?n:new T(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var o=this.getPane().children,l=-n(-1/0,1/0),u=0,h=o.length,x;u<h;u++)x=o[u].style.zIndex,o[u]!==this._container&&x&&(l=n(l,+x));isFinite(l)&&(this.options.zIndex=l+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ie.ielt9){xt(this._container,this.options.opacity);var n=+new Date,o=!1,l=!1;for(var u in this._tiles){var h=this._tiles[u];if(!(!h.current||!h.loaded)){var x=Math.min(1,(n-h.loaded)/200);xt(h.el,x),x<1?o=!0:(h.active?l=!0:this._onOpaqueTile(h),h.active=!0)}}l&&!this._noPrune&&this._pruneTiles(),o&&(F(this._fadeFrame),this._fadeFrame=U(this._updateOpacity,this))}},_onOpaqueTile:j,_initContainer:function(){this._container||(this._container=me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,o=this.options.maxZoom;if(n!==void 0){for(var l in this._levels)l=Number(l),this._levels[l].el.children.length||l===n?(this._levels[l].el.style.zIndex=o-Math.abs(n-l),this._onUpdateLevel(l)):(je(this._levels[l].el),this._removeTilesAtZoom(l),this._onRemoveLevel(l),delete this._levels[l]);var u=this._levels[n],h=this._map;return u||(u=this._levels[n]={},u.el=me("div","leaflet-tile-container leaflet-zoom-animated",this._container),u.el.style.zIndex=o,u.origin=h.project(h.unproject(h.getPixelOrigin()),n).round(),u.zoom=n,this._setZoomTransform(u,h.getCenter(),h.getZoom()),j(u.el.offsetWidth),this._onCreateLevel(u)),this._level=u,u}},_onUpdateLevel:j,_onRemoveLevel:j,_onCreateLevel:j,_pruneTiles:function(){if(this._map){var n,o,l=this._map.getZoom();if(l>this.options.maxZoom||l<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)o=this._tiles[n],o.retain=o.current;for(n in this._tiles)if(o=this._tiles[n],o.current&&!o.active){var u=o.coords;this._retainParent(u.x,u.y,u.z,u.z-5)||this._retainChildren(u.x,u.y,u.z,u.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var o in this._tiles)this._tiles[o].coords.z===n&&this._removeTile(o)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)je(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,o,l,u){var h=Math.floor(n/2),x=Math.floor(o/2),N=l-1,R=new T(+h,+x);R.z=+N;var M=this._tileCoordsToKey(R),V=this._tiles[M];return V&&V.active?(V.retain=!0,!0):(V&&V.loaded&&(V.retain=!0),N>u?this._retainParent(h,x,N,u):!1)},_retainChildren:function(n,o,l,u){for(var h=2*n;h<2*n+2;h++)for(var x=2*o;x<2*o+2;x++){var N=new T(h,x);N.z=l+1;var R=this._tileCoordsToKey(N),M=this._tiles[R];if(M&&M.active){M.retain=!0;continue}else M&&M.loaded&&(M.retain=!0);l+1<u&&this._retainChildren(h,x,l+1,u)}},_resetView:function(n){var o=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var o=this.options;return o.minNativeZoom!==void 0&&n<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<n?o.maxNativeZoom:n},_setView:function(n,o,l,u){var h=Math.round(o);this.options.maxZoom!==void 0&&h>this.options.maxZoom||this.options.minZoom!==void 0&&h<this.options.minZoom?h=void 0:h=this._clampZoom(h);var x=this.options.updateWhenZooming&&h!==this._tileZoom;(!u||x)&&(this._tileZoom=h,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),h!==void 0&&this._update(n),l||this._pruneTiles(),this._noPrune=!!l),this._setZoomTransforms(n,o)},_setZoomTransforms:function(n,o){for(var l in this._levels)this._setZoomTransform(this._levels[l],n,o)},_setZoomTransform:function(n,o,l){var u=this._map.getZoomScale(l,n.zoom),h=n.origin.multiplyBy(u).subtract(this._map._getNewPixelOrigin(o,l)).round();ie.any3d?Bn(n.el,h,u):ze(n.el,h)},_resetGrid:function(){var n=this._map,o=n.options.crs,l=this._tileSize=this.getTileSize(),u=this._tileZoom,h=this._map.getPixelWorldBounds(this._tileZoom);h&&(this._globalTileRange=this._pxBoundsToTileRange(h)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,o.wrapLng[0]],u).x/l.x),Math.ceil(n.project([0,o.wrapLng[1]],u).x/l.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([o.wrapLat[0],0],u).y/l.x),Math.ceil(n.project([o.wrapLat[1],0],u).y/l.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var o=this._map,l=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),u=o.getZoomScale(l,this._tileZoom),h=o.project(n,this._tileZoom).floor(),x=o.getSize().divideBy(u*2);return new W(h.subtract(x),h.add(x))},_update:function(n){var o=this._map;if(o){var l=this._clampZoom(o.getZoom());if(n===void 0&&(n=o.getCenter()),this._tileZoom!==void 0){var u=this._getTiledPixelBounds(n),h=this._pxBoundsToTileRange(u),x=h.getCenter(),N=[],R=this.options.keepBuffer,M=new W(h.getBottomLeft().subtract([R,-R]),h.getTopRight().add([R,-R]));if(!(isFinite(h.min.x)&&isFinite(h.min.y)&&isFinite(h.max.x)&&isFinite(h.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var V in this._tiles){var Y=this._tiles[V].coords;(Y.z!==this._tileZoom||!M.contains(new T(Y.x,Y.y)))&&(this._tiles[V].current=!1)}if(Math.abs(l-this._tileZoom)>1){this._setView(n,l);return}for(var se=h.min.y;se<=h.max.y;se++)for(var de=h.min.x;de<=h.max.x;de++){var Ke=new T(de,se);if(Ke.z=this._tileZoom,!!this._isValidTile(Ke)){var Be=this._tiles[this._tileCoordsToKey(Ke)];Be?Be.current=!0:N.push(Ke)}}if(N.sort(function(nt,fi){return nt.distanceTo(x)-fi.distanceTo(x)}),N.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var _t=document.createDocumentFragment();for(de=0;de<N.length;de++)this._addTile(N[de],_t);this._level.el.appendChild(_t)}}}},_isValidTile:function(n){var o=this._map.options.crs;if(!o.infinite){var l=this._globalTileRange;if(!o.wrapLng&&(n.x<l.min.x||n.x>l.max.x)||!o.wrapLat&&(n.y<l.min.y||n.y>l.max.y))return!1}if(!this.options.bounds)return!0;var u=this._tileCoordsToBounds(n);return te(this.options.bounds).overlaps(u)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var o=this._map,l=this.getTileSize(),u=n.scaleBy(l),h=u.add(l),x=o.unproject(u,n.z),N=o.unproject(h,n.z);return[x,N]},_tileCoordsToBounds:function(n){var o=this._tileCoordsToNwSe(n),l=new Q(o[0],o[1]);return this.options.noWrap||(l=this._map.wrapLatLngBounds(l)),l},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var o=n.split(":"),l=new T(+o[0],+o[1]);return l.z=+o[2],l},_removeTile:function(n){var o=this._tiles[n];o&&(je(o.el),delete this._tiles[n],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ue(n,"leaflet-tile");var o=this.getTileSize();n.style.width=o.x+"px",n.style.height=o.y+"px",n.onselectstart=j,n.onmousemove=j,ie.ielt9&&this.options.opacity<1&&xt(n,this.options.opacity)},_addTile:function(n,o){var l=this._getTilePos(n),u=this._tileCoordsToKey(n),h=this.createTile(this._wrapCoords(n),d(this._tileReady,this,n));this._initTile(h),this.createTile.length<2&&U(d(this._tileReady,this,n,null,h)),ze(h,l),this._tiles[u]={el:h,coords:n,current:!0},o.appendChild(h),this.fire("tileloadstart",{tile:h,coords:n})},_tileReady:function(n,o,l){o&&this.fire("tileerror",{error:o,tile:l,coords:n});var u=this._tileCoordsToKey(n);l=this._tiles[u],l&&(l.loaded=+new Date,this._map._fadeAnimated?(xt(l.el,0),F(this._fadeFrame),this._fadeFrame=U(this._updateOpacity,this)):(l.active=!0,this._pruneTiles()),o||(ue(l.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:l.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ie.ielt9||!this._map._fadeAnimated?U(this._pruneTiles,this):setTimeout(d(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var o=new T(this._wrapX?_(n.x,this._wrapX):n.x,this._wrapY?_(n.y,this._wrapY):n.y);return o.z=n.z,o},_pxBoundsToTileRange:function(n){var o=this.getTileSize();return new W(n.min.unscaleBy(o).floor(),n.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function eg(n){return new ir(n)}var hi=ir.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,o){this._url=n,o=A(this,o),o.detectRetina&&ie.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,o){return this._url===n&&o===void 0&&(o=!0),this._url=n,o||this.redraw(),this},createTile:function(n,o){var l=document.createElement("img");return ce(l,"load",d(this._tileOnLoad,this,o,l)),ce(l,"error",d(this._tileOnError,this,o,l)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(l.referrerPolicy=this.options.referrerPolicy),l.alt="",l.src=this.getTileUrl(n),l},getTileUrl:function(n){var o={r:ie.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var l=this._globalTileRange.max.y-n.y;this.options.tms&&(o.y=l),o["-y"]=l}return f(this._url,a(o,this.options))},_tileOnLoad:function(n,o){ie.ielt9?setTimeout(d(n,this,null,o),0):n(null,o)},_tileOnError:function(n,o,l){var u=this.options.errorTileUrl;u&&o.getAttribute("src")!==u&&(o.src=u),n(l,o)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,o=this.options.maxZoom,l=this.options.zoomReverse,u=this.options.zoomOffset;return l&&(n=o-n),n+u},_getSubdomain:function(n){var o=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var n,o;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(o=this._tiles[n].el,o.onload=j,o.onerror=j,!o.complete)){o.src=y;var l=this._tiles[n].coords;je(o),delete this._tiles[n],this.fire("tileabort",{tile:o,coords:l})}},_removeTile:function(n){var o=this._tiles[n];if(o)return o.el.setAttribute("src",y),ir.prototype._removeTile.call(this,n)},_tileReady:function(n,o,l){if(!(!this._map||l&&l.getAttribute("src")===y))return ir.prototype._tileReady.call(this,n,o,l)}});function Uu(n,o){return new hi(n,o)}var $u=hi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,o){this._url=n;var l=a({},this.defaultWmsParams);for(var u in o)u in this.options||(l[u]=o[u]);o=A(this,o);var h=o.detectRetina&&ie.retina?2:1,x=this.getTileSize();l.width=x.x*h,l.height=x.y*h,this.wmsParams=l},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,hi.prototype.onAdd.call(this,n)},getTileUrl:function(n){var o=this._tileCoordsToNwSe(n),l=this._crs,u=Z(l.project(o[0]),l.project(o[1])),h=u.min,x=u.max,N=(this._wmsVersion>=1.3&&this._crs===Du?[h.y,h.x,x.y,x.x]:[h.x,h.y,x.x,x.y]).join(","),R=hi.prototype.getTileUrl.call(this,n);return R+O(this.wmsParams,R,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+N},setParams:function(n,o){return a(this.wmsParams,n),o||this.redraw(),this}});function tg(n,o){return new $u(n,o)}hi.WMS=$u,Uu.wms=tg;var nn=At.extend({options:{padding:.1},initialize:function(n){A(this,n),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ue(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,o){var l=this._map.getZoomScale(o,this._zoom),u=this._map.getSize().multiplyBy(.5+this.options.padding),h=this._map.project(this._center,o),x=u.multiplyBy(-l).add(h).subtract(this._map._getNewPixelOrigin(n,o));ie.any3d?Bn(this._container,x,l):ze(this._container,x)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,o=this._map.getSize(),l=this._map.containerPointToLayerPoint(o.multiplyBy(-n)).round();this._bounds=new W(l,l.add(o.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Wu=nn.extend({options:{tolerance:0},getEvents:function(){var n=nn.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){nn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");ce(n,"mousemove",this._onMouseMove,this),ce(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ce(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,je(this._container),xe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var o in this._layers)n=this._layers[o],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nn.prototype._update.call(this);var n=this._bounds,o=this._container,l=n.getSize(),u=ie.retina?2:1;ze(o,n.min),o.width=u*l.x,o.height=u*l.y,o.style.width=l.x+"px",o.style.height=l.y+"px",ie.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){nn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[m(n)]=n;var o=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var o=n._order,l=o.next,u=o.prev;l?l.prev=u:this._drawLast=u,u?u.next=l:this._drawFirst=l,delete n._order,delete this._layers[m(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var o=n.options.dashArray.split(/[, ]+/),l=[],u,h;for(h=0;h<o.length;h++){if(u=Number(o[h]),isNaN(u))return;l.push(u)}n.options._dashArray=l}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||U(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var o=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new W,this._redrawBounds.extend(n._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(n._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var o=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,o=this._redrawBounds;if(this._ctx.save(),o){var l=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,l.x,l.y),this._ctx.clip()}this._drawing=!0;for(var u=this._drawFirst;u;u=u.next)n=u.layer,(!o||n._pxBounds&&n._pxBounds.intersects(o))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,o){if(this._drawing){var l,u,h,x,N=n._parts,R=N.length,M=this._ctx;if(R){for(M.beginPath(),l=0;l<R;l++){for(u=0,h=N[l].length;u<h;u++)x=N[l][u],M[u?"lineTo":"moveTo"](x.x,x.y);o&&M.closePath()}this._fillStroke(M,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var o=n._point,l=this._ctx,u=Math.max(Math.round(n._radius),1),h=(Math.max(Math.round(n._radiusY),1)||u)/u;h!==1&&(l.save(),l.scale(1,h)),l.beginPath(),l.arc(o.x,o.y/h,u,0,Math.PI*2,!1),h!==1&&l.restore(),this._fillStroke(l,n)}},_fillStroke:function(n,o){var l=o.options;l.fill&&(n.globalAlpha=l.fillOpacity,n.fillStyle=l.fillColor||l.color,n.fill(l.fillRule||"evenodd")),l.stroke&&l.weight!==0&&(n.setLineDash&&n.setLineDash(o.options&&o.options._dashArray||[]),n.globalAlpha=l.opacity,n.lineWidth=l.weight,n.strokeStyle=l.color,n.lineCap=l.lineCap,n.lineJoin=l.lineJoin,n.stroke())},_onClick:function(n){for(var o=this._map.mouseEventToLayerPoint(n),l,u,h=this._drawFirst;h;h=h.next)l=h.layer,l.options.interactive&&l._containsPoint(o)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(l))&&(u=l);this._fireEvent(u?[u]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,o)}},_handleMouseOut:function(n){var o=this._hoveredLayer;o&&(Ne(this._container,"leaflet-interactive"),this._fireEvent([o],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,o){if(!this._mouseHoverThrottled){for(var l,u,h=this._drawFirst;h;h=h.next)l=h.layer,l.options.interactive&&l._containsPoint(o)&&(u=l);u!==this._hoveredLayer&&(this._handleMouseOut(n),u&&(ue(this._container,"leaflet-interactive"),this._fireEvent([u],n,"mouseover"),this._hoveredLayer=u)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(d(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,o,l){this._map._fireDOMEvent(o,l||o.type,n)},_bringToFront:function(n){var o=n._order;if(o){var l=o.next,u=o.prev;if(l)l.prev=u;else return;u?u.next=l:l&&(this._drawFirst=l),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(n)}},_bringToBack:function(n){var o=n._order;if(o){var l=o.next,u=o.prev;if(u)u.next=l;else return;l?l.prev=u:u&&(this._drawLast=u),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(n)}}});function Hu(n){return ie.canvas?new Wu(n):null}var rr=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),ng={_initContainer:function(){this._container=me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(nn.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var o=n._container=rr("shape");ue(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",n._path=rr("path"),o.appendChild(n._path),this._updateStyle(n),this._layers[m(n)]=n},_addPath:function(n){var o=n._container;this._container.appendChild(o),n.options.interactive&&n.addInteractiveTarget(o)},_removePath:function(n){var o=n._container;je(o),n.removeInteractiveTarget(o),delete this._layers[m(n)]},_updateStyle:function(n){var o=n._stroke,l=n._fill,u=n.options,h=n._container;h.stroked=!!u.stroke,h.filled=!!u.fill,u.stroke?(o||(o=n._stroke=rr("stroke")),h.appendChild(o),o.weight=u.weight+"px",o.color=u.color,o.opacity=u.opacity,u.dashArray?o.dashStyle=w(u.dashArray)?u.dashArray.join(" "):u.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=u.lineCap.replace("butt","flat"),o.joinstyle=u.lineJoin):o&&(h.removeChild(o),n._stroke=null),u.fill?(l||(l=n._fill=rr("fill")),h.appendChild(l),l.color=u.fillColor||u.color,l.opacity=u.fillOpacity):l&&(h.removeChild(l),n._fill=null)},_updateCircle:function(n){var o=n._point.round(),l=Math.round(n._radius),u=Math.round(n._radiusY||l);this._setPath(n,n._empty()?"M0 0":"AL "+o.x+","+o.y+" "+l+","+u+" 0,"+65535*360)},_setPath:function(n,o){n._path.v=o},_bringToFront:function(n){si(n._container)},_bringToBack:function(n){ai(n._container)}},vo=ie.vml?rr:Jc,or=nn.extend({_initContainer:function(){this._container=vo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=vo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){je(this._container),xe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nn.prototype._update.call(this);var n=this._bounds,o=n.getSize(),l=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,l.setAttribute("width",o.x),l.setAttribute("height",o.y)),ze(l,n.min),l.setAttribute("viewBox",[n.min.x,n.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(n){var o=n._path=vo("path");n.options.className&&ue(o,n.options.className),n.options.interactive&&ue(o,"leaflet-interactive"),this._updateStyle(n),this._layers[m(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){je(n._path),n.removeInteractiveTarget(n._path),delete this._layers[m(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var o=n._path,l=n.options;o&&(l.stroke?(o.setAttribute("stroke",l.color),o.setAttribute("stroke-opacity",l.opacity),o.setAttribute("stroke-width",l.weight),o.setAttribute("stroke-linecap",l.lineCap),o.setAttribute("stroke-linejoin",l.lineJoin),l.dashArray?o.setAttribute("stroke-dasharray",l.dashArray):o.removeAttribute("stroke-dasharray"),l.dashOffset?o.setAttribute("stroke-dashoffset",l.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),l.fill?(o.setAttribute("fill",l.fillColor||l.color),o.setAttribute("fill-opacity",l.fillOpacity),o.setAttribute("fill-rule",l.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(n,o){this._setPath(n,Gc(n._parts,o))},_updateCircle:function(n){var o=n._point,l=Math.max(Math.round(n._radius),1),u=Math.max(Math.round(n._radiusY),1)||l,h="a"+l+","+u+" 0 1,0 ",x=n._empty()?"M0 0":"M"+(o.x-l)+","+o.y+h+l*2+",0 "+h+-l*2+",0 ";this._setPath(n,x)},_setPath:function(n,o){n._path.setAttribute("d",o)},_bringToFront:function(n){si(n._path)},_bringToBack:function(n){ai(n._path)}});ie.vml&&or.include(ng);function Zu(n){return ie.svg||ie.vml?new or(n):null}fe.include({getRenderer:function(n){var o=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var o=this._paneRenderers[n];return o===void 0&&(o=this._createRenderer({pane:n}),this._paneRenderers[n]=o),o},_createRenderer:function(n){return this.options.preferCanvas&&Hu(n)||Zu(n)}});var Vu=ui.extend({initialize:function(n,o){ui.prototype.initialize.call(this,this._boundsToLatLngs(n),o)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=te(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function ig(n,o){return new Vu(n,o)}or.create=vo,or.pointsToPath=Gc,tn.geometryToLayer=co,tn.coordsToLatLng=pa,tn.coordsToLatLngs=uo,tn.latLngToCoords=ma,tn.latLngsToCoords=ho,tn.getFeature=di,tn.asFeature=fo,fe.mergeOptions({boxZoom:!0});var qu=Ht.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){ce(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){xe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){je(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ki(),Ys(),this._startPoint=this._map.mouseEventToContainerPoint(n),ce(document,{contextmenu:$n,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=me("div","leaflet-zoom-box",this._container),ue(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var o=new W(this._point,this._startPoint),l=o.getSize();ze(this._box,o.min),this._box.style.width=l.x+"px",this._box.style.height=l.y+"px"},_finish:function(){this._moved&&(je(this._box),Ne(this._container,"leaflet-crosshair")),Yi(),Qs(),xe(document,{contextmenu:$n,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(d(this._resetState,this),0);var o=new Q(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});fe.addInitHook("addHandler","boxZoom",qu),fe.mergeOptions({doubleClickZoom:!0});var Ju=Ht.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var o=this._map,l=o.getZoom(),u=o.options.zoomDelta,h=n.originalEvent.shiftKey?l-u:l+u;o.options.doubleClickZoom==="center"?o.setZoom(h):o.setZoomAround(n.containerPoint,h)}});fe.addInitHook("addHandler","doubleClickZoom",Ju),fe.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Gu=Ht.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new mn(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ue(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ne(this._map._container,"leaflet-grab"),Ne(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=te(this._map.options.maxBounds);this._offsetLimit=Z(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var o=this._lastTime=+new Date,l=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(l),this._times.push(o),this._prunePositions(o)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,o){return n-(n-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;n.x<o.min.x&&(n.x=this._viscousLimit(n.x,o.min.x)),n.y<o.min.y&&(n.y=this._viscousLimit(n.y,o.min.y)),n.x>o.max.x&&(n.x=this._viscousLimit(n.x,o.max.x)),n.y>o.max.y&&(n.y=this._viscousLimit(n.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,o=Math.round(n/2),l=this._initialWorldOffset,u=this._draggable._newPos.x,h=(u-o+l)%n+o-l,x=(u+o+l)%n-o-l,N=Math.abs(h+l)<Math.abs(x+l)?h:x;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=N},_onDragEnd:function(n){var o=this._map,l=o.options,u=!l.inertia||n.noInertia||this._times.length<2;if(o.fire("dragend",n),u)o.fire("moveend");else{this._prunePositions(+new Date);var h=this._lastPos.subtract(this._positions[0]),x=(this._lastTime-this._times[0])/1e3,N=l.easeLinearity,R=h.multiplyBy(N/x),M=R.distanceTo([0,0]),V=Math.min(l.inertiaMaxSpeed,M),Y=R.multiplyBy(V/M),se=V/(l.inertiaDeceleration*N),de=Y.multiplyBy(-se/2).round();!de.x&&!de.y?o.fire("moveend"):(de=o._limitOffset(de,o.options.maxBounds),U(function(){o.panBy(de,{duration:se,easeLinearity:N,noMoveStart:!0,animate:!0})}))}}});fe.addInitHook("addHandler","dragging",Gu),fe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ku=Ht.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),ce(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),xe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,o=document.documentElement,l=n.scrollTop||o.scrollTop,u=n.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(u,l)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var o=this._panKeys={},l=this.keyCodes,u,h;for(u=0,h=l.left.length;u<h;u++)o[l.left[u]]=[-1*n,0];for(u=0,h=l.right.length;u<h;u++)o[l.right[u]]=[n,0];for(u=0,h=l.down.length;u<h;u++)o[l.down[u]]=[0,n];for(u=0,h=l.up.length;u<h;u++)o[l.up[u]]=[0,-1*n]},_setZoomDelta:function(n){var o=this._zoomKeys={},l=this.keyCodes,u,h;for(u=0,h=l.zoomIn.length;u<h;u++)o[l.zoomIn[u]]=n;for(u=0,h=l.zoomOut.length;u<h;u++)o[l.zoomOut[u]]=-n},_addHooks:function(){ce(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){xe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=n.keyCode,l=this._map,u;if(o in this._panKeys){if(!l._panAnim||!l._panAnim._inProgress)if(u=this._panKeys[o],n.shiftKey&&(u=E(u).multiplyBy(3)),l.options.maxBounds&&(u=l._limitOffset(E(u),l.options.maxBounds)),l.options.worldCopyJump){var h=l.wrapLatLng(l.unproject(l.project(l.getCenter()).add(u)));l.panTo(h)}else l.panBy(u)}else if(o in this._zoomKeys)l.setZoom(l.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&l._popup&&l._popup.options.closeOnEscapeKey)l.closePopup();else return;$n(n)}}});fe.addInitHook("addHandler","keyboard",Ku),fe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Yu=Ht.extend({addHooks:function(){ce(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){xe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var o=Su(n),l=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var u=Math.max(l-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(d(this._performZoom,this),u),$n(n)},_performZoom:function(){var n=this._map,o=n.getZoom(),l=this._map.options.zoomSnap||0;n._stop();var u=this._delta/(this._map.options.wheelPxPerZoomLevel*4),h=4*Math.log(2/(1+Math.exp(-Math.abs(u))))/Math.LN2,x=l?Math.ceil(h/l)*l:h,N=n._limitZoom(o+(this._delta>0?x:-x))-o;this._delta=0,this._startTime=null,N&&(n.options.scrollWheelZoom==="center"?n.setZoom(o+N):n.setZoomAround(this._lastMousePos,o+N))}});fe.addInitHook("addHandler","scrollWheelZoom",Yu);var rg=600;fe.mergeOptions({tapHold:ie.touchNative&&ie.safari&&ie.mobile,tapTolerance:15});var Qu=Ht.extend({addHooks:function(){ce(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){xe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var o=n.touches[0];this._startPos=this._newPos=new T(o.clientX,o.clientY),this._holdTimeout=setTimeout(d(function(){this._cancel(),this._isTapValid()&&(ce(document,"touchend",$e),ce(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),rg),ce(document,"touchend touchcancel contextmenu",this._cancel,this),ce(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){xe(document,"touchend",$e),xe(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),xe(document,"touchend touchcancel contextmenu",this._cancel,this),xe(document,"touchmove",this._onMove,this)},_onMove:function(n){var o=n.touches[0];this._newPos=new T(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,o){var l=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});l._simulated=!0,o.target.dispatchEvent(l)}});fe.addInitHook("addHandler","tapHold",Qu),fe.mergeOptions({touchZoom:ie.touch,bounceAtZoomLimits:!0});var Xu=Ht.extend({addHooks:function(){ue(this._map._container,"leaflet-touch-zoom"),ce(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ne(this._map._container,"leaflet-touch-zoom"),xe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var o=this._map;if(!(!n.touches||n.touches.length!==2||o._animatingZoom||this._zooming)){var l=o.mouseEventToContainerPoint(n.touches[0]),u=o.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(l.add(u)._divideBy(2))),this._startDist=l.distanceTo(u),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),ce(document,"touchmove",this._onTouchMove,this),ce(document,"touchend touchcancel",this._onTouchEnd,this),$e(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var o=this._map,l=o.mouseEventToContainerPoint(n.touches[0]),u=o.mouseEventToContainerPoint(n.touches[1]),h=l.distanceTo(u)/this._startDist;if(this._zoom=o.getScaleZoom(h,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&h<1||this._zoom>o.getMaxZoom()&&h>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,h===1)return}else{var x=l._add(u)._divideBy(2)._subtract(this._centerPoint);if(h===1&&x.x===0&&x.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(x),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var N=d(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=U(N,this,!0),$e(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),xe(document,"touchmove",this._onTouchMove,this),xe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});fe.addInitHook("addHandler","touchZoom",Xu),fe.BoxZoom=qu,fe.DoubleClickZoom=Ju,fe.Drag=Gu,fe.Keyboard=Ku,fe.ScrollWheelZoom=Yu,fe.TapHold=Qu,fe.TouchZoom=Xu,i.Bounds=W,i.Browser=ie,i.CRS=ee,i.Canvas=Wu,i.Circle=fa,i.CircleMarker=lo,i.Class=K,i.Control=Nt,i.DivIcon=Fu,i.DivOverlay=Zt,i.DomEvent=wm,i.DomUtil=_m,i.Draggable=mn,i.Evented=oe,i.FeatureGroup=Xt,i.GeoJSON=tn,i.GridLayer=ir,i.Handler=Ht,i.Icon=ci,i.ImageOverlay=po,i.LatLng=ae,i.LatLngBounds=Q,i.Layer=At,i.LayerGroup=li,i.LineUtil=Im,i.Map=fe,i.Marker=ao,i.Mixin=Lm,i.Path=gn,i.Point=T,i.PolyUtil=Nm,i.Polygon=ui,i.Polyline=en,i.Popup=mo,i.PosAnimation=wu,i.Projection=Rm,i.Rectangle=Vu,i.Renderer=nn,i.SVG=or,i.SVGOverlay=Bu,i.TileLayer=hi,i.Tooltip=go,i.Transformation=Qt,i.Util=G,i.VideoOverlay=Mu,i.bind=d,i.bounds=Z,i.canvas=Hu,i.circle=Hm,i.circleMarker=Wm,i.control=er,i.divIcon=Xm,i.extend=a,i.featureGroup=Fm,i.geoJSON=Ou,i.geoJson=qm,i.gridLayer=eg,i.icon=Um,i.imageOverlay=Jm,i.latLng=q,i.latLngBounds=te,i.layerGroup=Bm,i.map=Cm,i.marker=$m,i.point=E,i.polygon=Vm,i.polyline=Zm,i.popup=Ym,i.rectangle=ig,i.setOptions=A,i.stamp=m,i.svg=Zu,i.svgOverlay=Km,i.tileLayer=Uu,i.tooltip=Qm,i.transformation=Me,i.version=s,i.videoOverlay=Gm;var og=window.L;i.noConflict=function(){return window.L=og,this},window.L=i})})(ql,ql.exports);var Qr=ql.exports;const Li=yh(Qr);function Vc(e,t,i){return Object.freeze({instance:e,context:t,container:i})}function qc(e,t){return t==null?function(s,a){const c=P.useRef();return c.current||(c.current=e(s,a)),c}:function(s,a){const c=P.useRef();c.current||(c.current=e(s,a));const d=P.useRef(s),{instance:p}=c.current;return P.useEffect(function(){d.current!==s&&(t(p,s,d.current),d.current=s)},[p,s,a]),c}}function uy(e,t){P.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var c;(c=t.layerContainer)==null||c.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Up(e){return function(i){const s=Hc(),a=e(Zc(i,s),s);return Op(s.map,i.attribution),Fp(a.current,i.eventHandlers),uy(a.current,s),a}}function dy(e,t){const i=qc(e,t),s=Up(i);return sy(s)}function hy(e,t){const i=qc(e),s=cy(i,t);return ay(s)}function fy(e,t){const i=qc(e,t),s=Up(i);return ly(s)}function py(e,t,i){const{opacity:s,zIndex:a}=t;s!=null&&s!==i.opacity&&e.setOpacity(s),a!=null&&a!==i.zIndex&&e.setZIndex(a)}function my(){return Hc().map}function Jl(){return Jl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Jl.apply(this,arguments)}function gy({bounds:e,boundsOptions:t,center:i,children:s,className:a,id:c,placeholder:d,style:p,whenReady:m,zoom:g,..._},j){const[b]=P.useState({className:a,id:c,style:p}),[D,k]=P.useState(null);P.useImperativeHandle(j,()=>(D==null?void 0:D.map)??null,[D]);const A=P.useCallback(S=>{if(S!==null&&D===null){const f=new Qr.Map(S,_);i!=null&&g!=null?f.setView(i,g):e!=null&&f.fitBounds(e,t),m!=null&&f.whenReady(m),k(ry(f))}},[]);P.useEffect(()=>()=>{D==null||D.map.remove()},[D]);const O=D?Lr.createElement(Bp,{value:D},s):d??null;return Lr.createElement("div",Jl({},b,{ref:A}),O)}const vy=P.forwardRef(gy),xy=dy(function({position:t,...i},s){const a=new Qr.Marker(t,i);return Vc(a,oy(s,{overlayContainer:a}))},function(t,i,s){i.position!==s.position&&t.setLatLng(i.position),i.icon!=null&&i.icon!==s.icon&&t.setIcon(i.icon),i.zIndexOffset!=null&&i.zIndexOffset!==s.zIndexOffset&&t.setZIndexOffset(i.zIndexOffset),i.opacity!=null&&i.opacity!==s.opacity&&t.setOpacity(i.opacity),t.dragging!=null&&i.draggable!==s.draggable&&(i.draggable===!0?t.dragging.enable():t.dragging.disable())}),yy=hy(function(t,i){const s=new Qr.Popup(t,i.overlayContainer);return Vc(s,i)},function(t,i,{position:s},a){P.useEffect(function(){const{instance:d}=t;function p(g){g.popup===d&&(d.update(),a(!0))}function m(g){g.popup===d&&a(!1)}return i.map.on({popupopen:p,popupclose:m}),i.overlayContainer==null?(s!=null&&d.setLatLng(s),d.openOn(i.map)):i.overlayContainer.bindPopup(d),function(){var _;i.map.off({popupopen:p,popupclose:m}),(_=i.overlayContainer)==null||_.unbindPopup(),i.map.removeLayer(d)}},[t,i,a,s])}),_y=fy(function({url:t,...i},s){const a=new Qr.TileLayer(t,Zc(i,s));return Vc(a,s)},function(t,i,s){py(t,i,s);const{url:a}=i;a!=null&&a!==s.url&&t.setUrl(a)});async function $p(){return console.log("api-sql.listTickets: Using SqlApiService"),await pt.getTickets()}async function Sy(e,t){return console.log("api-sql.createTicket: Creating ticket with data:",e),await pt.createTicket(e,t)}async function Mo(e,t,i){return console.log("api-sql.updateTicket: Updating ticket",e,"with:",t),await pt.updateTicket(e,t,i)}async function Gl(){return console.log("api-sql.listSites: Using SqlApiService"),await pt.getSites()}async function wy(){return console.log("api-sql.fixTicketGeolocations: SQL data should already have proper geolocations"),0}const Cy=(e,t)=>{const s={Critical:"#ff4444",High:"#ff8800",Normal:"#3388ff",Low:"#88cc88"}[t]||"#3388ff",a=Math.min(30+e*3,50);return Li.divIcon({html:`
      <div style="
        background-color: ${s};
        width: ${a}px;
        height: ${a}px;
        border-radius: 50%;
        border: 3px solid white;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: ${Math.max(12,Math.min(16,10+e))}px;
        ${t==="Critical"?"animation: pulse 2s infinite;":""}
      ">
        ${e}
      </div>
    `,className:"clustered-marker",iconSize:[a,a],iconAnchor:[a/2,a/2]})};function jy({center:e,zoom:t,bounds:i}){const s=my();return P.useEffect(()=>{i&&i.length===2?s.fitBounds(i,{padding:[20,20]}):s.setView(e,t)},[s,e,t,i]),null}let by=Li.divIcon({html:'<div style="background-color: #3388ff; width: 25px; height: 25px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',iconSize:[25,25],className:""});const ky={Critical:Li.divIcon({html:'<div style="background-color: #ff4444; width: 30px; height: 30px; border-radius: 50%; border: 3px solid white; box-shadow: 0 3px 6px rgba(0,0,0,0.4); animation: pulse 2s infinite;"></div>',iconSize:[30,30],className:"critical-marker"}),High:Li.divIcon({html:'<div style="background-color: #ff8800; width: 28px; height: 28px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>',iconSize:[28,28],className:""}),Normal:Li.divIcon({html:'<div style="background-color: #3388ff; width: 25px; height: 25px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',iconSize:[25,25],className:""}),Low:Li.divIcon({html:'<div style="background-color: #88cc88; width: 22px; height: 22px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',iconSize:[22,22],className:""})},Wp=e=>{switch(e){case"New":return"#ff6b6b";case"Scheduled":return"#4ecdc4";case"In-Progress":return"#45b7d1";case"On-Hold":return"#f9ca24";case"Complete":return"#6c5ce7";case"Closed":return"#a0a0a0";default:return"#3388ff"}};function Ty({onRefresh:e,interval:t=6e4}){const[i,s]=P.useState(t/1e3);return P.useEffect(()=>{const a=setInterval(()=>{s(c=>c<=1?(e(),t/1e3):c-1)},1e3);return()=>clearInterval(a)},[e,t]),r.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"rgba(255,255,255,0.9)",padding:"8px 12px",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",zIndex:1e3,fontSize:"12px"},children:["Auto-refresh in ",i,"s"]})}function Py({tickets:e}){const t=P.useMemo(()=>{const i=e.filter(p=>!["Complete","Closed"].includes(p.Status)),s=i.filter(p=>p.Priority==="Critical").length,a=i.filter(p=>p.Priority==="High").length,c=i.filter(p=>p.Status==="In-Progress").length,d=i.filter(p=>new Date(p.SLA_Due)<new Date).length;return{total:i.length,critical:s,high:a,inProgress:c,overdue:d,byStatus:i.reduce((p,m)=>(p[m.Status]=(p[m.Status]||0)+1,p),{})}},[e]);return r.jsxs("div",{style:{position:"absolute",bottom:"10px",left:"10px",background:"rgba(0,0,0,0.8)",color:"white",padding:"12px",borderRadius:"8px",minWidth:"200px",zIndex:1e3},children:[r.jsx("div",{style:{marginBottom:"8px",fontWeight:"bold",fontSize:"14px"},children:"Operations Dashboard"}),r.jsxs("div",{style:{fontSize:"12px",lineHeight:"1.4"},children:[r.jsxs("div",{children:["🎯 Open Tickets: ",t.total]}),r.jsxs("div",{style:{color:"#ff4444"},children:["🚨 Critical: ",t.critical]}),r.jsxs("div",{style:{color:"#ff8800"},children:["⚠️ High: ",t.high]}),r.jsxs("div",{style:{color:"#45b7d1"},children:["🔧 In Progress: ",t.inProgress]}),r.jsxs("div",{style:{color:"#ff6b6b"},children:["⏰ Overdue: ",t.overdue]}),Object.entries(t.byStatus).length>0&&r.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #333"},children:Object.entries(t.byStatus).map(([i,s])=>r.jsxs("div",{style:{color:Wp(i)},children:[i,": ",s]},i))})]})]})}function Ly(){return r.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(255,255,255,0.95)",padding:"10px",borderRadius:"6px",border:"1px solid #ccc",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",zIndex:1e3,fontSize:"11px",minWidth:"120px"},children:[r.jsx("div",{style:{fontWeight:"bold",marginBottom:"6px",color:"#333"},children:"Priority"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"3px"},children:[r.jsx("div",{style:{width:"15px",height:"15px",borderRadius:"50%",backgroundColor:"#ff4444",marginRight:"6px"}}),r.jsx("span",{style:{color:"#333"},children:"Critical"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"3px"},children:[r.jsx("div",{style:{width:"14px",height:"14px",borderRadius:"50%",backgroundColor:"#ff8800",marginRight:"6px"}}),r.jsx("span",{style:{color:"#333"},children:"High"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"3px"},children:[r.jsx("div",{style:{width:"13px",height:"13px",borderRadius:"50%",backgroundColor:"#3388ff",marginRight:"6px"}}),r.jsx("span",{style:{color:"#333"},children:"Normal"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("div",{style:{width:"11px",height:"11px",borderRadius:"50%",backgroundColor:"#88cc88",marginRight:"6px"}}),r.jsx("span",{style:{color:"#333"},children:"Low"})]})]})}function Ny({onToggleFullscreen:e,isFullscreen:t,onRefresh:i,onPopOut:s,onFixGeolocations:a}){return r.jsxs("div",{style:{position:"absolute",top:"10px",right:"140px",display:"flex",gap:"4px",zIndex:1e3,flexWrap:"wrap"},children:[r.jsx("button",{onClick:i,style:{background:"rgba(255,255,255,0.9)",border:"1px solid #ccc",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"500",color:"#333",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"🔄 Refresh"}),r.jsx("button",{onClick:a,style:{background:"rgba(255,255,255,0.9)",border:"1px solid #ccc",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"500",color:"#333",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},title:"Fix missing geolocations for existing tickets",children:"📍 Fix Locations"}),r.jsx("button",{onClick:s,style:{background:"rgba(255,255,255,0.9)",border:"1px solid #ccc",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"500",color:"#333",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"🗗 Pop Out"}),r.jsx("button",{onClick:e,style:{background:"rgba(255,255,255,0.9)",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:t?"🗗 Exit":"🗖 Full"})]})}function Hp({tickets:e,refreshTrigger:t}={}){const[i,s]=P.useState(e||[]),[a,c]=P.useState([]),[d,p]=P.useState(!0),[m,g]=P.useState(""),[_,j]=P.useState(!1),[b,D]=P.useState(new Date),k=async()=>{try{if(p(!0),e&&e.length>0){const H=await Gl();s(e),c(H)}else{const[H,U]=await Promise.all([$p(),Gl()]);s(H),c(U)}D(new Date),g("")}catch(H){g("Failed to load ticket data"),console.error("Error loading map data:",H)}finally{p(!1)}};P.useEffect(()=>{k()},[]),P.useEffect(()=>{e&&(s(e),D(new Date))},[e]),P.useEffect(()=>{t!==void 0&&k()},[t]);const A=P.useMemo(()=>i.filter(H=>!["Complete","Closed"].includes(H.Status)),[i]),O=P.useMemo(()=>{const U=A.filter(F=>F.GeoLocation).map(F=>{const[G,K]=F.GeoLocation.split(",").map(ne=>parseFloat(ne.trim()));return isNaN(G)||isNaN(K)?null:{ticket:F,position:[G,K],coordKey:`${G.toFixed(4)},${K.toFixed(4)}`}}).filter(Boolean).reduce((F,G)=>{const K=G.coordKey;return F[K]||(F[K]={position:G.position,tickets:[]}),F[K].tickets.push(G.ticket),F},{});return Object.entries(U).map(([F,G])=>{const K=G.tickets.length,ne=G.tickets.reduce((re,oe)=>{const T={Critical:4,High:3,Normal:2,Low:1},v=T[oe.Priority]||0,E=T[re]||0;return v>E?oe.Priority:re},"Low");return{coordKey:F,position:G.position,tickets:G.tickets,count:K,priority:ne,icon:K>1?Cy(K,ne):ky[ne]||by}})},[A]),S=P.useMemo(()=>{var Q;if(O.length===0)return{center:[31.9686,-99.9018],zoom:6};if(O.length===1)return{center:((Q=O[0])==null?void 0:Q.position)||[31.9686,-99.9018],zoom:10};const H=O.map(te=>te==null?void 0:te.position).filter(Boolean),U=H.map(te=>te[0]),F=H.map(te=>te[1]),G=Math.min(...U),K=Math.max(...U),ne=Math.min(...F),re=Math.max(...F),oe=(G+K)/2,T=(ne+re)/2,v=K-G,E=re-ne,W=Math.max(v,E);let Z=6;return W<1?Z=10:W<3?Z=8:W<8?Z=6:W<20?Z=5:W<40?Z=4:Z=3,{center:[oe,T],zoom:Z,bounds:[[G,ne],[K,re]]}},[O]),f=S.center,w=(H,U)=>{const F=a.find(G=>G.Site===H&&G.Customer===U);return F?`${F.Address||""}, ${F.City||""}, ${F.State||""}`.replace(/^,\s*|,\s*$/g,""):"Unknown location"},C=H=>{const U=new Date,G=new Date(H).getTime()-U.getTime();if(G<0)return`⚠️ ${Math.abs(Math.floor(G/36e5))}h overdue`;const K=Math.floor(G/(1e3*60*60)),ne=Math.floor(G%(1e3*60*60)/(1e3*60));return K<1?`${ne}m remaining`:K<24?`${K}h ${ne}m remaining`:`${Math.floor(K/24)}d ${K%24}h remaining`},y=()=>{j(!_)},z=()=>{const U=`${window.location.origin+window.location.pathname}?map-only=true`,F=window.open(U,"operations-map","width=1200,height=800,scrollbars=no,resizable=yes,status=no,location=no,toolbar=no,menubar=no");F&&F.focus()},I=async()=>{try{console.log("Fixing geolocations for existing tickets...");const H=await wy();H>0?(alert(`Successfully fixed geolocation for ${H} tickets! The map will refresh automatically.`),await k()):alert("No tickets needed geolocation fixes.")}catch(H){console.error("Error fixing geolocations:",H),alert("Error occurred while fixing geolocations. Please try again.")}};if(d)return r.jsx("div",{style:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",borderRadius:"8px"},children:"Loading operations map..."});if(m)return r.jsx("div",{style:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#d32f2f",borderRadius:"8px",border:"1px solid #ffcdd2"},children:m});const B=_?"100vh":"calc(100vh - 120px)",$=_?"100vw":"100%";return r.jsxs(r.Fragment,{children:[r.jsx("style",{children:`
        @keyframes pulse {
          0% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.2); opacity: 0.7; }
          100% { transform: scale(1); opacity: 1; }
        }
        
        ${_?`
          .operations-map-fullscreen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 9999 !important;
            background: white;
          }
        `:""}
      `}),r.jsxs("div",{className:_?"operations-map-fullscreen":"",style:{position:"relative",height:B,width:$,borderRadius:_?"0":"8px",overflow:"hidden",border:_?"none":"1px solid #e0e0e0"},children:[r.jsxs(vy,{center:f,zoom:S.zoom,style:{height:"100%",width:"100%"},zoomControl:!0,children:[r.jsx(_y,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.jsx(jy,{center:f,zoom:S.zoom,bounds:S.bounds}),O.map((H,U)=>H?r.jsx(xy,{position:H.position,icon:H.icon,children:r.jsx(yy,{children:r.jsxs("div",{style:{minWidth:"300px",maxHeight:"400px",overflowY:"auto"},children:[H.count>1&&r.jsxs("div",{style:{background:"#f0f0f0",padding:"8px",borderRadius:"4px",marginBottom:"8px",textAlign:"center",fontSize:"14px",fontWeight:"bold",color:"#333"},children:["📍 ",H.count," Open Tickets at This Location"]}),H.tickets.map((F,G)=>r.jsxs("div",{style:{marginBottom:G<H.tickets.length-1?"16px":"0",paddingBottom:G<H.tickets.length-1?"16px":"0",borderBottom:G<H.tickets.length-1?"1px solid #eee":"none"},children:[r.jsx("h4",{style:{margin:"0 0 8px 0",color:"#333"},children:F.Title}),r.jsxs("div",{style:{fontSize:"12px",lineHeight:"1.4"},children:[r.jsxs("div",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"ID:"})," ",F.TicketID]}),r.jsxs("div",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"Status:"})," ",r.jsx("span",{style:{color:Wp(F.Status)},children:F.Status})]}),r.jsxs("div",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"Priority:"})," ",r.jsx("span",{style:{color:F.Priority==="Critical"?"#ff4444":F.Priority==="High"?"#ff8800":"#333"},children:F.Priority})]}),r.jsxs("div",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"Location:"})," ",w(F.Site,F.Customer)]}),r.jsxs("div",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"Assigned:"})," ",F.AssignedTo||"Unassigned"]}),r.jsxs("div",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"SLA:"})," ",C(F.SLA_Due)]}),F.Description&&r.jsx("div",{style:{marginTop:"6px",paddingTop:"6px",borderTop:"1px solid #eee"},children:r.jsx("div",{style:{fontStyle:"italic",color:"#555"},children:F.Description.length>100?`${F.Description.substring(0,100)}...`:F.Description})})]})]},F.TicketID))]})})},`${H.coordKey}-${U}`):null)]},`map-${O.length}`),r.jsx(Ly,{}),r.jsx(Py,{tickets:i}),r.jsx(Ty,{onRefresh:k}),r.jsx(Ny,{onToggleFullscreen:y,isFullscreen:_,onRefresh:k,onPopOut:z,onFixGeolocations:I}),r.jsxs("div",{style:{position:"absolute",bottom:"120px",right:"10px",background:"rgba(255,255,255,0.9)",padding:"6px 8px",borderRadius:"4px",fontSize:"10px",color:"#333",zIndex:1e3},children:["Last updated: ",b.toLocaleTimeString()]})]})]})}function Ay({tickets:e,currentUser:t,onTicketSelect:i}){const[s,a]=P.useState(new Date),[c,d]=P.useState("week"),p=P.useMemo(()=>t?t.role==="Technician"?e.filter(f=>f.AssignedTo===t.fullName||f.AssignedTo===t.username):e:[],[e,t]),m=P.useMemo(()=>p.filter(f=>f.ScheduledStart&&f.ScheduledStart!==""&&f.Status!=="Closed"&&f.Status!=="Complete"),[p]),g=()=>{const f=new Date(s);c==="day"?f.setDate(f.getDate()-1):c==="week"?f.setDate(f.getDate()-7):c==="month"&&f.setMonth(f.getMonth()-1),a(f)},_=()=>{const f=new Date(s);c==="day"?f.setDate(f.getDate()+1):c==="week"?f.setDate(f.getDate()+7):c==="month"&&f.setMonth(f.getMonth()+1),a(f)},j=()=>{a(new Date)},b=()=>{if(c==="day")return[new Date(s)];if(c==="week"){const f=new Date(s),w=f.getDay();f.setDate(f.getDate()-w);const C=[];for(let y=0;y<7;y++){const z=new Date(f);z.setDate(f.getDate()+y),C.push(z)}return C}else if(c==="month"){const f=new Date(s.getFullYear(),s.getMonth(),1),w=new Date(s.getFullYear(),s.getMonth()+1,0),C=new Date(f);C.setDate(C.getDate()-f.getDay());const y=[],z=new Date(C);for(;(z<=w||y.length<42)&&(y.push(new Date(z)),z.setDate(z.getDate()+1),!(z.getDay()===0&&z>w)););return y}return[]},D=f=>{const w=f.toISOString().split("T")[0];return m.filter(C=>new Date(C.ScheduledStart).toISOString().split("T")[0]===w)},k=()=>{if(c==="day")return s.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});if(c==="week"){const f=b(),w=f[0].toLocaleDateString("en-US",{month:"short",day:"numeric"}),C=f[6].toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return`${w} - ${C}`}else if(c==="month")return s.toLocaleDateString("en-US",{year:"numeric",month:"long"});return""},A=f=>{switch(f){case"New":return"#007bff";case"Scheduled":return"#28a745";case"In-Progress":return"#ffc107";case"On-Hold":return"#dc3545";default:return"#6c757d"}},O=(f,w=!1)=>{const C=f.ScheduledStart?new Date(f.ScheduledStart).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"";return r.jsx("div",{className:"calendar-ticket",style:{backgroundColor:A(f.Status),color:"white",padding:w?"2px 4px":"4px 6px",margin:"1px 0",borderRadius:"3px",fontSize:w?"10px":"11px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>i==null?void 0:i(f),title:`${f.TicketID} - ${f.Title}
Site: ${f.Site}
Technician: ${f.AssignedTo}
Status: ${f.Status}`,children:w?r.jsx("div",{children:f.TicketID}):r.jsxs("div",{children:[r.jsxs("div",{style:{fontWeight:"bold"},children:[C," - ",f.TicketID]}),r.jsx("div",{style:{fontSize:"10px"},children:f.Site}),r.jsx("div",{style:{fontSize:"9px"},children:f.AssignedTo})]})},f.TicketID)},S=b();return r.jsxs("div",{style:{padding:"20px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"10px"},children:[r.jsx("h2",{style:{margin:0},children:"Dispatch Calendar"}),r.jsxs("div",{className:"calendar-navigation",children:[r.jsx("div",{style:{display:"flex",gap:"5px"},children:["day","week","month"].map(f=>r.jsx("button",{className:c===f?"primary":"ghost",onClick:()=>d(f),style:{padding:"5px 10px",fontSize:"12px"},children:f.charAt(0).toUpperCase()+f.slice(1)},f))}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx("button",{className:"ghost",onClick:g,children:"‹"}),r.jsx("button",{className:"ghost",onClick:j,style:{fontSize:"12px"},children:"Today"}),r.jsx("button",{className:"ghost",onClick:_,children:"›"})]}),r.jsx("div",{style:{fontWeight:"bold",minWidth:"200px",textAlign:"center"},children:k()})]})]}),r.jsx("div",{style:{display:"flex",gap:"15px",marginBottom:"15px",fontSize:"12px",flexWrap:"wrap"},children:["New","Scheduled","In-Progress","On-Hold"].map(f=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[r.jsx("div",{style:{width:"12px",height:"12px",backgroundColor:A(f),borderRadius:"2px"}}),r.jsx("span",{children:f})]},f))}),c==="day"&&r.jsxs("div",{style:{border:"1px solid #2b416a",borderRadius:"4px",backgroundColor:"#111a2b"},children:[r.jsx("div",{style:{padding:"10px",backgroundColor:"#1d375a",color:"#e5ecff",borderBottom:"1px solid #2b416a",fontWeight:"bold"},children:s.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),r.jsxs("div",{style:{padding:"10px",minHeight:"400px"},children:[D(s).map(f=>O(f,!1)),D(s).length===0&&r.jsx("div",{style:{color:"#8892a6",fontStyle:"italic"},children:"No scheduled tickets for this day"})]})]}),c==="week"&&r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"1px",border:"1px solid #2b416a",backgroundColor:"#0b1220"},children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(f=>r.jsx("div",{style:{padding:"8px",backgroundColor:"#1d375a",color:"#e5ecff",fontWeight:"bold",textAlign:"center",borderRight:"1px solid #2b416a"},children:f},f)),S.map(f=>{const w=D(f),C=f.toDateString()===new Date().toDateString();return r.jsxs("div",{style:{minHeight:"120px",padding:"4px",backgroundColor:C?"#2b2321":"#111a2b",color:"#e5ecff",borderRight:"1px solid #2b416a",borderBottom:"1px solid #2b416a"},children:[r.jsx("div",{style:{fontWeight:C?"bold":"normal",color:C?"#ffc78a":"#e5ecff",marginBottom:"4px",fontSize:"12px"},children:f.getDate()}),w.map(y=>O(y,!0))]},f.toISOString())})]}),c==="month"&&r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"1px",border:"1px solid #2b416a",backgroundColor:"#0b1220"},children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(f=>r.jsx("div",{style:{padding:"8px",backgroundColor:"#1d375a",color:"#e5ecff",fontWeight:"bold",textAlign:"center",borderRight:"1px solid #2b416a"},children:f},f)),S.map(f=>{const w=D(f),C=f.toDateString()===new Date().toDateString(),y=f.getMonth()===s.getMonth();return r.jsxs("div",{style:{minHeight:"80px",padding:"2px",backgroundColor:C?"#2b2321":y?"#111a2b":"#0c1426",color:y?"#e5ecff":"#8892a6",borderRight:"1px solid #2b416a",borderBottom:"1px solid #2b416a",opacity:y?1:.6},children:[r.jsx("div",{style:{fontWeight:C?"bold":"normal",color:C?"#ffc78a":y?"#e5ecff":"#8892a6",marginBottom:"2px",fontSize:"11px"},children:f.getDate()}),w.map(z=>O(z,!0))]},f.toISOString())})]}),r.jsxs("div",{style:{marginTop:"20px",padding:"10px",backgroundColor:"#111a2b",border:"1px solid #2b416a",borderRadius:"4px",color:"#e5ecff",fontSize:"12px"},children:[r.jsx("strong",{children:"Summary:"})," ",m.length," scheduled tickets",(t==null?void 0:t.role)==="Technician"&&` assigned to ${t.fullName}`]})]})}function Ey({title:e,value:t,subtext:i,color:s="#333",trend:a}){const c=a==="up"?"📈":a==="down"?"📉":"📊";return r.jsxs("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"20px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",minWidth:"200px"},children:[r.jsxs("div",{style:{fontSize:"14px",color:"#555",marginBottom:"8px"},children:[c," ",e]}),r.jsx("div",{style:{fontSize:"28px",fontWeight:"bold",color:s,marginBottom:"4px"},children:t}),i&&r.jsx("div",{style:{fontSize:"12px",color:"#333"},children:i})]})}function zy({tickets:e}){const t=P.useMemo(()=>{const s=e.reduce((d,p)=>(d[p.Priority]=(d[p.Priority]||0)+1,d),{}),a=["Critical","High","Normal","Low"],c={Critical:"#ff4444",High:"#ff8800",Normal:"#3388ff",Low:"#88cc88"};return a.map(d=>({name:d,count:s[d]||0,color:c[d]}))},[e]),i=t.reduce((s,a)=>s+a.count,0);return r.jsxs("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"20px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[r.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"Priority Distribution"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:t.map(s=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:s.color}}),r.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("span",{style:{minWidth:"60px",fontSize:"14px",fontWeight:"500",color:"#333"},children:s.name}),r.jsx("div",{style:{flex:1,height:"20px",backgroundColor:"#f0f0f0",borderRadius:"10px",overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${i>0?s.count/i*100:0}%`,backgroundColor:s.color,transition:"width 0.3s ease"}})}),r.jsx("span",{style:{minWidth:"40px",fontSize:"14px",fontWeight:"bold",color:"#333"},children:s.count})]})]},s.name))})]})}function Dy({tickets:e}){const t=P.useMemo(()=>{const s=e.reduce((c,d)=>(c[d.Status]=(c[d.Status]||0)+1,c),{}),a={New:"#666666",Scheduled:"#3388ff","In-Progress":"#ff8800",Complete:"#88cc88",Closed:"#888888",Critical:"#ff4444"};return Object.entries(s).map(([c,d])=>({name:c,count:d,color:a[c]||"#666"})).sort((c,d)=>d.count-c.count)},[e]),i=t.reduce((s,a)=>s+a.count,0);return r.jsxs("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"20px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[r.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"Status Distribution"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:t.map(s=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"4px",backgroundColor:s.color}}),r.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("span",{style:{minWidth:"80px",fontSize:"14px",fontWeight:"500",color:"#333"},children:s.name}),r.jsx("div",{style:{flex:1,height:"20px",backgroundColor:"#f0f0f0",borderRadius:"10px",overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${i>0?s.count/i*100:0}%`,backgroundColor:s.color,transition:"width 0.3s ease"}})}),r.jsx("span",{style:{minWidth:"40px",fontSize:"14px",fontWeight:"bold",color:"#333"},children:s.count})]})]},s.name))})]})}function Iy({tickets:e}){const t=P.useMemo(()=>{const i=e.reduce((s,a)=>{const c=`${a.Customer} - ${a.Site}`;return s[c]||(s[c]={customer:a.Customer,site:a.Site,total:0,critical:0,high:0,open:0}),s[c].total++,a.Priority==="Critical"&&s[c].critical++,a.Priority==="High"&&s[c].high++,["Complete","Closed"].includes(a.Status)||s[c].open++,s},{});return Object.values(i).sort((s,a)=>a.total-s.total).slice(0,10)},[e]);return r.jsxs("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"20px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",gridColumn:"1 / -1"},children:[r.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"Top Sites by Ticket Volume"}),r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{borderBottom:"2px solid #e0e0e0"},children:[r.jsx("th",{style:{textAlign:"left",padding:"12px 8px",fontSize:"14px",fontWeight:"600",color:"#333"},children:"Customer"}),r.jsx("th",{style:{textAlign:"left",padding:"12px 8px",fontSize:"14px",fontWeight:"600",color:"#333"},children:"Site"}),r.jsx("th",{style:{textAlign:"center",padding:"12px 8px",fontSize:"14px",fontWeight:"600",color:"#333"},children:"Total"}),r.jsx("th",{style:{textAlign:"center",padding:"12px 8px",fontSize:"14px",fontWeight:"600",color:"#333"},children:"Open"}),r.jsx("th",{style:{textAlign:"center",padding:"12px 8px",fontSize:"14px",fontWeight:"600",color:"#333"},children:"Critical"}),r.jsx("th",{style:{textAlign:"center",padding:"12px 8px",fontSize:"14px",fontWeight:"600",color:"#333"},children:"High"})]})}),r.jsx("tbody",{children:t.map((i,s)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f0f0f0"},children:[r.jsx("td",{style:{padding:"12px 8px",fontSize:"13px",color:"#333"},children:i.customer}),r.jsx("td",{style:{padding:"12px 8px",fontSize:"13px",fontWeight:"500",color:"#333"},children:i.site}),r.jsx("td",{style:{padding:"12px 8px",fontSize:"13px",textAlign:"center",fontWeight:"bold",color:"#333"},children:i.total}),r.jsx("td",{style:{padding:"12px 8px",fontSize:"13px",textAlign:"center",color:i.open>0?"#ff8800":"#666"},children:i.open}),r.jsx("td",{style:{padding:"12px 8px",fontSize:"13px",textAlign:"center",color:i.critical>0?"#ff4444":"#666"},children:i.critical}),r.jsx("td",{style:{padding:"12px 8px",fontSize:"13px",textAlign:"center",color:i.high>0?"#ff8800":"#666"},children:i.high})]},s))})]})})]})}function Ry({tickets:e,sites:t}){const[i,s]=P.useState("all"),a=P.useMemo(()=>{if(i==="all")return e;const d=new Date,p=new Date;switch(i){case"7d":p.setDate(d.getDate()-7);break;case"30d":p.setDate(d.getDate()-30);break;case"90d":p.setDate(d.getDate()-90);break;default:return e}return e.filter(m=>new Date(m.CreatedAt)>=p)},[e,i]),c=P.useMemo(()=>{const d=a.length,p=a.filter(O=>!["Complete","Closed"].includes(O.Status)).length,m=a.filter(O=>O.Priority==="Critical").length,g=a.filter(O=>new Date(O.SLA_Due)<new Date&&!["Complete","Closed"].includes(O.Status)).length,_=Oy(a),j=a.filter(O=>["Complete","Closed"].includes(O.Status)).length,b=d>0?Math.round(j/d*100):0,D=m>0?"up":"neutral",k=g>0?"up":"down",A=b>80?"up":"neutral";return[{title:"Total Tickets",value:d,color:"#333",trend:"neutral"},{title:"Open Tickets",value:p,color:"#ff8800",trend:"up"},{title:"Critical Issues",value:m,color:"#ff4444",trend:D},{title:"Overdue",value:g,color:"#ff4444",trend:k},{title:"Avg Resolution",value:_,subtext:"hours",color:"#3388ff",trend:"neutral"},{title:"Completion Rate",value:`${b}%`,color:"#88cc88",trend:A}]},[a]);return r.jsxs("div",{style:{padding:"20px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",flexWrap:"wrap",gap:"16px"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{margin:"0 0 8px 0",color:"#333",fontSize:"28px"},children:"📊 Reports & Analytics"}),r.jsx("p",{style:{margin:0,color:"#555",fontSize:"14px"},children:"Performance metrics and insights for field service operations"})]}),r.jsx("div",{style:{display:"flex",gap:"8px"},children:[{label:"All Time",value:"all"},{label:"Last 7 Days",value:"7d"},{label:"Last 30 Days",value:"30d"},{label:"Last 90 Days",value:"90d"}].map(d=>r.jsx("button",{onClick:()=>s(d.value),style:{padding:"8px 16px",border:"1px solid #ccc",borderRadius:"4px",background:i===d.value?"#3388ff":"white",color:i===d.value?"white":"#333",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:d.label},d.value))})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:c.map((d,p)=>r.jsx(Ey,{...d},p))}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"16px",marginBottom:"24px"},children:[r.jsx(zy,{tickets:a}),r.jsx(Dy,{tickets:a})]}),r.jsx(Iy,{tickets:a})]})}function Oy(e){const t=e.filter(a=>a.ClosedDate&&a.CreatedAt);if(t.length===0)return"N/A";const s=t.reduce((a,c)=>{const d=new Date(c.CreatedAt),m=(new Date(c.ClosedDate).getTime()-d.getTime())/(1e3*60*60);return a+m},0)/t.length;return s<24?Math.round(s).toString():`${Math.round(s/24)}d`}function My(e){return new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function ph(e,t){const i=new Date(e),a=new Date(t).getTime()-i.getTime(),c=Math.floor(a/(1e3*60*60)),d=Math.floor(c/24);if(d>0){const p=c%24;return`${d}d ${p}h`}else return`${c}h`}function By(e){return{Critical:"#ff4444",High:"#ff8800",Normal:"#3388ff",Low:"#88cc88"}[e]||"#666"}function Fy(e){return{Complete:"#88cc88",Closed:"#666666"}[e]||"#666"}function Uy({tickets:e,onViewHistory:t,onReopen:i}){const[s,a]=P.useState(""),[c,d]=P.useState("all"),[p,m]=P.useState("all"),[g,_]=P.useState("closedDate"),[j,b]=P.useState("desc"),[D,k]=P.useState(!1),[A,O]=P.useState(null),[S,f]=P.useState(""),w=P.useMemo(()=>e.filter(U=>U.Status==="Closed"),[e]),C=P.useMemo(()=>{let U=w.filter(F=>{const G=F.Title.toLowerCase().includes(s.toLowerCase())||F.TicketID.toLowerCase().includes(s.toLowerCase())||F.Site.toLowerCase().includes(s.toLowerCase())||F.Customer.toLowerCase().includes(s.toLowerCase()),K=c==="all"||F.Status===c,ne=p==="all"||F.Priority===p;return G&&K&&ne});return U.sort((F,G)=>{let K=0;switch(g){case"closedDate":K=new Date(F.ClosedDate||"").getTime()-new Date(G.ClosedDate||"").getTime();break;case"duration":const ne=new Date(F.ClosedDate||"").getTime()-new Date(F.CreatedAt).getTime(),re=new Date(G.ClosedDate||"").getTime()-new Date(G.CreatedAt).getTime();K=ne-re;break;case"priority":const oe={Critical:4,High:3,Normal:2,Low:1};K=(oe[F.Priority]||0)-(oe[G.Priority]||0);break}return j==="desc"?-K:K}),U},[w,s,c,p,g,j]),y=P.useMemo(()=>{const U=w.length,F=w.length>0?w.reduce((G,K)=>{if(!K.ClosedDate)return G;const ne=new Date(K.ClosedDate).getTime()-new Date(K.CreatedAt).getTime();return G+ne/(1e3*60*60)},0)/w.length:0;return{total:U,avgResolution:F}},[w]),z=()=>{const U=[{key:"TicketID",label:"Ticket ID"},{key:"Title",label:"Title"},{key:"Customer",label:"Customer"},{key:"Site",label:"Site"},{key:"Priority",label:"Priority"},{key:"Status",label:"Status"},{key:"CreatedAt",label:"Created At"},{key:"ClosedDate",label:"Closed Date"},{key:"ResolutionDuration",label:"Resolution Duration"},{key:"AssignedTo",label:"Assigned To"},{key:"Owner",label:"Owner"},{key:"Category",label:"Category"},{key:"Resolution",label:"Resolution"},{key:"Description",label:"Description"}],F=C.map(G=>({...G,Priority:Dp(G.Priority||""),Status:Ip(G.Status||""),CreatedAt:Gt(G.CreatedAt||""),ClosedDate:Gt(G.ClosedDate||""),ResolutionDuration:G.ClosedDate?ph(G.CreatedAt,G.ClosedDate):"N/A"}));ri(F,U,"closed-tickets")},I=U=>{g===U?b(j==="asc"?"desc":"asc"):(_(U),b("desc"))},B=U=>{O(U),k(!0),f("")},$=()=>{if(!S.trim()){alert("Please provide a reason for reopening this ticket.");return}if(A&&i){const U={...A,reopenReason:S.trim()};i(U)}k(!1),O(null),f("")},H=()=>{k(!1),O(null),f("")};return r.jsxs("div",{style:{padding:"20px"},children:[r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx("h1",{style:{margin:"0 0 8px 0",color:"#1a202c",fontSize:"28px",fontWeight:"700"},children:"✅ Closed Tickets"}),r.jsx("p",{style:{margin:0,color:"#2d3748",fontSize:"14px",fontWeight:"500"},children:"Completed and closed service requests"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[r.jsxs("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#2d3748",marginBottom:"8px",fontWeight:"600"},children:"� Total Closed"}),r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#1a202c"},children:y.total})]}),r.jsxs("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#2d3748",marginBottom:"8px",fontWeight:"600"},children:"⏱️ Avg Resolution"}),r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#1d4ed8"},children:y.avgResolution>0?`${Math.round(y.avgResolution)}h`:"0h"})]})]}),r.jsx("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"16px",marginBottom:"16px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",alignItems:"end"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"4px",color:"#1a202c"},children:"Search"}),r.jsx("input",{type:"text",placeholder:"Search tickets, sites, or customers...",value:s,onChange:U=>a(U.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px",color:"#333"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"4px",color:"#1a202c"},children:"Status"}),r.jsxs("select",{value:c,onChange:U=>d(U.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px",color:"#333"},children:[r.jsx("option",{value:"all",children:"All Statuses"}),r.jsx("option",{value:"Complete",children:"Complete"}),r.jsx("option",{value:"Closed",children:"Closed"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"4px",color:"#1a202c"},children:"Priority"}),r.jsxs("select",{value:p,onChange:U=>m(U.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px",color:"#333"},children:[r.jsx("option",{value:"all",children:"All Priorities"}),r.jsx("option",{value:"Critical",children:"Critical"}),r.jsx("option",{value:"High",children:"High"}),r.jsx("option",{value:"Normal",children:"Normal"}),r.jsx("option",{value:"Low",children:"Low"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"4px",color:"#1a202c"},children:"Sort By"}),r.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[{label:"Closed Date",value:"closedDate"},{label:"Duration",value:"duration"},{label:"Priority",value:"priority"}].map(U=>r.jsxs("button",{onClick:()=>I(U.value),style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",background:g===U.value?"#3388ff":"white",color:g===U.value?"white":"#333",cursor:"pointer",fontSize:"12px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},children:[U.label,g===U.value&&(j==="desc"?"↓":"↑")]},U.value))})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"4px",color:"#1a202c"},children:"Export"}),r.jsx("button",{onClick:z,style:{padding:"8px 16px",border:"1px solid #22c55e",borderRadius:"4px",background:"#22c55e",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px",width:"fit-content"},title:`Export ${C.length} closed tickets to CSV`,children:"📊 Export CSV"})]})]})}),r.jsxs("div",{style:{marginBottom:"16px",fontSize:"14px",color:"#2d3748",fontWeight:"500"},children:["Showing ",C.length," of ",w.length," closed tickets"]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[C.map(U=>r.jsxs("div",{style:{background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[r.jsxs("div",{children:[r.jsx("h3",{style:{margin:"0 0 4px 0",color:"#1a202c",fontSize:"16px",fontWeight:"700"},children:U.Title}),r.jsxs("div",{style:{fontSize:"13px",color:"#2d3748",fontWeight:"500"},children:[U.TicketID," • ",U.Customer," - ",U.Site]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[r.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"500",backgroundColor:By(U.Priority),color:"white"},children:U.Priority}),r.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"500",backgroundColor:Fy(U.Status),color:"white"},children:U.Status})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",fontSize:"13px",marginBottom:"12px",color:"#1a202c",fontWeight:"500"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Closed:"})," ",U.ClosedDate?My(U.ClosedDate):"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Duration:"})," ",U.ClosedDate?ph(U.CreatedAt,U.ClosedDate):"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Closed By:"})," ",U.ClosedBy||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Category:"})," ",U.Category]})]}),U.Resolution&&r.jsxs("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:"4px",padding:"12px",fontSize:"13px"},children:[r.jsx("strong",{style:{color:"#1a202c",marginBottom:"4px",display:"block",fontWeight:"600"},children:"Resolution:"}),r.jsx("div",{style:{color:"#2d3748",lineHeight:"1.4",fontWeight:"500"},children:U.Resolution})]}),r.jsxs("div",{style:{marginTop:"16px",paddingTop:"12px",borderTop:"1px solid #e9ecef",display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t&&r.jsx("button",{onClick:()=>t(U),style:{padding:"6px 12px",fontSize:"12px",backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"4px",cursor:"pointer",color:"#495057"},children:"📋 View History"}),i&&r.jsx("button",{onClick:()=>B(U),style:{padding:"6px 12px",fontSize:"12px",backgroundColor:"#d4edda",border:"1px solid #c3e6cb",borderRadius:"4px",cursor:"pointer",color:"#155724"},children:"🔄 Reopen"})]})]},U.TicketID)),C.length===0&&r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#555",fontSize:"16px"},children:w.length===0?"📭 No closed tickets yet":"🔍 No tickets match your current filters"})]}),D&&A&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"24px",width:"90%",maxWidth:"500px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},children:[r.jsx("h3",{style:{margin:"0 0 16px 0",color:"#1a202c",fontSize:"18px",fontWeight:"600"},children:"🔄 Reopen Ticket"}),r.jsxs("div",{style:{marginBottom:"16px",color:"#2d3748",fontSize:"14px"},children:[r.jsx("strong",{children:"Ticket:"})," ",A.TicketID," - ",A.Title]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#1a202c",fontWeight:"600"},children:"Reason for Reopening *"}),r.jsx("textarea",{value:S,onChange:U=>f(U.target.value),placeholder:"Please provide a detailed reason for reopening this ticket...",style:{width:"100%",padding:"12px",border:"2px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",minHeight:"100px",resize:"vertical",boxSizing:"border-box",fontFamily:"inherit"}}),r.jsx("div",{style:{fontSize:"12px",color:"#4a5568",marginTop:"4px"},children:"This reason will be added to the audit trail"})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{onClick:H,style:{padding:"10px 20px",border:"1px solid #d1d5db",borderRadius:"6px",backgroundColor:"white",color:"#374151",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"Cancel"}),r.jsx("button",{onClick:$,disabled:!S.trim(),style:{padding:"10px 20px",border:"none",borderRadius:"6px",backgroundColor:S.trim()?"#059669":"#a0aec0",color:"white",cursor:S.trim()?"pointer":"not-allowed",fontSize:"14px",fontWeight:"500"},children:"Reopen Ticket"})]})]})})]})}const pr="https://field-service-api.azurewebsites.net/api";function $y({currentUser:e}){const[t,i]=P.useState([]),[s,a]=P.useState(!0),[c,d]=P.useState(""),[p,m]=P.useState(!1),[g,_]=P.useState(null),[j,b]=P.useState({username:"",email:"",fullName:"",role:"Technician",vendor:"",password:"",isActive:!0});P.useEffect(()=>{k()},[]);function D(){const C={"Content-Type":"application/json"},y=localStorage.getItem("authToken");y&&(C.Authorization=`Bearer ${y}`);const z=localStorage.getItem("sqlUser");if(z)try{const I=JSON.parse(z);I!=null&&I.id&&(C["x-user-id"]=I.id,C["x-user-name"]=I.username||I.fullName||"",C["x-user-role"]=I.role||"",I.companyCode&&(C["x-company-code"]=I.companyCode),I.companyName&&(C["x-company-name"]=I.companyName))}catch{console.warn("Failed to parse sqlUser from localStorage")}return C}async function k(){try{a(!0);const C=await fetch(`${pr}/users?includeInactive=true`,{headers:D()});if(!C.ok)throw new Error("Failed to fetch users");const y=await C.json(),z=y.value||y||[];i(z)}catch(C){d("Failed to load users"),console.error("Error loading users:",C)}finally{a(!1)}}const A=async()=>{try{if(!j.username||!j.email||!j.fullName||!j.password){d("Please fill in all required fields");return}if(j.role==="Technician"&&!j.vendor){d("Vendor/Company is required for technicians");return}const C=await fetch(`${pr}/users`,{method:"POST",headers:D(),body:JSON.stringify(j)});if(!C.ok){const y=await C.json();throw new Error(y.error||"Failed to create user")}m(!1),b({username:"",email:"",fullName:"",role:"Technician",vendor:"",password:"",isActive:!0}),await k(),d("")}catch(C){d(C instanceof Error?C.message:"Failed to create user")}},O=async C=>{try{const y=!C.isActive,z=await fetch(`${pr}/users/${C.id}`,{method:"PUT",headers:D(),body:JSON.stringify({username:C.username,email:C.email,fullName:C.fullName,role:C.role,isActive:y})});if(!z.ok){const I=await z.json();throw new Error(I.error||"Failed to update user status")}await k(),d(""),console.log(`User ${C.username} status updated to: ${y?"Active":"Inactive"}`)}catch(y){d(y instanceof Error?y.message:"Failed to update user status")}},S=async C=>{try{const y=prompt(`Enter new password for ${C.username}:`);if(!y)return;if(!localStorage.getItem("authToken")){d("Not authenticated - please login first");return}const I=D(),B=await fetch(`${pr}/auth/reset-password`,{method:"POST",headers:I,body:JSON.stringify({userId:C.id,newPassword:y})});if(!B.ok){const $=await B.json();throw new Error($.error||"Failed to reset password")}alert(`Password reset successfully for ${C.username}`)}catch(y){d(y instanceof Error?y.message:"Failed to reset password")}},f=async C=>{try{if(!confirm(`Are you sure you want to delete user "${C.username}"? This will deactivate their account.`))return;const y=await fetch(`${pr}/users/${C.id}`,{method:"DELETE",headers:D()});if(!y.ok){const z=await y.json();throw new Error(z.error||"Failed to delete user")}alert(`User ${C.username} has been deleted`),await k(),d("")}catch(y){d(y instanceof Error?y.message:"Failed to delete user")}},w=()=>{const C=[{key:"id",label:"User ID"},{key:"username",label:"Username"},{key:"fullName",label:"Full Name"},{key:"email",label:"Email"},{key:"role",label:"Role"},{key:"vendor",label:"Vendor/Company"},{key:"isActive",label:"Status"}],y=t.map(z=>({...z,isActive:z.isActive?"Active":"Inactive"}));ri(y,C,"users")};return!e||e.role!=="Admin"&&e.role!=="SystemAdmin"?r.jsxs("div",{className:"card",children:[r.jsx("h2",{children:"Access Denied"}),r.jsx("p",{children:"You don't have permission to manage users."})]}):r.jsxs("div",{style:{padding:"1rem"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[r.jsx("h1",{children:"User Management"}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsx("button",{className:"ghost",onClick:w,title:`Export ${t.length} users to CSV`,children:"📊 Export CSV"}),r.jsx("button",{className:"primary",onClick:()=>m(!0),children:"Add New User"})]})]}),c&&r.jsx("div",{style:{backgroundColor:"#fee2e2",border:"1px solid #fecaca",color:"#dc2626",padding:"1rem",borderRadius:"6px",marginBottom:"1rem"},children:c}),s?r.jsx("div",{children:"Loading users..."}):r.jsxs("div",{className:"card",children:[r.jsx("h3",{children:"Current Users"}),r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{borderBottom:"2px solid #e5e7eb"},children:[r.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Username"}),r.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Full Name"}),r.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Email"}),r.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Role"}),r.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Vendor"}),r.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Status"}),r.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Actions"})]})}),r.jsx("tbody",{children:t.map(C=>r.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[r.jsx("td",{style:{padding:"12px"},children:C.username}),r.jsx("td",{style:{padding:"12px"},children:C.fullName}),r.jsx("td",{style:{padding:"12px"},children:C.email}),r.jsx("td",{style:{padding:"12px"},children:r.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"0.875rem",backgroundColor:C.role==="Admin"?"#dbeafe":C.role==="Coordinator"?"#fef3c7":"#e0f2fe",color:C.role==="Admin"?"#1e40af":C.role==="Coordinator"?"#d97706":"#0369a1"},children:C.role})}),r.jsx("td",{style:{padding:"12px"},children:C.vendor?r.jsx("span",{style:{fontSize:"0.875rem",color:"var(--muted)"},children:C.vendor}):r.jsx("span",{style:{fontSize:"0.875rem",color:"var(--text-disabled)",fontStyle:"italic"},children:"—"})}),r.jsx("td",{style:{padding:"12px"},children:r.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"0.875rem",backgroundColor:C.isActive?"#dcfce7":"#fee2e2",color:C.isActive?"#16a34a":"#dc2626"},children:C.isActive?"Active":"Inactive"})}),r.jsx("td",{style:{padding:"12px"},children:r.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[r.jsx("button",{className:"ghost",style:{fontSize:"0.875rem",padding:"4px 8px"},onClick:()=>O(C),children:C.isActive?"Disable":"Enable"}),r.jsx("button",{className:"ghost",style:{fontSize:"0.875rem",padding:"4px 8px"},onClick:()=>S(C),children:"Reset Password"}),r.jsx("button",{className:"ghost",style:{fontSize:"0.875rem",padding:"4px 8px",color:"#dc2626",border:"1px solid #dc2626"},onClick:()=>f(C),title:"Delete user (deactivates account)",children:"🗑️ Delete"})]})})]},C.id))})]})})]}),p&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"8px",width:"100%",maxWidth:"500px",maxHeight:"90vh",overflowY:"auto"},children:[r.jsx("h2",{children:"Add New User"}),r.jsxs("div",{style:{marginBottom:"1rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#1f2937"},children:"Username *"}),r.jsx("input",{type:"text",value:j.username,onChange:C=>b(y=>({...y,username:C.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",boxSizing:"border-box"}})]}),r.jsxs("div",{style:{marginBottom:"1rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#1f2937"},children:"Full Name *"}),r.jsx("input",{type:"text",value:j.fullName,onChange:C=>b(y=>({...y,fullName:C.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",boxSizing:"border-box"}})]}),r.jsxs("div",{style:{marginBottom:"1rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#1f2937"},children:"Email *"}),r.jsx("input",{type:"email",value:j.email,onChange:C=>b(y=>({...y,email:C.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",boxSizing:"border-box"}})]}),r.jsxs("div",{style:{marginBottom:"1rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#1f2937"},children:"Role *"}),r.jsxs("select",{value:j.role,onChange:C=>b(y=>({...y,role:C.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",boxSizing:"border-box"},children:[r.jsx("option",{value:"Technician",children:"Technician"}),r.jsx("option",{value:"Coordinator",children:"Coordinator"}),r.jsx("option",{value:"Admin",children:"Admin"})]})]}),r.jsxs("div",{style:{marginBottom:"1rem"},children:[r.jsxs("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#1f2937"},children:["Vendor/Company ",j.role==="Technician"?"*":"(optional)"]}),r.jsx("input",{type:"text",value:j.vendor,onChange:C=>b(y=>({...y,vendor:C.target.value})),placeholder:j.role==="Technician"?"e.g. TechCorps Solutions":"Company name (optional)",style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",boxSizing:"border-box"}})]}),r.jsxs("div",{style:{marginBottom:"1rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#1f2937"},children:"Password *"}),r.jsx("input",{type:"password",value:j.password,onChange:C=>b(y=>({...y,password:C.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"6px",boxSizing:"border-box"}})]}),r.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[r.jsx("button",{className:"ghost",onClick:()=>m(!1),children:"Cancel"}),r.jsx("button",{className:"primary",onClick:A,children:"Create User"})]})]})})]})}const Wy="https://field-service-api.azurewebsites.net/api";function Hy(){const e={"Content-Type":"application/json"},t=localStorage.getItem("authToken");t&&(e.Authorization=`Bearer ${t}`);const i=localStorage.getItem("sqlUser");if(i)try{const s=JSON.parse(i);s.id&&(e["x-user-id"]=s.id,e["x-user-name"]=s.username||s.fullName||"",e["x-user-role"]=s.role||"")}catch{console.warn("Failed to parse sqlUser from localStorage")}return e}function Zy(){const[e,t]=P.useState([]),[i,s]=P.useState(!0),[a,c]=P.useState(""),[d,p]=P.useState(""),[m,g]=P.useState(""),[_,j]=P.useState(""),[b,D]=P.useState(8),k=[...new Set(e.map(I=>I.action))].sort(),A=[...new Set(e.map(I=>I.username))].sort();P.useEffect(()=>{f()},[]);async function O(){await f()}async function S(){p(""),g(""),j(""),D(8),await f()}async function f(){try{s(!0),c("");const I=new URLSearchParams;I.append("hours",b.toString()),d.trim()&&I.append("search",d.trim()),m&&I.append("action",m),_&&I.append("userId",_);const B=await fetch(`${Wy}/activity-log?${I}`,{headers:Hy()});if(!B.ok)throw new Error("Failed to fetch activity logs");const $=await B.json();t($)}catch(I){c("Failed to load activity logs"),console.error("Error loading activity logs:",I)}finally{s(!1)}}const w=I=>new Date(I).toLocaleString(),C=I=>{const B=new Date(I),H=new Date().getTime()-B.getTime(),U=Math.floor(H/(1e3*60)),F=Math.floor(U/60);return U<60?`${U} minute${U!==1?"s":""} ago`:`${F} hour${F!==1?"s":""} ago`},y=I=>{switch(I.toLowerCase()){case"user login":return{bg:"#dbeafe",color:"#1e40af"};case"ticket updated":return{bg:"#fef3c7",color:"#d97706"};case"user management":return{bg:"#fee2e2",color:"#dc2626"};case"ticket created":return{bg:"#dcfce7",color:"#16a34a"};default:return{bg:"#f3f4f6",color:"#374151"}}},z=()=>{const I=[{key:"id",label:"ID"},{key:"timestamp",label:"Timestamp"},{key:"username",label:"Username"},{key:"action",label:"Action"},{key:"details",label:"Details"},{key:"ip_address",label:"IP Address"},{key:"user_agent",label:"User Agent"}],B=e.map($=>({...$,timestamp:Gt($.timestamp)}));ri(B,I,"activity-log")};return i?r.jsx("div",{style:{padding:"24px"},children:r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:r.jsx("div",{style:{fontSize:"18px",color:"var(--muted)"},children:"Loading activity logs..."})})}):r.jsxs("div",{style:{padding:"24px"},children:[r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",color:"#111827",marginBottom:"8px"},children:"Activity Log"}),r.jsx("p",{style:{color:"var(--muted)"},children:"Monitor system activity and user actions"})]}),a&&r.jsx("div",{style:{padding:"12px",backgroundColor:"#fee2e2",border:"1px solid #fecaca",borderRadius:"6px",color:"#dc2626",marginBottom:"16px"},children:a}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px",padding:"16px",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"4px"},children:"Search"}),r.jsx("input",{type:"text",value:d,onChange:I=>p(I.target.value),onKeyDown:I=>{I.key==="Enter"&&O()},placeholder:"Search activities...",style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"4px"},children:"Time Range"}),r.jsxs("select",{value:b,onChange:I=>D(parseInt(I.target.value)),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},children:[r.jsx("option",{value:1,children:"Last 1 hour"}),r.jsx("option",{value:4,children:"Last 4 hours"}),r.jsx("option",{value:8,children:"Last 8 hours"}),r.jsx("option",{value:24,children:"Last 24 hours"}),r.jsx("option",{value:72,children:"Last 3 days"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"4px"},children:"Action Type"}),r.jsxs("select",{value:m,onChange:I=>g(I.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"All Actions"}),k.map(I=>r.jsx("option",{value:I,children:I},I))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"4px"},children:"User"}),r.jsxs("select",{value:_,onChange:I=>j(I.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"All Users"}),A.map(I=>r.jsx("option",{value:I,children:I},I))]})]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"24px"},children:[r.jsx("button",{onClick:O,disabled:i,style:{padding:"10px 20px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:i?"not-allowed":"pointer",opacity:i?.6:1},children:i?"Searching...":"Search"}),r.jsx("button",{onClick:S,disabled:i,style:{padding:"10px 20px",backgroundColor:"#4a5568",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:i?"not-allowed":"pointer",opacity:i?.6:1},children:i?"Loading...":"Refresh"}),r.jsx("button",{onClick:z,disabled:i||e.length===0,style:{padding:"10px 20px",backgroundColor:"#059669",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:i||e.length===0?"not-allowed":"pointer",opacity:i||e.length===0?.6:1},title:`Export ${e.length} activity log entries to CSV`,children:"📊 Export CSV"})]}),r.jsx("div",{style:{marginBottom:"16px"},children:r.jsxs("span",{style:{fontSize:"14px",color:"var(--muted)"},children:["Showing ",e.length," activities from the last ",b," hours"]})}),r.jsx("div",{style:{backgroundColor:"white",borderRadius:"8px",border:"1px solid #e5e7eb",overflow:"hidden"},children:e.length===0?r.jsx("div",{style:{padding:"48px",textAlign:"center",color:"var(--muted)"},children:"No activities found for the selected filters"}):r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{backgroundColor:"#f9fafb"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#374151",textTransform:"uppercase"},children:"Time"}),r.jsx("th",{style:{padding:"12px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#374151",textTransform:"uppercase"},children:"User"}),r.jsx("th",{style:{padding:"12px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#374151",textTransform:"uppercase"},children:"Action"}),r.jsx("th",{style:{padding:"12px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#374151",textTransform:"uppercase"},children:"Details"}),r.jsx("th",{style:{padding:"12px",textAlign:"left",fontSize:"12px",fontWeight:"600",color:"#374151",textTransform:"uppercase"},children:"IP Address"})]})}),r.jsx("tbody",{children:e.map((I,B)=>{const $=y(I.action);return r.jsxs("tr",{style:{borderBottom:B<e.length-1?"1px solid #e5e7eb":"none"},children:[r.jsxs("td",{style:{padding:"12px",verticalAlign:"top"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#111827"},children:w(I.timestamp)}),r.jsx("div",{style:{fontSize:"12px",color:"var(--muted)"},children:C(I.timestamp)})]}),r.jsx("td",{style:{padding:"12px"},children:r.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#111827"},children:I.username})}),r.jsx("td",{style:{padding:"12px"},children:r.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",backgroundColor:$.bg,color:$.color},children:I.action})}),r.jsx("td",{style:{padding:"12px"},children:r.jsx("span",{style:{fontSize:"14px",color:"var(--muted)"},children:I.details||"-"})}),r.jsx("td",{style:{padding:"12px"},children:r.jsx("span",{style:{fontSize:"14px",color:"var(--muted)",fontFamily:"monospace"},children:I.ipAddress||"-"})})]},I.id)})})]})})})]})}const Bo="https://field-service-api.azurewebsites.net/api",Vy=()=>{const[e,t]=P.useState([]),[i,s]=P.useState(!0),[a,c]=P.useState(null),[d,p]=P.useState(!1),[m,g]=P.useState(null),[_,j]=P.useState({companyCode:"",companyName:"",displayName:"",contactEmail:"",contactPhone:"",address:"",isActive:!0,allowServiceRequests:!0,adminUsername:"",adminEmail:"",adminFullName:"",adminPassword:""});P.useEffect(()=>{b()},[]);const b=async()=>{try{s(!0);const f=localStorage.getItem("authToken"),w=await fetch(`${Bo}/companies`,{headers:{Authorization:`Bearer ${f}`}});if(!w.ok)throw new Error("Failed to load companies");const C=await w.json();t(C),c(null)}catch(f){c(f.message),console.error("Error loading companies:",f)}finally{s(!1)}},D=async f=>{f.preventDefault();try{const w=localStorage.getItem("authToken"),C=m?`${Bo}/companies/${m.CompanyCode}`:`${Bo}/companies`,z=await fetch(C,{method:m?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify(_)});if(!z.ok){const I=await z.json();throw new Error(I.error||"Failed to save company")}await b(),O(),p(!1)}catch(w){c(w.message),console.error("Error saving company:",w)}},k=f=>{g(f),j({companyCode:f.CompanyCode,companyName:f.CompanyName,displayName:f.DisplayName||f.CompanyName,contactEmail:f.ContactEmail||"",contactPhone:f.ContactPhone||"",address:f.Address||"",isActive:f.IsActive,allowServiceRequests:f.AllowServiceRequests,adminUsername:"",adminEmail:"",adminFullName:"",adminPassword:""}),p(!0)},A=async f=>{try{const w=localStorage.getItem("authToken");if(!(await fetch(`${Bo}/companies/${f.CompanyCode}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify({...f,companyName:f.CompanyName,displayName:f.DisplayName,contactEmail:f.ContactEmail,contactPhone:f.ContactPhone,address:f.Address,isActive:!f.IsActive,allowServiceRequests:f.AllowServiceRequests})})).ok)throw new Error("Failed to update company");await b()}catch(w){c(w.message),console.error("Error toggling company status:",w)}},O=()=>{j({companyCode:"",companyName:"",displayName:"",contactEmail:"",contactPhone:"",address:"",isActive:!0,allowServiceRequests:!0,adminUsername:"",adminEmail:"",adminFullName:"",adminPassword:""}),g(null)},S=()=>{O(),p(!1)};return i?r.jsx("div",{className:"company-management-loading",children:"Loading companies..."}):r.jsxs("div",{className:"company-management-page",children:[r.jsxs("div",{className:"company-management-header",children:[r.jsx("h1",{children:"🏢 Company Management"}),r.jsx("button",{className:"btn-primary",onClick:()=>{O(),p(!0)},children:"➕ Add New Company"})]}),a&&r.jsxs("div",{className:"error-message",children:["⚠️ ",a]}),d&&r.jsx("div",{className:"company-form-modal",children:r.jsxs("div",{className:"company-form-card",children:[r.jsx("h2",{children:m?"Edit Company":"Add New Company"}),r.jsxs("form",{onSubmit:D,children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Company Code *"}),r.jsx("input",{type:"text",value:_.companyCode,onChange:f=>j({..._,companyCode:f.target.value.toUpperCase()}),required:!0,disabled:!!m,placeholder:"e.g., ACME",maxLength:50}),r.jsx("small",{children:"Unique identifier (uppercase, no spaces)"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Company Name *"}),r.jsx("input",{type:"text",value:_.companyName,onChange:f=>j({..._,companyName:f.target.value}),required:!0,placeholder:"e.g., ACME Corporation"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Display Name"}),r.jsx("input",{type:"text",value:_.displayName,onChange:f=>j({..._,displayName:f.target.value}),placeholder:"Public-facing name for service requests"}),r.jsx("small",{children:"Leave blank to use Company Name"})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Contact Email"}),r.jsx("input",{type:"email",value:_.contactEmail,onChange:f=>j({..._,contactEmail:f.target.value}),placeholder:"support@company.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Contact Phone"}),r.jsx("input",{type:"tel",value:_.contactPhone,onChange:f=>j({..._,contactPhone:f.target.value}),placeholder:"(555) 123-4567"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Address"}),r.jsx("textarea",{value:_.address,onChange:f=>j({..._,address:f.target.value}),placeholder:"Company address",rows:2})]}),!m&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-section-divider",children:[r.jsx("h3",{children:"👤 Initial Admin User"}),r.jsx("small",{children:"Create the first administrator account for this company"})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Admin Username *"}),r.jsx("input",{type:"text",value:_.adminUsername,onChange:f=>j({..._,adminUsername:f.target.value}),required:!0,placeholder:"admin.username"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Admin Email *"}),r.jsx("input",{type:"email",value:_.adminEmail,onChange:f=>j({..._,adminEmail:f.target.value}),required:!0,placeholder:"admin@company.com"})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Admin Full Name *"}),r.jsx("input",{type:"text",value:_.adminFullName,onChange:f=>j({..._,adminFullName:f.target.value}),required:!0,placeholder:"John Doe"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Admin Password *"}),r.jsx("input",{type:"password",value:_.adminPassword,onChange:f=>j({..._,adminPassword:f.target.value}),required:!0,minLength:8,placeholder:"Minimum 8 characters"})]})]})]}),r.jsxs("div",{className:"form-checkboxes",children:[r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:_.isActive,onChange:f=>j({..._,isActive:f.target.checked})}),"Active"]}),r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:_.allowServiceRequests,onChange:f=>j({..._,allowServiceRequests:f.target.checked})}),"Allow Service Requests"]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:S,children:"Cancel"}),r.jsx("button",{type:"submit",className:"btn-primary",children:m?"Update Company":"Create Company"})]})]})]})}),r.jsx("div",{className:"companies-table-container",children:r.jsxs("table",{className:"companies-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Code"}),r.jsx("th",{children:"Company Name"}),r.jsx("th",{children:"Display Name"}),r.jsx("th",{children:"Contact Email"}),r.jsx("th",{children:"Contact Phone"}),r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Service Requests"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:8,style:{textAlign:"center",padding:"2rem"},children:"No companies found. Add your first company to get started."})}):e.map(f=>r.jsxs("tr",{className:f.IsActive?"":"inactive-row",children:[r.jsx("td",{children:r.jsx("strong",{children:f.CompanyCode})}),r.jsx("td",{children:f.CompanyName}),r.jsx("td",{children:f.DisplayName||f.CompanyName}),r.jsx("td",{children:f.ContactEmail||"-"}),r.jsx("td",{children:f.ContactPhone||"-"}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${f.IsActive?"status-active":"status-inactive"}`,children:f.IsActive?"✓ Active":"✗ Inactive"})}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${f.AllowServiceRequests?"status-enabled":"status-disabled"}`,children:f.AllowServiceRequests?"✓ Enabled":"✗ Disabled"})}),r.jsx("td",{children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-icon",onClick:()=>k(f),title:"Edit company",children:"✏️"}),f.CompanyCode!=="DCPSP"&&r.jsx("button",{className:"btn-icon",onClick:()=>A(f),title:f.IsActive?"Deactivate":"Activate",children:f.IsActive?"🔒":"🔓"})]})})]},f.CompanyCode))})]})}),r.jsxs("div",{className:"company-stats",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-value",children:e.length}),r.jsx("div",{className:"stat-label",children:"Total Companies"})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-value",children:e.filter(f=>f.IsActive).length}),r.jsx("div",{className:"stat-label",children:"Active"})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-value",children:e.filter(f=>f.AllowServiceRequests).length}),r.jsx("div",{className:"stat-label",children:"Accepting Requests"})]})]})]})};function qy({currentUser:e,tab:t,setTab:i,onLogout:s,newRequestsCount:a}){const c=async()=>{if(!e)return;const m=prompt("Enter your new password:");if(!m)return;const g=prompt("Confirm your new password:");if(g){if(m!==g){alert("Passwords do not match!");return}try{await Ft.changePassword(e.id,m),alert("Password changed successfully!")}catch(_){alert(`Failed to change password: ${_}`)}}},p=(()=>{if(!e)return[];const m=["Tickets","Map"];return e.role==="SystemAdmin"?["Tickets","Map","Calendar","Reports","Closed","Requests","Users","Companies","Activity","Customers","Sites","Licenses","Vendors"]:e.role==="Admin"?["Tickets","Map","Calendar","Reports","Closed","Requests","Users","Activity","Customers","Sites","Licenses","Vendors"]:e.role==="Coordinator"?["Tickets","Map","Calendar","Reports","Closed","Requests","Activity","Customers","Sites","Licenses","Vendors"]:e.role==="Technician"?["Tickets","Map","Calendar"]:m})();return r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("div",{className:"row",style:{margin:0},children:p.map(m=>r.jsxs("button",{className:t===m?"primary":"ghost",onClick:()=>i(m),style:{position:"relative"},children:[m,m==="Requests"&&a>0&&r.jsx("span",{style:{position:"absolute",top:"-8px",right:"-8px",backgroundColor:"#e74c3c",color:"white",borderRadius:"10px",padding:"2px 6px",fontSize:"11px",fontWeight:"bold",minWidth:"20px",textAlign:"center"},children:a})]},m))}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[r.jsxs("span",{style:{color:"#666",fontSize:"0.9rem"},children:["Welcome, ",e==null?void 0:e.fullName," (",e==null?void 0:e.role,")"]}),r.jsx("button",{className:"ghost",onClick:c,style:{padding:"0.5rem 1rem"},children:"Change Password"}),r.jsx("button",{className:"ghost",onClick:s,style:{padding:"0.5rem 1rem"},children:"Logout"})]})]})}const Ja="https://field-service-api.azurewebsites.net/api";function Ga(){const e={"Content-Type":"application/json"},t=localStorage.getItem("authToken");t&&(e.Authorization=`Bearer ${t}`);const i=localStorage.getItem("sqlUser");if(i)try{const s=JSON.parse(i);s.id&&(e["x-user-id"]=s.id,e["x-user-name"]=s.username||s.fullName||"",e["x-user-role"]=s.role||"")}catch{console.warn("Failed to parse sqlUser from localStorage")}return e}async function Ka(e){if(!e.ok){const t=await e.text();throw new Error(t||`HTTP ${e.status}`)}return e.json()}const Pr={async getCustomers(){console.log("CustomerApiService.getCustomers: Fetching all customers");try{const e=await fetch(`${Ja}/customers`,{headers:Ga()});return await Ka(e)}catch(e){throw console.error("CustomerApiService.getCustomers: Error -",e),e}},async createCustomer(e){console.log("CustomerApiService.createCustomer: Creating customer -",e.Name);try{const t=await fetch(`${Ja}/customers`,{method:"POST",headers:Ga(),body:JSON.stringify(e)});await Ka(t),console.log("CustomerApiService.createCustomer: Successfully created customer")}catch(t){throw console.error("CustomerApiService.createCustomer: Error -",t),t}},async updateCustomer(e,t){console.log("CustomerApiService.updateCustomer: Updating customer -",e);try{const i=await fetch(`${Ja}/customers/${e}`,{method:"PUT",headers:Ga(),body:JSON.stringify(t)});await Ka(i),console.log("CustomerApiService.updateCustomer: Successfully updated customer")}catch(i){throw console.error("CustomerApiService.updateCustomer: Error -",i),i}}};function Jy({customer:e,isOpen:t,onClose:i,onSave:s,onDelete:a}){const[c,d]=P.useState(null),[p,m]=P.useState(!1),[g,_]=P.useState(!1);P.useEffect(()=>{e&&t&&d({...e})},[e,t]);function j(k,A){c&&d(O=>O?{...O,[k]:A}:null)}async function b(){if(c)try{m(!0),await s(c),i()}catch(k){console.error("Error saving customer:",k)}finally{m(!1)}}async function D(){if(c&&confirm(`Are you sure you want to delete customer "${c.Name}"? This action cannot be undone and may affect related tickets and licenses.`))try{_(!0),await a(c.CustomerID,c.Name),i()}catch(k){console.error("Error deleting customer:",k)}finally{_(!1)}}return!t||!c?null:r.jsx("div",{className:"modal-overlay",onClick:i,children:r.jsxs("div",{className:"modal-content",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Edit Customer"}),r.jsx("button",{className:"modal-close",onClick:i,children:"×"})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("div",{className:"grid",children:[r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Customer ID"}),r.jsx("input",{type:"text",value:c.CustomerID,disabled:!0,style:{backgroundColor:"#f5f5f5"}})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Customer Name *"}),r.jsx("input",{required:!0,value:c.Name||"",onChange:k=>j("Name",k.target.value),placeholder:"Enter customer name"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Contact Name"}),r.jsx("input",{value:c.Contact||"",onChange:k=>j("Contact",k.target.value),placeholder:"Primary contact person"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Phone"}),r.jsx("input",{type:"tel",value:c.Phone||"",onChange:k=>j("Phone",k.target.value),placeholder:"(555) 123-4567"})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:c.Email||"",onChange:k=>j("Email",k.target.value),placeholder:"contact@company.com"})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Address"}),r.jsx("textarea",{value:c.Address||"",onChange:k=>j("Address",k.target.value),placeholder:"Street address, city, state, zip",rows:3})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Notes"}),r.jsx("textarea",{value:c.Notes||"",onChange:k=>j("Notes",k.target.value),placeholder:"Additional notes about this customer...",rows:3})]})]})}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{onClick:D,className:"btn",style:{backgroundColor:"#dc3545"},disabled:g||p,children:g?"Deleting...":"Delete Customer"}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:i,className:"btn",style:{backgroundColor:"#666"},children:"Cancel"}),r.jsx("button",{onClick:b,className:"btn",disabled:p||g||!c.Name,children:p?"Saving...":"Save Changes"})]})]})]})})}function Gy(){const[e,t]=P.useState([]),[i,s]=P.useState({Name:""}),[a,c]=P.useState(!0),[d,p]=P.useState(null),[m,g]=P.useState(!1),[_,j]=P.useState("");async function b(){c(!0);try{t(await Pr.getCustomers())}catch(y){console.error("Failed to load customers:",y)}finally{c(!1)}}P.useEffect(()=>{b()},[]);function D(y,z){s(I=>({...I,[y]:z}))}async function k(y){y.preventDefault();try{await Pr.createCustomer(i),s({Name:""}),b()}catch(z){console.error("Failed to save customer:",z),alert("Failed to save customer: "+z.message)}}function A(y){p({...y}),g(!0)}function O(){p(null),g(!1)}async function S(y){try{await Pr.updateCustomer(y.CustomerID,y),b()}catch(z){throw console.error("Failed to update customer:",z),z}}async function f(y,z){try{throw new Error("Delete functionality not yet implemented")}catch(I){throw console.error("Failed to delete customer:",I),I}}const w=P.useMemo(()=>{if(!_)return e;const y=_.toLowerCase();return e.filter(z=>[z.Name,z.Contact,z.Phone,z.Email].filter(Boolean).join(" ").toLowerCase().includes(y))},[e,_]),C=()=>{ri(w,[{key:"CustomerID",label:"Customer ID"},{key:"Name",label:"Name"},{key:"Contact",label:"Contact"},{key:"Email",label:"Email"},{key:"Phone",label:"Phone"},{key:"Address",label:"Address"},{key:"Notes",label:"Notes"}],"customers")};return r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",marginBottom:8},children:r.jsxs("div",{className:"title",children:["Customers ",a&&r.jsx("span",{className:"muted",children:"Loading…"})]})}),r.jsxs("form",{className:"grid",onSubmit:k,children:[r.jsxs("div",{className:"col-4",children:[r.jsx("label",{children:"Name"}),r.jsx("input",{required:!0,value:i.Name||"",onChange:y=>D("Name",y.target.value)})]}),r.jsxs("div",{className:"col-4",children:[r.jsx("label",{children:"Contact"}),r.jsx("input",{value:i.Contact||"",onChange:y=>D("Contact",y.target.value)})]}),r.jsxs("div",{className:"col-4",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{value:i.Email||"",onChange:y=>D("Email",y.target.value)})]}),r.jsxs("div",{className:"col-4",children:[r.jsx("label",{children:"Phone"}),r.jsx("input",{value:i.Phone||"",onChange:y=>D("Phone",y.target.value)})]}),r.jsxs("div",{className:"col-8",children:[r.jsx("label",{children:"Address"}),r.jsx("input",{value:i.Address||"",onChange:y=>D("Address",y.target.value)})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Notes"}),r.jsx("textarea",{value:i.Notes||"",onChange:y=>D("Notes",y.target.value)})]}),r.jsx("div",{className:"col-12",style:{display:"flex",gap:12,justifyContent:"flex-end"},children:r.jsx("button",{className:"primary",children:"Create Customer"})})]}),r.jsxs("div",{className:"row",style:{gap:8,margin:"16px 0 12px 0"},children:[r.jsx("div",{style:{flex:"1 1 200px"},children:r.jsx("input",{placeholder:"🔍 Search customers...",value:_,onChange:y=>j(y.target.value)})}),r.jsx("div",{children:r.jsx("button",{className:"primary",onClick:C,style:{padding:"8px 16px"},title:`Export ${w.length} customers to CSV`,children:"📊 Export CSV"})})]}),r.jsx("div",{style:{marginBottom:10},children:r.jsxs("strong",{children:[w.length," of ",e.length," customers ",_?"match search":"found"]})}),r.jsxs("table",{style:{marginTop:12},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Contact"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Phone"}),r.jsx("th",{children:"Address"}),r.jsx("th",{children:"Actions"})]})}),r.jsxs("tbody",{children:[w.map(y=>r.jsxs("tr",{children:[r.jsx("td",{children:y.Name}),r.jsx("td",{children:y.Contact}),r.jsx("td",{children:y.Email}),r.jsx("td",{children:y.Phone}),r.jsx("td",{className:"muted",children:y.Address}),r.jsx("td",{children:r.jsx("button",{className:"ghost small",onClick:()=>A(y),style:{padding:"4px 8px",fontSize:"0.875rem"},children:"Edit"})})]},y.CustomerID)),e.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"muted",children:"No customers yet."})})]})]}),r.jsx(Jy,{customer:d,isOpen:m,onClose:O,onSave:S,onDelete:f})]})}const Fo="https://field-service-api.azurewebsites.net/api";class Ky{getHeaders(){const t={"Content-Type":"application/json"},i=localStorage.getItem("authToken");i&&(t.Authorization=`Bearer ${i}`);const s=localStorage.getItem("sqlUser");if(s)try{const a=JSON.parse(s);a.id&&(t["x-user-id"]=a.id,t["x-user-name"]=a.username||a.fullName||"",t["x-user-role"]=a.role||"")}catch{console.warn("Failed to parse sqlUser from localStorage")}return t}async getSites(){try{console.log("🏢 Fetching sites...");const t=await fetch(`${Fo}/sites`,{headers:this.getHeaders()});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const i=await t.json();return console.log(`✅ Retrieved ${i.length} sites`),i}catch(t){throw console.error("❌ Error fetching sites:",t),t}}async createSite(t){try{console.log("🏢 Creating site:",t.Site);const i=await fetch(`${Fo}/sites`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(t)});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const s=await i.json();return console.log("✅ Site created:",s.SiteID),s}catch(i){throw console.error("❌ Error creating site:",i),i}}async updateSite(t,i){try{console.log("🏢 Updating site:",t);const s=await fetch(`${Fo}/sites/${t}`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(i)});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();return console.log("✅ Site updated:",a.SiteID),a}catch(s){throw console.error("❌ Error updating site:",s),s}}async deleteSite(t){try{console.log("🏢 Deleting site:",t);const i=await fetch(`${Fo}/sites/${t}`,{method:"DELETE"});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);console.log("✅ Site deleted:",t)}catch(i){throw console.error("❌ Error deleting site:",i),i}}}const Ni=new Ky;function Yy({site:e,customers:t,isOpen:i,onClose:s,onSave:a,onDelete:c}){const[d,p]=P.useState(null),[m,g]=P.useState(!1),[_,j]=P.useState(!1);P.useEffect(()=>{e&&i&&p({...e})},[e,i]);function b(A,O){d&&p(S=>S?{...S,[A]:O}:null)}async function D(){if(d)try{g(!0),await a(d),s()}catch(A){console.error("Error saving site:",A)}finally{g(!1)}}async function k(){if(d!=null&&d.SiteID&&confirm(`Are you sure you want to delete site "${d.Site}" for ${d.Customer}? This action cannot be undone and may affect related tickets and licenses.`))try{j(!0),await c(d.SiteID,d.Site),s()}catch(A){console.error("Error deleting site:",A)}finally{j(!1)}}return!i||!d?null:r.jsx("div",{className:"modal-overlay",onClick:s,children:r.jsxs("div",{className:"modal-content",onClick:A=>A.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Edit Site"}),r.jsx("button",{className:"modal-close",onClick:s,children:"×"})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("div",{className:"grid",children:[r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Site ID"}),r.jsx("input",{type:"text",value:d.SiteID,disabled:!0,style:{backgroundColor:"#f5f5f5"}})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Customer *"}),r.jsxs("select",{required:!0,value:d.Customer,onChange:A=>b("Customer",A.target.value),children:[r.jsx("option",{value:"",children:"— Select Customer —"}),t.map(A=>r.jsx("option",{value:A.Name,children:A.Name},A.CustomerID))]})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Site Name *"}),r.jsx("input",{required:!0,value:d.Site||"",onChange:A=>b("Site",A.target.value),placeholder:"Enter site name"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Contact Name"}),r.jsx("input",{value:d.ContactName||"",onChange:A=>b("ContactName",A.target.value),placeholder:"Site contact person"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Phone"}),r.jsx("input",{type:"tel",value:d.ContactPhone||"",onChange:A=>b("ContactPhone",A.target.value),placeholder:"(555) 123-4567"})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Address"}),r.jsx("textarea",{value:d.Address||"",onChange:A=>b("Address",A.target.value),placeholder:"Street address, city, state, zip",rows:3})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"GeoLocation (Latitude, Longitude)"}),r.jsx("input",{type:"text",value:d.GeoLocation||"",onChange:A=>b("GeoLocation",A.target.value),placeholder:"40.7128,-74.0060"}),r.jsx("small",{style:{color:"#888",fontSize:"12px",display:"block",marginTop:"4px"},children:"Format: latitude,longitude (e.g., 40.7128,-74.0060)"})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Notes"}),r.jsx("textarea",{value:d.Notes||"",onChange:A=>b("Notes",A.target.value),placeholder:"Additional notes about this site...",rows:3})]})]})}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{onClick:k,className:"btn",style:{backgroundColor:"#dc3545"},disabled:_||m,children:_?"Deleting...":"Delete Site"}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:s,className:"btn",style:{backgroundColor:"#666"},children:"Cancel"}),r.jsx("button",{onClick:D,className:"btn",disabled:m||_||!d.Customer||!d.Site,children:m?"Saving...":"Save Changes"})]})]})]})})}const mh={search:"",customer:"All"};function Qy(){const[e,t]=P.useState([]),[i,s]=P.useState([]),[a,c]=P.useState({CustomerID:"",Site:""}),[d,p]=P.useState(null),[m,g]=P.useState(!1),[_,j]=P.useState(mh);async function b(){t(await Ni.getSites()),s(await Pr.getCustomers())}P.useEffect(()=>{b()},[]);function D($,H){c(U=>({...U,[$]:H}))}async function k($){$.preventDefault();try{console.log("🏢 Creating new site:",a),await Ni.createSite(a),c({CustomerID:"",Site:""}),b()}catch(H){console.error("❌ Error saving site:",H),alert("Error saving site: "+(H instanceof Error?H.message:"Unknown error"))}}function A($){p({...$}),g(!0)}function O(){p(null),g(!1)}async function S($){try{$.SiteID&&(console.log("🏢 Updating site:",$.SiteID,$),await Ni.updateSite($.SiteID,$)),O(),await b()}catch(H){throw console.error("Failed to update site:",H),H}}async function f($,H){try{console.log("🏢 Deleting site:",$),await Ni.deleteSite($),console.log("✅ Site deleted successfully"),await b()}catch(U){throw console.error("Failed to delete site:",U),U}}const w=$=>{j(H=>({...H,...$}))},C=()=>j(mh),y=P.useMemo(()=>{const $=new Set;return e.forEach(H=>{H.Customer&&$.add(H.Customer)}),Array.from($).sort()},[e]),z=P.useMemo(()=>{const $=_.search.toLowerCase();return e.filter(H=>!(_.customer!=="All"&&H.Customer!==_.customer||$&&![H.Site,H.Customer,H.Address,H.City,H.State,H.ContactName,H.ContactPhone].filter(Boolean).join(" ").toLowerCase().includes($)))},[e,_]),I=()=>{ri(z,[{key:"SiteID",label:"Site ID"},{key:"Customer",label:"Customer"},{key:"Site",label:"Site Name"},{key:"Address",label:"Address"},{key:"City",label:"City"},{key:"State",label:"State"},{key:"ZIP",label:"ZIP Code"},{key:"ContactName",label:"Contact Name"},{key:"ContactPhone",label:"Contact Phone"},{key:"ContactEmail",label:"Contact Email"},{key:"GeoLocation",label:"Geo Location"},{key:"Notes",label:"Notes"}],"sites")},B=_.search||_.customer!=="All";return r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"title",style:{marginBottom:8},children:"Sites"}),r.jsxs("form",{className:"grid",onSubmit:k,children:[r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Customer"}),r.jsxs("select",{required:!0,value:a.CustomerID||"",onChange:$=>D("CustomerID",$.target.value),children:[r.jsx("option",{value:"",children:"— Select —"}),i.map($=>r.jsx("option",{value:$.CustomerID,children:$.Name},$.CustomerID))]})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Site"}),r.jsx("input",{required:!0,value:a.Site||"",onChange:$=>D("Site",$.target.value)})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Address"}),r.jsx("input",{value:a.Address||"",onChange:$=>D("Address",$.target.value)})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Geolocation (Lat, Lng)"}),r.jsx("input",{placeholder:"e.g., 40.7128, -74.0060",value:a.GeoLocation||"",onChange:$=>D("GeoLocation",$.target.value)})]}),r.jsxs("div",{className:"col-3",children:[r.jsx("label",{children:"Contact Name"}),r.jsx("input",{value:a.ContactName||"",onChange:$=>D("ContactName",$.target.value)})]}),r.jsxs("div",{className:"col-3",children:[r.jsx("label",{children:"Contact Phone"}),r.jsx("input",{value:a.ContactPhone||"",onChange:$=>D("ContactPhone",$.target.value)})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Notes"}),r.jsx("textarea",{value:a.Notes||"",onChange:$=>D("Notes",$.target.value),rows:3})]}),r.jsx("div",{className:"col-12",style:{display:"flex",gap:12,justifyContent:"flex-end"},children:r.jsx("button",{className:"primary",children:"Create Site"})})]}),B&&r.jsxs("div",{style:{marginBottom:12,padding:8,background:"#17263f",borderRadius:4,border:"1px solid #2a3a5f"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[r.jsx("span",{style:{color:"#9fb3ff",fontSize:"14px"},children:"Active filters:"}),_.search&&r.jsxs("span",{style:{color:"#9fb3ff"},children:['Search: "',_.search,'"']}),_.customer!=="All"&&r.jsxs("span",{style:{color:"#79e2b6"},children:["Customer: ",_.customer]})]}),r.jsx("button",{onClick:C,style:{marginTop:4,background:"transparent",border:"1px solid #9fb3ff",color:"#9fb3ff",padding:"2px 8px",fontSize:"12px",borderRadius:3,cursor:"pointer"},title:"Clear all filters",children:"Clear All Filters"})]}),r.jsxs("div",{className:"row",style:{gap:8,margin:"16px 0 12px 0"},children:[r.jsx("div",{style:{flex:"1 1 200px"},children:r.jsx("input",{placeholder:"🔍 Search sites...",value:_.search,onChange:$=>w({search:$.target.value})})}),r.jsx("div",{style:{flex:"0 0 180px"},children:r.jsxs("select",{value:_.customer,onChange:$=>w({customer:$.target.value}),children:[r.jsx("option",{value:"All",children:"Customer (All)"}),y.map($=>r.jsx("option",{value:$,children:$},$))]})}),r.jsx("div",{children:r.jsx("button",{className:"primary",onClick:I,style:{padding:"8px 16px"},title:`Export ${z.length} sites to CSV`,children:"📊 Export CSV"})})]}),r.jsx("div",{style:{marginBottom:10},children:r.jsxs("strong",{children:[z.length," of ",e.length," sites ",B?"match filters":"found"]})}),r.jsxs("table",{style:{marginTop:12},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Customer"}),r.jsx("th",{children:"Site"}),r.jsx("th",{children:"Address"}),r.jsx("th",{children:"Contact"}),r.jsx("th",{children:"Phone"}),r.jsx("th",{children:"GeoLocation"}),r.jsx("th",{children:"Actions"})]})}),r.jsxs("tbody",{children:[z.map($=>r.jsxs("tr",{children:[r.jsx("td",{children:$.Customer}),r.jsx("td",{children:$.Site}),r.jsx("td",{className:"muted",children:$.Address}),r.jsx("td",{children:$.ContactName}),r.jsx("td",{children:$.ContactPhone}),r.jsx("td",{className:"muted",style:{fontSize:"12px"},children:$.GeoLocation||"Not set"}),r.jsx("td",{children:r.jsx("button",{className:"ghost",onClick:()=>A($),style:{fontSize:"12px",padding:"4px 8px"},children:"Edit"})})]},$.Customer+"|"+$.Site)),e.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"muted",children:"No sites yet."})})]})]}),r.jsx(Yy,{site:d,customers:i,isOpen:m,onClose:O,onSave:S,onDelete:f})]})}async function gh(){return console.log("api-sql-license.listLicenses: Fetching licenses from SQL database"),await pt.getLicenses()}async function Xy(e){return console.log("api-sql-license.createLicense: Creating license with data:",e),await pt.createLicense(e)}async function vh(e,t){return console.log("api-sql-license.updateLicense: Updating license:",e,t),await pt.updateLicense(e,t)}async function e_(e){return console.log("api-sql-license.deleteLicense: Deleting license:",e),await pt.deleteLicense(e)}function t_({license:e,customers:t,sites:i,isOpen:s,onClose:a,onSave:c,onDelete:d}){const[p,m]=P.useState(null),[g,_]=P.useState(!1),[j,b]=P.useState(!1);P.useEffect(()=>{e&&s&&m({...e})},[e,s]);const D=i.filter(f=>!(p!=null&&p.Customer)||f.Customer===p.Customer);function k(f,w){p&&(m(C=>C?{...C,[f]:w}:null),f==="Customer"&&m(C=>C?{...C,Site:""}:null))}async function A(){if(p)try{_(!0),await c(p),a()}catch(f){console.error("Error saving license:",f)}finally{_(!1)}}async function O(){if(p&&confirm(`Are you sure you want to delete the license for "${p.SoftwareName}"? This action cannot be undone.`))try{b(!0),await d(p.LicenseID,p.SoftwareName),a()}catch(f){console.error("Error deleting license:",f)}finally{b(!1)}}if(!s||!p)return null;const S=!p.LicenseID||p.LicenseID==="";return r.jsx("div",{className:"modal-overlay",onClick:a,children:r.jsxs("div",{className:"modal-content",onClick:f=>f.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:S?"Add New License":"Edit License"}),r.jsx("button",{className:"modal-close",onClick:a,children:"×"})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("div",{className:"grid",children:[!S&&r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"License ID"}),r.jsx("input",{type:"text",value:p.LicenseID,disabled:!0,style:{backgroundColor:"#f5f5f5"}})]}),r.jsxs("div",{className:S?"col-12":"col-6",children:[r.jsx("label",{children:"Status *"}),r.jsxs("select",{required:!0,value:p.Status||"Active",onChange:f=>k("Status",f.target.value),children:[r.jsx("option",{value:"Active",children:"Active"}),r.jsx("option",{value:"Expired",children:"Expired"}),r.jsx("option",{value:"Inactive",children:"Inactive"})]})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Customer *"}),r.jsxs("select",{required:!0,value:p.Customer,onChange:f=>k("Customer",f.target.value),autoComplete:"off",children:[r.jsx("option",{value:"",children:"— Select Customer —"}),t.map(f=>r.jsx("option",{value:f.Name,children:f.Name},f.CustomerID))]})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Site *"}),r.jsxs("select",{required:!0,value:p.Site,onChange:f=>k("Site",f.target.value),autoComplete:"off",children:[r.jsx("option",{value:"",children:"— Select Site —"}),D.map(f=>r.jsx("option",{value:f.Site,children:f.Site},f.Customer+"|"+f.Site))]})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Software Name *"}),r.jsx("input",{required:!0,value:p.SoftwareName,onChange:f=>k("SoftwareName",f.target.value),placeholder:"Microsoft Office, Adobe CC, etc."})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Software Version"}),r.jsx("input",{value:p.SoftwareVersion||"",onChange:f=>k("SoftwareVersion",f.target.value),placeholder:"2024, v12.1, etc."})]}),r.jsxs("div",{className:"col-4",children:[r.jsx("label",{children:"License Type *"}),r.jsxs("select",{required:!0,value:p.LicenseType,onChange:f=>k("LicenseType",f.target.value),children:[r.jsx("option",{value:"Subscription",children:"Subscription"}),r.jsx("option",{value:"Perpetual",children:"Perpetual"}),r.jsx("option",{value:"Term",children:"Term"}),r.jsx("option",{value:"Trial",children:"Trial"})]})]}),r.jsxs("div",{className:"col-4",children:[r.jsx("label",{children:"License Count *"}),r.jsx("input",{type:"number",min:"1",required:!0,value:p.LicenseCount||1,onChange:f=>k("LicenseCount",parseInt(f.target.value)||1)})]}),r.jsxs("div",{className:"col-4",children:[r.jsx("label",{children:"Used Count"}),r.jsx("input",{type:"number",min:"0",value:p.UsedCount||0,onChange:f=>k("UsedCount",parseInt(f.target.value)||0)})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Expiration Date"}),r.jsx("input",{type:"date",value:p.ExpirationDate?p.ExpirationDate.split("T")[0]:"",onChange:f=>k("ExpirationDate",f.target.value)})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Vendor"}),r.jsx("input",{value:p.Vendor||"",onChange:f=>k("Vendor",f.target.value),placeholder:"Microsoft, Adobe, etc."})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Service Plan"}),r.jsx("input",{value:p.ServicePlan||"",onChange:f=>k("ServicePlan",f.target.value),placeholder:"Standard Support, Premium, etc."})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Service Plan Expiration"}),r.jsx("input",{type:"date",value:p.ServicePlanExpiration?p.ServicePlanExpiration.split("T")[0]:"",onChange:f=>k("ServicePlanExpiration",f.target.value)})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Notes"}),r.jsx("textarea",{value:p.Notes||"",onChange:f=>k("Notes",f.target.value),placeholder:"Additional notes about this license...",rows:3})]})]})}),r.jsxs("div",{className:"modal-footer",children:[!S&&r.jsx("button",{onClick:O,className:"btn",style:{backgroundColor:"#dc3545"},disabled:j||g,children:j?"Deleting...":"Delete License"}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:a,className:"btn",style:{backgroundColor:"#666"},children:"Cancel"}),r.jsx("button",{onClick:A,className:"btn",disabled:g||j||!p.Customer||!p.Site||!p.SoftwareName,children:g?S?"Creating...":"Saving...":S?"Create License":"Save Changes"})]})]})]})})}const xh={search:"",customer:"All",site:"All",status:"All",vendor:"All",softwareType:"All"};function n_(){const[e,t]=P.useState([]),[i,s]=P.useState([]),[a,c]=P.useState([]),[d,p]=P.useState(null),[m,g]=P.useState(!1),[_,j]=P.useState(xh),[b,D]=P.useState({Customer:"",Site:"",SoftwareName:"",LicenseType:"Subscription",Status:"Active"});async function k(){try{console.log("LicensesPage.refresh: Loading licenses, sites, and customers...");const[T,v,E]=await Promise.all([gh(),Ni.getSites(),Pr.getCustomers()]);if(await I(T)){console.log("LicensesPage.refresh: Reloading licenses after status updates...");const Z=await gh();t(Z)}else t(T);s(v),c(E),console.log("LicensesPage.refresh: Loaded",T.length,"licenses")}catch(T){console.error("LicensesPage.refresh: Error loading data:",T)}}P.useEffect(()=>{k()},[]),i.filter(T=>!b.Customer||T.Customer===b.Customer);function A(T){p({...T}),g(!0)}function O(){p({LicenseID:"",Customer:"",Site:"",SoftwareName:"",SoftwareVersion:"",LicenseType:"Subscription",LicenseCount:1,UsedCount:0,Vendor:"",Status:"Active"}),g(!0)}function S(){p(null),g(!1)}async function f(T){try{!T.LicenseID||T.LicenseID===""?(console.log("LicensesPage.saveEdit: Creating new license:",T.SoftwareName),await Xy(T)):(console.log("LicensesPage.saveEdit: Updating license:",T.LicenseID),await vh(T.LicenseID,T)),k()}catch(v){throw console.error("LicensesPage.saveEdit: Error saving license:",v),alert("Error saving license: "+v.message),v}}async function w(T,v){try{console.log("LicensesPage.deleteLicenseHandler: Deleting license:",T),await e_(T),k()}catch(E){throw console.error("LicensesPage.deleteLicenseHandler: Error deleting license:",E),alert("Error deleting license: "+E.message),E}}const C=T=>{if(!T)return"N/A";try{return new Date(T).toLocaleDateString()}catch{return T}},y=(T,v)=>{const E=new Date,W=new Date(Date.now()+30*24*60*60*1e3);return T&&new Date(T)<E?"Expired":v&&new Date(v)<E?"Service Plan Expired":T&&new Date(T)<=W?"Expiring Soon":v&&new Date(v)<=W?"Service Plan Expiring":"Active"},z=(T,v,E)=>{if(T==="Inactive"||T==="Expired"||T==="Service Plan Expired")return"#ff4444";if(T==="Expiring Soon"||T==="Service Plan Expiring")return"#ff8800";const W=new Date(Date.now()+30*24*60*60*1e3);return v&&new Date(v)<=W||E&&new Date(E)<=W?"#ff8800":"#00aa44"},I=async T=>{const v=[];for(const E of T){if(E.Status==="Inactive")continue;const W=y(E.ExpirationDate,E.ServicePlanExpiration);if(E.Status!==W){console.log(`LicensesPage.updateLicenseStatuses: Updating status for ${E.SoftwareName} from '${E.Status}' to '${W}'`);const Z={...E,Status:W};v.push(vh(E.LicenseID,Z))}}if(v.length>0)try{return await Promise.all(v),console.log(`LicensesPage.updateLicenseStatuses: Updated ${v.length} license statuses`),!0}catch(E){return console.error("LicensesPage.updateLicenseStatuses: Error updating license statuses:",E),!1}return!1},B=T=>{j(v=>({...v,...T,...T.customer?{site:"All"}:null}))},$=()=>j(xh),H=P.useMemo(()=>{const T=new Set;return e.forEach(v=>{v.Customer&&T.add(v.Customer)}),Array.from(T).sort()},[e]),U=P.useMemo(()=>{const T=new Set;return e.forEach(v=>{(_.customer==="All"||v.Customer===_.customer)&&v.Site&&T.add(v.Site)}),Array.from(T).sort()},[e,_.customer]),F=P.useMemo(()=>{const T=new Set;return e.forEach(v=>{v.Vendor&&T.add(v.Vendor)}),Array.from(T).sort()},[e]),G=P.useMemo(()=>{const T=new Set;return e.forEach(v=>{v.Status&&T.add(v.Status)}),Array.from(T).sort()},[e]),K=P.useMemo(()=>{const T=new Set;return e.forEach(v=>{v.LicenseType&&T.add(v.LicenseType)}),Array.from(T).sort()},[e]),ne=P.useMemo(()=>{const T=_.search.toLowerCase();return e.filter(v=>!(_.customer!=="All"&&v.Customer!==_.customer||_.site!=="All"&&_.site&&v.Site!==_.site||_.status!=="All"&&y(v.ExpirationDate,v.ServicePlanExpiration)!==_.status||_.vendor!=="All"&&v.Vendor!==_.vendor||_.softwareType!=="All"&&v.LicenseType!==_.softwareType||T&&![v.SoftwareName,v.SoftwareVersion,v.Customer,v.Site,v.Vendor,v.ServicePlan,v.LicenseKey,v.LicenseType].filter(Boolean).join(" ").toLowerCase().includes(T)))},[e,_]),re=()=>{const T=[{key:"LicenseID",label:"License ID"},{key:"Customer",label:"Customer"},{key:"Site",label:"Site"},{key:"SoftwareName",label:"Software Name"},{key:"SoftwareVersion",label:"Version"},{key:"LicenseType",label:"License Type"},{key:"LicenseKey",label:"License Key"},{key:"Vendor",label:"Vendor"},{key:"Status",label:"Status"},{key:"ServicePlan",label:"Service Plan"},{key:"ExpirationDate",label:"Expiration Date"},{key:"ServicePlanExpiration",label:"Service Plan Expiration"},{key:"Cost",label:"Cost"},{key:"Notes",label:"Notes"}],v=ne.map(E=>({...E,Status:y(E.ExpirationDate,E.ServicePlanExpiration),ExpirationDate:Gt(E.ExpirationDate||""),ServicePlanExpiration:Gt(E.ServicePlanExpiration||"")}));ri(v,T,"software-licenses")},oe=_.search||_.customer!=="All"||_.site!=="All"||_.status!=="All"||_.vendor!=="All"||_.softwareType!=="All";return r.jsxs("div",{className:"card",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[r.jsx("div",{className:"title",children:"Software Licenses"}),r.jsx("button",{onClick:O,className:"btn",style:{fontSize:"14px",padding:"8px 16px",backgroundColor:"#00aa44"},children:"+ Add New License"})]}),oe&&r.jsxs("div",{style:{marginBottom:12,padding:8,background:"#17263f",borderRadius:4,border:"1px solid #2a3a5f"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[r.jsx("span",{style:{color:"#9fb3ff",fontSize:"14px"},children:"Active filters:"}),_.search&&r.jsxs("span",{style:{color:"#9fb3ff"},children:['Search: "',_.search,'"']}),_.customer!=="All"&&r.jsxs("span",{style:{color:"#79e2b6"},children:["Customer: ",_.customer]}),_.site!=="All"&&r.jsxs("span",{style:{color:"#79e2b6"},children:["Site: ",_.site]}),_.status!=="All"&&r.jsxs("span",{style:{color:"#ffc78a"},children:["Status: ",_.status]}),_.vendor!=="All"&&r.jsxs("span",{style:{color:"#ff9999"},children:["Vendor: ",_.vendor]}),_.softwareType!=="All"&&r.jsxs("span",{style:{color:"#d4a5ff"},children:["Type: ",_.softwareType]})]}),r.jsx("button",{onClick:$,style:{marginTop:4,background:"transparent",border:"1px solid #9fb3ff",color:"#9fb3ff",padding:"2px 8px",fontSize:"12px",borderRadius:3,cursor:"pointer"},title:"Clear all filters",children:"Clear All Filters"})]}),r.jsxs("div",{className:"row",style:{gap:8,marginBottom:12},children:[r.jsx("div",{style:{flex:"1 1 200px"},children:r.jsx("input",{placeholder:"🔍 Search licenses...",value:_.search,onChange:T=>B({search:T.target.value})})}),r.jsx("div",{style:{flex:"0 0 160px"},children:r.jsxs("select",{value:_.customer,onChange:T=>B({customer:T.target.value}),children:[r.jsx("option",{value:"All",children:"Customer (All)"}),H.map(T=>r.jsx("option",{value:T,children:T},T))]})}),r.jsx("div",{style:{flex:"0 0 160px"},children:r.jsxs("select",{value:_.site,onChange:T=>B({site:T.target.value}),children:[r.jsx("option",{value:"All",children:"Site (All)"}),U.map(T=>r.jsx("option",{value:T,children:T},T))]})}),r.jsx("div",{style:{flex:"0 0 140px"},children:r.jsxs("select",{value:_.status,onChange:T=>B({status:T.target.value}),children:[r.jsx("option",{value:"All",children:"Status (All)"}),G.map(T=>r.jsx("option",{value:T,children:T},T))]})}),r.jsx("div",{style:{flex:"0 0 140px"},children:r.jsxs("select",{value:_.vendor,onChange:T=>B({vendor:T.target.value}),children:[r.jsx("option",{value:"All",children:"Vendor (All)"}),F.map(T=>r.jsx("option",{value:T,children:T},T))]})}),r.jsx("div",{style:{flex:"0 0 140px"},children:r.jsxs("select",{value:_.softwareType,onChange:T=>B({softwareType:T.target.value}),children:[r.jsx("option",{value:"All",children:"Type (All)"}),K.map(T=>r.jsx("option",{value:T,children:T},T))]})}),r.jsx("div",{children:r.jsx("button",{className:"primary",onClick:re,style:{padding:"8px 16px"},title:`Export ${ne.length} licenses to CSV`,children:"📊 Export CSV"})})]}),r.jsxs("div",{style:{marginBottom:10,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("strong",{children:[ne.length," of ",e.length," licenses ",oe?"match filters":"found"]}),r.jsx("button",{onClick:async()=>{console.log("Manual status update triggered"),await I(e)?k():console.log("No status updates needed")},className:"btn",style:{fontSize:"12px",padding:"4px 8px"},children:"Update Statuses"})]}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Customer"}),r.jsx("th",{children:"Site"}),r.jsx("th",{children:"Software"}),r.jsx("th",{children:"Version"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Count"}),r.jsx("th",{children:"Used"}),r.jsx("th",{children:"Expires"}),r.jsx("th",{children:"Service Plan"}),r.jsx("th",{children:"SP Expires"}),r.jsx("th",{children:"Vendor"}),r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:ne.map(T=>r.jsxs("tr",{children:[r.jsx("td",{children:T.Customer}),r.jsx("td",{children:T.Site}),r.jsx("td",{children:T.SoftwareName}),r.jsx("td",{children:T.SoftwareVersion||"N/A"}),r.jsx("td",{children:T.LicenseType}),r.jsx("td",{children:T.LicenseCount}),r.jsx("td",{children:T.UsedCount||0}),r.jsx("td",{children:C(T.ExpirationDate)}),r.jsx("td",{children:T.ServicePlan||"N/A"}),r.jsx("td",{children:C(T.ServicePlanExpiration)}),r.jsx("td",{children:T.Vendor||"N/A"}),r.jsx("td",{children:r.jsx("span",{style:{color:z(T.Status||"Active",T.ExpirationDate,T.ServicePlanExpiration),fontWeight:"bold"},children:T.Status||y(T.ExpirationDate,T.ServicePlanExpiration)})}),r.jsx("td",{children:r.jsx("div",{style:{display:"flex",gap:"5px"},children:r.jsx("button",{onClick:()=>A(T),className:"btn",style:{fontSize:"12px",padding:"4px 8px"},children:"Edit"})})})]},T.LicenseID))})]})}),ne.length===0&&r.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#666"},children:e.length===0?"No licenses found. Add your first software license above.":"No licenses match the current filters. Try adjusting your search criteria."}),r.jsx(t_,{license:d,customers:a,sites:i,isOpen:m,onClose:S,onSave:f,onDelete:w})]})}const Uo="https://field-service-api.azurewebsites.net/api";class i_{getHeaders(){const t={"Content-Type":"application/json"},i=localStorage.getItem("authToken");i&&(t.Authorization=`Bearer ${i}`);const s=localStorage.getItem("sqlUser");if(s)try{const a=JSON.parse(s);a!=null&&a.id&&(t["x-user-id"]=a.id,(a.username||a.fullName)&&(t["x-user-name"]=a.username||a.fullName),a.role&&(t["x-user-role"]=a.role),a.companyCode&&(t["x-company-code"]=a.companyCode),a.companyName&&(t["x-company-name"]=a.companyName))}catch{console.warn("VendorApiService: Failed to parse sqlUser from localStorage")}return t}async getVendors(){try{console.log("🏗️ Fetching vendors...");const t=await fetch(`${Uo}/vendors`,{headers:this.getHeaders()});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const i=await t.json();return console.log(`✅ Retrieved ${i.length} vendors`),i}catch(t){throw console.error("❌ Error fetching vendors:",t),t}}async createVendor(t){try{console.log("🏗️ Creating vendor:",t.Name);const i=await fetch(`${Uo}/vendors`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(t)});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const s=await i.json();return console.log("✅ Vendor created:",s.VendorID),s}catch(i){throw console.error("❌ Error creating vendor:",i),i}}async updateVendor(t,i){try{console.log("🏗️ Updating vendor:",t);const s=await fetch(`${Uo}/vendors/${t}`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(i)});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();return console.log("✅ Vendor updated:",a.VendorID),a}catch(s){throw console.error("❌ Error updating vendor:",s),s}}async deleteVendor(t){try{console.log("🏗️ Deleting vendor:",t);const i=await fetch(`${Uo}/vendors/${t}`,{method:"DELETE",headers:this.getHeaders()});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);console.log("✅ Vendor deleted:",t)}catch(i){throw console.error("❌ Error deleting vendor:",i),i}}}const $o=new i_;function r_({vendor:e,sites:t,onSave:i,onDelete:s,onClose:a}){const[c,d]=P.useState(e||{VendorID:"",Name:"",Contact:"",Phone:"",Email:"",ServiceAreas:[],Specialties:[],CitiesServed:"",Rating:5,Notes:"",VendorStatus:"Active",StateLicenseNumber:"",StateLicenseExpiration:"",COIProvider:"",COIPolicyNumber:"",COIExpiration:"",Certifications:"",ComplianceNotes:""}),[p,m]=P.useState(!1);P.useEffect(()=>{e&&d(e)},[e]);const g=!c.VendorID||c.VendorID==="";function _(S,f){d(w=>({...w,[S]:f}))}const j=(S,f)=>{const w=c.ServiceAreas||[];f?w.includes(S)||_("ServiceAreas",[...w,S]):_("ServiceAreas",w.filter(C=>C!==S))},b=(S,f)=>{const w=c.Specialties||[];f?w.includes(S)||_("Specialties",[...w,S]):_("Specialties",w.filter(C=>C!==S))};async function D(S){if(S.preventDefault(),!c.Name){alert("Vendor name is required");return}m(!0);try{await i(c),a()}catch(f){console.error("Error saving vendor:",f),alert("Failed to save vendor")}finally{m(!1)}}async function k(){if(c.VendorID&&confirm(`Delete vendor "${c.Name}"?`))try{s&&await s(c.VendorID),a()}catch(S){console.error("Error deleting vendor:",S),alert("Failed to delete vendor")}}const A=["Access Control","Video Management","Intrusion Alarm","Fire Safety","Network Infrastructure","IT Services","HVAC","Electrical","Plumbing"],O=t.reduce((S,f)=>{const w=f.Customer||"Unknown";return S[w]||(S[w]=[]),S[w].push(f),S},{});return r.jsx("div",{className:"modal-overlay",onClick:a,children:r.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),style:{maxWidth:900,maxHeight:"90vh",overflowY:"auto"},children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:g?"Add New Vendor":"Edit Vendor"}),r.jsx("button",{onClick:a,className:"close-btn",children:"×"})]}),r.jsxs("form",{onSubmit:D,children:[r.jsx("div",{className:"modal-body",children:r.jsxs("div",{className:"row",children:[!g&&r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Vendor ID"}),r.jsx("input",{value:c.VendorID,disabled:!0})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Vendor Status"}),r.jsxs("select",{value:c.VendorStatus||"Active",onChange:S=>_("VendorStatus",S.target.value),children:[r.jsx("option",{value:"Active",children:"Active"}),r.jsx("option",{value:"Inactive",children:"Inactive"}),r.jsx("option",{value:"Suspended",children:"Suspended"})]})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Company Name *"}),r.jsx("input",{required:!0,value:c.Name||"",onChange:S=>_("Name",S.target.value),placeholder:"ABC Security Solutions"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Primary Contact"}),r.jsx("input",{value:c.Contact||"",onChange:S=>_("Contact",S.target.value),placeholder:"John Smith"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Phone"}),r.jsx("input",{value:c.Phone||"",onChange:S=>_("Phone",S.target.value),placeholder:"(555) 123-4567"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:c.Email||"",onChange:S=>_("Email",S.target.value),placeholder:"contact@vendor.com"})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Cities Served"}),r.jsx("input",{value:c.CitiesServed||"",onChange:S=>_("CitiesServed",S.target.value),placeholder:"Austin, Dallas, Houston, San Antonio"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Rating (1-5)"}),r.jsxs("select",{value:c.Rating||5,onChange:S=>_("Rating",parseInt(S.target.value)),children:[r.jsx("option",{value:1,children:"1 Star - Poor"}),r.jsx("option",{value:2,children:"2 Stars - Fair"}),r.jsx("option",{value:3,children:"3 Stars - Good"}),r.jsx("option",{value:4,children:"4 Stars - Very Good"}),r.jsx("option",{value:5,children:"5 Stars - Excellent"})]})]}),r.jsx("div",{className:"col-12",style:{marginTop:"16px",paddingTop:"16px",borderTop:"2px solid #2a3a5f"},children:r.jsx("strong",{style:{color:"#9fb3ff",fontSize:"16px"},children:"📋 Vendor Compliance Tracking"})}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"State License Number"}),r.jsx("input",{value:c.StateLicenseNumber||"",onChange:S=>_("StateLicenseNumber",S.target.value),placeholder:"TX-12345"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"State License Expiration"}),r.jsx("input",{type:"date",value:c.StateLicenseExpiration?c.StateLicenseExpiration.split("T")[0]:"",onChange:S=>_("StateLicenseExpiration",S.target.value)})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"COI Provider (Insurance Company)"}),r.jsx("input",{value:c.COIProvider||"",onChange:S=>_("COIProvider",S.target.value),placeholder:"State Farm, Allstate, etc."})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"COI Policy Number"}),r.jsx("input",{value:c.COIPolicyNumber||"",onChange:S=>_("COIPolicyNumber",S.target.value),placeholder:"POL-123456"})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"COI Expiration Date"}),r.jsx("input",{type:"date",value:c.COIExpiration?c.COIExpiration.split("T")[0]:"",onChange:S=>_("COIExpiration",S.target.value)})]}),r.jsxs("div",{className:"col-6",children:[r.jsx("label",{children:"Certifications"}),r.jsx("input",{value:c.Certifications||"",onChange:S=>_("Certifications",S.target.value),placeholder:"NICET, ASIS, etc."})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"Compliance Notes"}),r.jsx("textarea",{value:c.ComplianceNotes||"",onChange:S=>_("ComplianceNotes",S.target.value),placeholder:"Additional compliance information, renewal dates, special requirements...",rows:2})]}),r.jsxs("div",{className:"col-12",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #2a3a5f"},children:[r.jsx("label",{children:"Service Specialties"}),r.jsx("div",{className:"row",style:{gap:12,marginTop:8},children:A.map(S=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",width:"auto",marginRight:16},children:[r.jsx("input",{type:"checkbox",checked:(c.Specialties||[]).includes(S),onChange:f=>b(S,f.target.checked)}),r.jsx("span",{style:{fontSize:13},children:S})]},S))})]}),r.jsxs("div",{className:"col-12",style:{marginTop:"16px"},children:[r.jsx("label",{children:"Sites They Can Service"}),r.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #243252",borderRadius:8,padding:12,marginTop:8},children:Object.keys(O).length>0?Object.entries(O).map(([S,f])=>r.jsxs("div",{style:{marginBottom:16},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8,color:"#9fb3ff",fontSize:14},children:[S," (",f.length," ",f.length===1?"site":"sites",")"]}),r.jsx("div",{className:"row",children:f.map(w=>{const C=`${w.Customer} - ${w.Site}`;return r.jsx("div",{className:"col-6",children:r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",fontSize:12},children:[r.jsx("input",{type:"checkbox",checked:(c.ServiceAreas||[]).includes(C),onChange:y=>j(C,y.target.checked)}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:500},children:w.Site}),r.jsx("div",{className:"muted",children:w.Address||"No address"})]})]})},w.SiteID||C)})})]},S)):r.jsx("div",{className:"muted",style:{textAlign:"center",padding:16},children:"No sites available"})})]}),r.jsxs("div",{className:"col-12",children:[r.jsx("label",{children:"General Notes"}),r.jsx("textarea",{value:c.Notes||"",onChange:S=>_("Notes",S.target.value),placeholder:"Additional notes about this vendor...",rows:3})]})]})}),r.jsxs("div",{className:"modal-footer",children:[!g&&s&&r.jsx("button",{type:"button",onClick:k,className:"btn",style:{backgroundColor:"#dc3545",marginRight:"auto"},children:"Delete Vendor"}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:a,className:"btn",style:{backgroundColor:"#666"},children:"Cancel"}),r.jsx("button",{type:"submit",className:"btn primary",disabled:p,children:p?g?"Creating...":"Saving...":g?"Create Vendor":"Save Changes"})]})]})]})]})})}function o_(){const[e,t]=P.useState([]),[i,s]=P.useState([]),[a,c]=P.useState(!0),[d,p]=P.useState({search:"",status:"All",specialty:"All",compliance:"All"}),[m,g]=P.useState(!1),[_,j]=P.useState(null);async function b(){c(!0);try{const[y,z]=await Promise.all([$o.getVendors(),Ni.getSites()]);t(y),s(z)}catch(y){console.error("Failed to load data:",y)}finally{c(!1)}}P.useEffect(()=>{b()},[]);function D(){j({VendorID:"",Name:"",Contact:"",Phone:"",Email:"",ServiceAreas:[],Specialties:[],CitiesServed:"",Rating:5,Notes:"",VendorStatus:"Active",StateLicenseNumber:"",StateLicenseExpiration:"",COIProvider:"",COIPolicyNumber:"",COIExpiration:"",Certifications:"",ComplianceNotes:""}),g(!0)}function k(y){j(y),g(!0)}async function A(y){try{!y.VendorID||y.VendorID===""?(console.log("VendorsPage.saveEdit: Creating new vendor:",y.Name),await $o.createVendor(y)):(console.log("VendorsPage.saveEdit: Updating vendor:",y.VendorID),await $o.updateVendor(y.VendorID,y)),b(),g(!1)}catch(z){throw console.error("VendorsPage.saveEdit: Error saving vendor:",z),alert("Error saving vendor: "+z.message),z}}async function O(y){try{await $o.deleteVendor(y),b()}catch(z){console.error("Error deleting vendor:",z),alert("Failed to delete vendor")}}function S(y){const z=new Date,I=new Date;I.setDate(I.getDate()+30);let B=!1,$=!1,H=!1,U=!1;if(y.StateLicenseNumber&&y.StateLicenseExpiration){B=!0;const F=new Date(y.StateLicenseExpiration);if(H=F>z,F<=I&&F>z)return"Expiring Soon"}if(y.COIProvider&&y.COIExpiration){$=!0;const F=new Date(y.COIExpiration);if(U=F>z,F<=I&&F>z)return"Expiring Soon"}return B&&$&&H&&U||!B&&!$?"Compliant":"Non-Compliant"}function f(y){switch(y){case"Compliant":return"#28a745";case"Expiring Soon":return"#ffc107";case"Non-Compliant":return"#dc3545";default:return"#6c757d"}}const w=e.filter(y=>{var z,I,B,$,H;if(d.search){const U=d.search.toLowerCase();if(!(((z=y.Name)==null?void 0:z.toLowerCase().includes(U))||((I=y.Contact)==null?void 0:I.toLowerCase().includes(U))||((B=y.Phone)==null?void 0:B.toLowerCase().includes(U))||(($=y.Email)==null?void 0:$.toLowerCase().includes(U))||((H=y.CitiesServed)==null?void 0:H.toLowerCase().includes(U))))return!1}return!(d.status!=="All"&&y.VendorStatus!==d.status||d.specialty!=="All"&&!(y.Specialties||[]).includes(d.specialty)||d.compliance!=="All"&&S(y)!==d.compliance)}),C=[...new Set(e.flatMap(y=>y.Specialties||[]))].sort();return r.jsxs("div",{className:"card",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[r.jsxs("div",{className:"title",children:["Vendors ",a&&r.jsx("span",{className:"muted",children:"Loading…"})]}),r.jsx("button",{onClick:D,className:"btn primary",style:{backgroundColor:"#28a745"},children:"+ Add New Vendor"})]}),r.jsxs("div",{className:"row",style:{gap:8,marginBottom:12},children:[r.jsxs("div",{style:{flex:"1 1 200px"},children:[r.jsx("label",{children:"Search"}),r.jsx("input",{type:"search",placeholder:"Search vendors...",value:d.search,onChange:y=>p({...d,search:y.target.value})})]}),r.jsxs("div",{style:{flex:"0 0 150px"},children:[r.jsx("label",{children:"Status"}),r.jsxs("select",{value:d.status,onChange:y=>p({...d,status:y.target.value}),children:[r.jsx("option",{value:"All",children:"All"}),r.jsx("option",{value:"Active",children:"Active"}),r.jsx("option",{value:"Inactive",children:"Inactive"}),r.jsx("option",{value:"Suspended",children:"Suspended"})]})]}),r.jsxs("div",{style:{flex:"0 0 180px"},children:[r.jsx("label",{children:"Specialty"}),r.jsxs("select",{value:d.specialty,onChange:y=>p({...d,specialty:y.target.value}),children:[r.jsx("option",{value:"All",children:"All Specialties"}),C.map(y=>r.jsx("option",{value:y,children:y},y))]})]}),r.jsxs("div",{style:{flex:"0 0 160px"},children:[r.jsx("label",{children:"Compliance"}),r.jsxs("select",{value:d.compliance,onChange:y=>p({...d,compliance:y.target.value}),children:[r.jsx("option",{value:"All",children:"All"}),r.jsx("option",{value:"Compliant",children:"Compliant"}),r.jsx("option",{value:"Expiring Soon",children:"Expiring Soon"}),r.jsx("option",{value:"Non-Compliant",children:"Non-Compliant"})]})]})]}),r.jsxs("div",{style:{overflowX:"auto"},children:[r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{borderBottom:"2px solid #2a3a5f",textAlign:"left"},children:[r.jsx("th",{style:{padding:"12px 8px",color:"#9fb3ff"},children:"Vendor"}),r.jsx("th",{style:{padding:"12px 8px",color:"#9fb3ff"},children:"Contact"}),r.jsx("th",{style:{padding:"12px 8px",color:"#9fb3ff"},children:"Specialties"}),r.jsx("th",{style:{padding:"12px 8px",color:"#9fb3ff"},children:"Rating"}),r.jsx("th",{style:{padding:"12px 8px",color:"#9fb3ff"},children:"Compliance"}),r.jsx("th",{style:{padding:"12px 8px",color:"#9fb3ff"},children:"Status"}),r.jsx("th",{style:{padding:"12px 8px",color:"#9fb3ff"},children:"Actions"})]})}),r.jsx("tbody",{children:w.map(y=>{const z=S(y);return r.jsxs("tr",{style:{borderBottom:"1px solid #1a2540"},children:[r.jsxs("td",{style:{padding:"12px 8px"},children:[r.jsx("div",{style:{fontWeight:600},children:y.Name}),r.jsx("div",{className:"muted",style:{fontSize:12},children:y.CitiesServed||"No cities listed"})]}),r.jsxs("td",{style:{padding:"12px 8px"},children:[r.jsx("div",{style:{fontSize:13},children:y.Contact||"-"}),r.jsx("div",{className:"muted",style:{fontSize:12},children:y.Phone||"-"})]}),r.jsx("td",{style:{padding:"12px 8px"},children:r.jsx("div",{style:{fontSize:13},children:y.Specialties&&y.Specialties.length>0?y.Specialties.slice(0,2).join(", ")+(y.Specialties.length>2?"...":""):"-"})}),r.jsxs("td",{style:{padding:"12px 8px"},children:[r.jsx("span",{style:{color:"#ffc107"},children:"★"})," ",y.Rating||5]}),r.jsx("td",{style:{padding:"12px 8px"},children:r.jsx("span",{style:{padding:"4px 8px",borderRadius:4,fontSize:12,fontWeight:500,backgroundColor:f(z)+"20",color:f(z),border:`1px solid ${f(z)}`},children:z})}),r.jsx("td",{style:{padding:"12px 8px"},children:r.jsx("span",{style:{padding:"4px 8px",borderRadius:4,fontSize:12,fontWeight:500,backgroundColor:y.VendorStatus==="Active"?"#28a74520":"#6c757d20",color:y.VendorStatus==="Active"?"#28a745":"#6c757d"},children:y.VendorStatus||"Active"})}),r.jsx("td",{style:{padding:"12px 8px"},children:r.jsx("button",{onClick:()=>k(y),className:"btn",style:{padding:"6px 12px",fontSize:13},children:"Edit"})})]},y.VendorID)})})]}),w.length===0&&!a&&r.jsx("div",{className:"muted",style:{textAlign:"center",padding:40},children:d.search||d.status!=="All"||d.specialty!=="All"||d.compliance!=="All"?"No vendors match your filters":'No vendors yet. Click "+ Add New Vendor" to get started.'})]}),m&&r.jsx(r_,{vendor:_,sites:i,onSave:A,onDelete:O,onClose:()=>g(!1)})]})}const Ya="https://field-service-api.azurewebsites.net/api";function Qa(){const e={"Content-Type":"application/json"},t=localStorage.getItem("authToken");t&&(e.Authorization=`Bearer ${t}`);const i=localStorage.getItem("sqlUser");if(i)try{const s=JSON.parse(i);s.id&&(e["x-user-id"]=s.id,e["x-user-name"]=s.username||s.fullName||"",e["x-user-role"]=s.role||"")}catch{console.warn("Failed to parse sqlUser from localStorage")}return e}function s_({onLogout:e,onCountChange:t}){const[i,s]=P.useState([]),[a,c]=P.useState("New"),[d,p]=P.useState(null),[m,g]=P.useState(""),[_,j]=P.useState(!1),[b,D]=P.useState(!1);P.useEffect(()=>{const y=i.filter(z=>z.Status==="New").length;t(y)},[i,t]);async function k(){try{const y=await fetch(`${Ya}/service-requests?status=${a}`,{headers:Qa()});if(y.ok){const z=await y.json();Array.isArray(z)?s(z):(console.error("Invalid data format received:",z),s([]))}else console.error("Failed to load requests:",y.status,y.statusText),s([])}catch(y){console.error("Error loading service requests:",y),s([])}}P.useEffect(()=>{k()},[a]);async function A(y){if(confirm(`Create a ticket from this service request?

Customer: ${y.CustomerName}
Issue: ${y.IssueDescription.substring(0,100)}...`)){D(!0);try{const z=Intl.DateTimeFormat().resolvedOptions().timeZone,I=Qa();I["x-user-timezone"]=z;const B=await fetch(`${Ya}/service-requests/${y.RequestID}/create-ticket`,{method:"POST",headers:I});if(B.ok){const $=await B.json();alert(`✓ Ticket created successfully!

Ticket ID: ${$.ticketId}`),await k()}else{const $=await B.json().catch(()=>({error:"Unknown error"}));throw new Error($.error||"Failed to create ticket")}}catch(z){console.error("Error creating ticket:",z),alert(`Failed to create ticket: ${z instanceof Error?z.message:"Unknown error"}`)}finally{D(!1)}}}function O(y){p(y),g(""),j(!0)}async function S(){if(d){if(!m.trim()){alert("Please provide a reason for dismissing this request");return}D(!0);try{const y=Intl.DateTimeFormat().resolvedOptions().timeZone,z=Qa();if(z["x-user-timezone"]=y,(await fetch(`${Ya}/service-requests/${d.RequestID}/dismiss`,{method:"POST",headers:z,body:JSON.stringify({note:m})})).ok)j(!1),p(null),g(""),k();else throw new Error("Failed to dismiss request")}catch(y){console.error("Error dismissing request:",y),alert("Failed to dismiss request")}finally{D(!1)}}}function f(y){return new Date(y).toLocaleString()}function w(y){switch(y){case"Critical":return"#e74c3c";case"High":return"#e67e22";case"Medium":return"#f39c12";case"Low":return"#3498db";default:return"#95a5a6"}}const C=i.filter(y=>y.Status==="New").length;return r.jsxs("div",{className:"card",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[r.jsxs("div",{children:[r.jsx("div",{className:"title",children:"Service Requests"}),C>0&&a==="New"&&r.jsxs("div",{style:{fontSize:14,color:"#e74c3c",marginTop:4},children:[C," new request",C!==1?"s":""," pending"]})]}),r.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[r.jsxs("select",{value:a,onChange:y=>c(y.target.value),className:"btn",children:[r.jsxs("option",{value:"New",children:["New (",i.filter(y=>y.Status==="New").length,")"]}),r.jsx("option",{value:"Processed",children:"Processed"}),r.jsx("option",{value:"Dismissed",children:"Dismissed"}),r.jsx("option",{value:"All",children:"All"})]}),r.jsx("button",{onClick:k,className:"btn",children:"🔄 Refresh"})]})]}),i.length===0?r.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:a==="New"?"No new service requests":`No ${a.toLowerCase()} requests`}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:i.map(y=>r.jsxs("div",{style:{border:"1px solid #ddd",borderLeft:`4px solid ${w(y.Priority)}`,borderRadius:4,padding:16,backgroundColor:y.Status==="New"?"#fff9e6":"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:18,fontWeight:600,marginBottom:4,color:"#222"},children:y.CustomerName}),r.jsxs("div",{style:{fontSize:12,color:"#555"},children:[y.RequestID," · Submitted ",f(y.SubmittedAt)]})]}),r.jsx("div",{style:{display:"flex",gap:8,alignItems:"flex-start"},children:r.jsx("span",{style:{padding:"4px 12px",borderRadius:4,fontSize:12,fontWeight:600,backgroundColor:w(y.Priority),color:"white"},children:y.Priority})})]}),r.jsx("div",{style:{marginBottom:12},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,fontSize:14,color:"#333"},children:[y.ContactEmail&&r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#000"},children:"Email:"})," ",y.ContactEmail]}),y.ContactPhone&&r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#000"},children:"Phone:"})," ",y.ContactPhone]}),y.SiteName&&r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#000"},children:"Site:"})," ",y.SiteName]}),y.Address&&r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#000"},children:"Address:"})," ",y.Address]})]})}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("strong",{style:{color:"#000"},children:"Issue Description:"}),r.jsx("div",{style:{marginTop:8,padding:12,backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:4,whiteSpace:"pre-wrap",fontSize:14,color:"#212529",lineHeight:"1.5"},children:y.IssueDescription})]}),y.Status!=="New"&&r.jsxs("div",{style:{marginTop:12,padding:12,backgroundColor:y.Status==="Processed"?"#d4edda":"#f8d7da",borderRadius:4,fontSize:13},children:[r.jsx("strong",{children:y.Status==="Processed"?"Processed":"Dismissed"})," by ",y.ProcessedBy," on ",y.ProcessedAt&&f(y.ProcessedAt),y.TicketID&&r.jsxs("div",{style:{marginTop:4},children:[r.jsx("strong",{children:"Ticket Created:"})," ",y.TicketID]}),y.ProcessedNote&&r.jsxs("div",{style:{marginTop:4},children:[r.jsx("strong",{children:"Note:"})," ",y.ProcessedNote]})]}),y.Status==="New"&&r.jsxs("div",{style:{display:"flex",gap:10,marginTop:12},children:[r.jsx("button",{onClick:()=>A(y),disabled:b,className:"btn",style:{flex:1,backgroundColor:"#28a745",color:"white"},children:"🎫 Create Ticket"}),r.jsx("button",{onClick:()=>O(y),disabled:b,className:"btn",style:{flex:1,backgroundColor:"#6c757d",color:"white"},children:"❌ Dismiss"})]})]},y.RequestID))}),_&&d&&r.jsx("div",{className:"modal-overlay",onClick:()=>j(!1),children:r.jsxs("div",{className:"modal-content",onClick:y=>y.stopPropagation(),style:{maxWidth:500},children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Dismiss Service Request"}),r.jsx("button",{className:"modal-close",onClick:()=>j(!1),children:"×"})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("p",{style:{marginBottom:16},children:["You are about to dismiss the service request from ",r.jsx("strong",{children:d.CustomerName}),"."]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:8,fontWeight:600},children:"Reason for dismissal (required):"}),r.jsx("textarea",{value:m,onChange:y=>g(y.target.value),placeholder:"e.g., Duplicate request, spam, not a service issue, etc.",style:{width:"100%",minHeight:100,padding:10,border:"1px solid #ddd",borderRadius:4,fontSize:14}})]})]}),r.jsxs("div",{className:"modal-footer",style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[r.jsx("button",{onClick:()=>j(!1),className:"btn",style:{backgroundColor:"#6c757d"},children:"Cancel"}),r.jsx("button",{onClick:S,disabled:b||!m.trim(),className:"btn",style:{backgroundColor:"#dc3545",color:"white"},children:b?"Dismissing...":"Dismiss Request"})]})]})})]})}function a_({tickets:e,currentUser:t,onTicketUpdate:i,onLogout:s}){const[a,c]=P.useState(null),[d,p]=P.useState(!1);console.log("TechnicianInterface: currentUser:",t),console.log("TechnicianInterface: tickets received:",e.length,e);const m=async()=>{if(!t)return;const O=prompt("Enter your new password:");if(!O)return;const S=prompt("Confirm your new password:");if(S){if(O!==S){alert("Passwords do not match!");return}if(O.length<6){alert("Password must be at least 6 characters long!");return}try{await Ft.changePassword(t.id,O),alert("Password changed successfully!")}catch(f){alert(`Failed to change password: ${f}`)}}},g=P.useMemo(()=>{if(console.log("TechnicianInterface: assignedTickets useMemo - currentUser:",t),console.log("TechnicianInterface: assignedTickets useMemo - tickets:",e.length),!t)return console.log("TechnicianInterface: No current user, returning empty array"),[];if(t.role==="Technician"){console.log("TechnicianInterface: User is Technician, filtering out closed tickets");const S=e.filter(f=>f.Status!=="Closed");return console.log("TechnicianInterface: Showing",S.length,"tickets (excluding closed)"),S}console.log("TechnicianInterface: User is not Technician, applying frontend filtering");const O=e.filter(S=>{var y,z,I;if(S.Status==="Closed")return!1;const f=((y=S.AssignedTo)==null?void 0:y.toLowerCase())||"",w=((z=t.fullName)==null?void 0:z.toLowerCase())||"",C=((I=t.username)==null?void 0:I.toLowerCase())||"";return f.includes(w)||f.includes(C)});return console.log("TechnicianInterface: Filtered tickets:",O.length),O},[e,t]);console.log("TechnicianInterface: Final assignedTickets:",g.length,g);const _=P.useMemo(()=>{const O=g.length,S=g.filter(z=>z.Status==="New").length,f=g.filter(z=>z.Status==="Scheduled").length,w=g.filter(z=>z.Status==="In-Progress").length,C=g.filter(z=>z.Status==="Complete").length,y=g.filter(z=>z.SLA_Due?new Date(z.SLA_Due)<new Date&&!["Complete","Closed"].includes(z.Status||""):!1).length;return{total:O,newTickets:S,scheduled:f,inProgress:w,complete:C,overdue:y}},[g]),j=O=>{c(O),p(!0)},b=()=>{p(!1),c(null)},D=O=>O?new Date(O).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—",k=O=>{switch(O){case"Critical":return"#ff4444";case"High":return"#ff8800";case"Normal":return"#4CAF50";case"Low":return"#2196F3";default:return"#666"}},A=O=>{switch(O){case"New":return"#ffab00";case"Scheduled":return"#2196F3";case"In-Progress":return"#ff9800";case"On-Hold":return"#9e9e9e";case"Complete":return"#4CAF50";default:return"#666"}};return r.jsxs("div",{style:{padding:"20px",background:"#0f1419",minHeight:"100vh"},children:[r.jsxs("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{margin:"0 0 8px 0",color:"#ffffff",fontSize:"28px",fontWeight:"700"},children:"🔧 Technician Dashboard"}),r.jsxs("p",{style:{margin:0,color:"#8892b0",fontSize:"16px"},children:["Welcome back, ",t==null?void 0:t.fullName," - Your assigned tickets"]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[r.jsx("button",{onClick:m,style:{background:"#2196F3",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseEnter:O=>{O.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:O=>{O.currentTarget.style.backgroundColor="#2196F3"},children:"🔐 Change Password"}),r.jsx("button",{onClick:s,style:{background:"#ff5470",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseEnter:O=>{O.currentTarget.style.backgroundColor="#e63946"},onMouseLeave:O=>{O.currentTarget.style.backgroundColor="#ff5470"},children:"Logout"})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"16px",marginBottom:"24px"},children:[r.jsxs("div",{style:{background:"#17263f",border:"1px solid #2d3748",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#8892b0",marginBottom:"8px",fontWeight:"600"},children:"📋 Total Assigned"}),r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ffffff"},children:_.total})]}),r.jsxs("div",{style:{background:"#17263f",border:"1px solid #2d3748",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#8892b0",marginBottom:"8px",fontWeight:"600"},children:"🆕 New"}),r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ffab00"},children:_.newTickets})]}),r.jsxs("div",{style:{background:"#17263f",border:"1px solid #2d3748",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#8892b0",marginBottom:"8px",fontWeight:"600"},children:"📅 Scheduled"}),r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:_.scheduled})]}),r.jsxs("div",{style:{background:"#17263f",border:"1px solid #2d3748",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#8892b0",marginBottom:"8px",fontWeight:"600"},children:"🔄 In Progress"}),r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:_.inProgress})]}),r.jsxs("div",{style:{background:"#17263f",border:"1px solid #2d3748",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#8892b0",marginBottom:"8px",fontWeight:"600"},children:"✅ Complete"}),r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:_.complete})]}),_.overdue>0&&r.jsxs("div",{style:{background:"#3a1f1f",border:"1px solid #ff4444",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"14px",color:"#ff9999",marginBottom:"8px",fontWeight:"600"},children:"⚠️ Overdue"}),r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff4444"},children:_.overdue})]})]}),r.jsxs("div",{style:{background:"#1a2332",border:"1px solid #2d3748",borderRadius:"8px",overflow:"hidden"},children:[r.jsx("div",{style:{padding:"16px",borderBottom:"1px solid #2d3748",background:"#17263f"},children:r.jsxs("h2",{style:{margin:0,color:"#ffffff",fontSize:"18px",fontWeight:"600"},children:["📝 My Assigned Tickets (",g.length,")"]})}),g.length===0?r.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#8892b0"},children:[r.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📭"}),r.jsx("div",{style:{fontSize:"18px",marginBottom:"8px"},children:"No tickets assigned"}),r.jsx("div",{style:{fontSize:"14px"},children:"Check back later for new assignments"})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column"},children:g.map(O=>{var S,f;return r.jsxs("div",{onClick:()=>j(O),style:{padding:"16px",borderBottom:"1px solid #2d3748",cursor:"pointer",transition:"background-color 0.2s ease",background:"transparent"},onMouseEnter:w=>{w.currentTarget.style.backgroundColor="#233547"},onMouseLeave:w=>{w.currentTarget.style.backgroundColor="transparent"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[r.jsxs("div",{children:[r.jsx("h3",{style:{margin:"0 0 4px 0",color:"#ffffff",fontSize:"16px",fontWeight:"600"},children:O.Title}),r.jsxs("div",{style:{color:"#8892b0",fontSize:"14px"},children:[O.TicketID," • ",O.Customer," • ",O.Site]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[r.jsx("span",{style:{background:k(O.Priority),color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600"},children:O.Priority}),r.jsx("span",{style:{background:A(O.Status),color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600"},children:O.Status})]})]}),r.jsxs("div",{style:{color:"#8892b0",fontSize:"13px",marginBottom:"8px"},children:[(S=O.Description)==null?void 0:S.substring(0,150),((f=O.Description)==null?void 0:f.length)>150?"...":""]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"13px",color:"#64748b"},children:[r.jsxs("div",{children:["📅 Scheduled: ",D(O.ScheduledStart)]}),O.SLA_Due&&r.jsxs("div",{style:{color:new Date(O.SLA_Due)<new Date?"#ff4444":"#64748b"},children:["⏰ Due: ",D(O.SLA_Due)]})]})]},O.TicketID)})})]}),d&&a&&r.jsx(l_,{ticket:a,currentUser:t,onClose:b,onSave:i})]})}function l_({ticket:e,currentUser:t,onClose:i,onSave:s}){const[a,c]=P.useState(e),[d,p]=P.useState(!1),[m,g]=P.useState(""),[_,j]=P.useState("status"),b=(A,O)=>{c(S=>({...S,[A]:O}))},D=()=>{if(!m.trim())return;const A={NoteID:Date.now().toString(),CoordinatorName:(t==null?void 0:t.fullName)||"Technician",Timestamp:new Date().toISOString(),Note:m.trim()};c(O=>({...O,CoordinatorNotes:[...O.CoordinatorNotes||[],A]})),g("")},k=async()=>{try{p(!0);const A=[];["Status","Resolution","CoordinatorNotes"].forEach(f=>{var w,C,y,z;if(f==="CoordinatorNotes"){const I=((w=e.CoordinatorNotes)==null?void 0:w.length)||0,B=((C=a.CoordinatorNotes)==null?void 0:C.length)||0;B>I&&A.push({id:Date.now().toString(),timestamp:new Date().toISOString(),user:(t==null?void 0:t.fullName)||"Technician",action:"Added technician note",field:"Notes",oldValue:"",newValue:((z=(y=a.CoordinatorNotes)==null?void 0:y[B-1])==null?void 0:z.Note)||""})}else a[f]!==e[f]&&A.push({id:Date.now().toString(),timestamp:new Date().toISOString(),user:(t==null?void 0:t.fullName)||"Technician",action:"Updated field",field:f,oldValue:e[f]||"",newValue:a[f]||""})});const S={...a,UpdatedAt:new Date().toISOString(),AuditTrail:[...e.AuditTrail||[],...A]};await s(S),i()}catch(A){console.error("Failed to save ticket:",A)}finally{p(!1)}};return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"#1a2332",border:"1px solid #2d3748",borderRadius:"8px",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #2d3748",background:"#17263f"},children:[r.jsxs("h2",{style:{margin:"0 0 8px 0",color:"#ffffff",fontSize:"20px",fontWeight:"600"},children:["🔧 Update Ticket - ",e.TicketID]}),r.jsx("p",{style:{margin:0,color:"#8892b0",fontSize:"14px"},children:e.Title})]}),r.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #2d3748",background:"#1a2332"},children:[r.jsx("button",{onClick:()=>j("status"),style:{background:_==="status"?"#17263f":"transparent",border:"none",color:_==="status"?"#ffffff":"#8892b0",padding:"12px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"📊 Status & Work"}),r.jsx("button",{onClick:()=>j("notes"),style:{background:_==="notes"?"#17263f":"transparent",border:"none",color:_==="notes"?"#ffffff":"#8892b0",padding:"12px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"📝 Notes"}),r.jsx("button",{onClick:()=>j("attachments"),style:{background:_==="attachments"?"#17263f":"transparent",border:"none",color:_==="attachments"?"#ffffff":"#8892b0",padding:"12px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"📎 Photos/Documents"})]}),r.jsxs("div",{style:{padding:"20px",flex:1,overflow:"auto"},children:[_==="status"&&r.jsxs("div",{style:{display:"grid",gap:"20px"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#ffffff"},children:"Status *"}),r.jsxs("select",{value:a.Status,onChange:A=>b("Status",A.target.value),style:{width:"100%",padding:"12px",border:"1px solid #2d3748",borderRadius:"6px",fontSize:"14px",background:"#0f1419",color:"#ffffff"},children:[r.jsx("option",{value:"New",children:"New"}),r.jsx("option",{value:"Scheduled",children:"Scheduled"}),r.jsx("option",{value:"In-Progress",children:"In Progress"}),r.jsx("option",{value:"On-Hold",children:"On Hold"}),r.jsx("option",{value:"Complete",children:"Complete"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#ffffff"},children:"Work Performed / Resolution Notes"}),r.jsx("textarea",{value:a.Resolution||"",onChange:A=>b("Resolution",A.target.value),style:{width:"100%",padding:"12px",border:"1px solid #2d3748",borderRadius:"6px",minHeight:"120px",fontSize:"14px",background:"#0f1419",color:"#ffffff",resize:"vertical"},placeholder:"Describe work performed, parts used, next steps, or resolution details..."})]}),r.jsxs("div",{style:{background:"#0f1419",border:"1px solid #2d3748",borderRadius:"6px",padding:"16px"},children:[r.jsx("h3",{style:{margin:"0 0 12px 0",color:"#ffffff",fontSize:"16px"},children:"📋 Ticket Information"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",fontSize:"14px"},children:[r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#8892b0"},children:"Customer:"})," ",r.jsx("span",{style:{color:"#ffffff"},children:e.Customer})]}),r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#8892b0"},children:"Site:"})," ",r.jsx("span",{style:{color:"#ffffff"},children:e.Site})]}),r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#8892b0"},children:"Priority:"})," ",r.jsx("span",{style:{color:"#ffffff"},children:e.Priority})]}),r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#8892b0"},children:"Category:"})," ",r.jsx("span",{style:{color:"#ffffff"},children:e.Category})]}),r.jsxs("div",{style:{gridColumn:"1 / -1"},children:[r.jsx("strong",{style:{color:"#8892b0"},children:"Description:"}),r.jsx("div",{style:{color:"#ffffff",marginTop:"4px"},children:e.Description})]})]})]})]}),_==="notes"&&r.jsxs("div",{children:[r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#ffffff"},children:"Add Technician Note"}),r.jsx("textarea",{value:m,onChange:A=>g(A.target.value),style:{width:"100%",padding:"12px",border:"1px solid #2d3748",borderRadius:"6px",minHeight:"80px",fontSize:"14px",background:"#0f1419",color:"#ffffff",resize:"vertical"},placeholder:"Add notes about progress, issues, or next steps..."}),r.jsx("button",{onClick:D,disabled:!m.trim(),style:{marginTop:"8px",background:m.trim()?"#4CAF50":"#2d3748",color:m.trim()?"white":"#8892b0",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",cursor:m.trim()?"pointer":"not-allowed"},children:"Add Note"})]}),r.jsxs("div",{children:[r.jsx("h3",{style:{margin:"0 0 16px 0",color:"#ffffff",fontSize:"16px"},children:"📝 Ticket Notes"}),a.CoordinatorNotes&&a.CoordinatorNotes.length>0?r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:a.CoordinatorNotes.map(A=>r.jsxs("div",{style:{background:"#0f1419",border:"1px solid #2d3748",borderRadius:"6px",padding:"12px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",fontSize:"13px",color:"#8892b0"},children:[r.jsxs("span",{children:["👤 ",A.CoordinatorName]}),r.jsx("span",{children:new Date(A.Timestamp).toLocaleString()})]}),r.jsx("div",{style:{color:"#ffffff",fontSize:"14px"},children:A.Note})]},A.NoteID))}):r.jsx("div",{style:{textAlign:"center",color:"#8892b0",padding:"20px",fontSize:"14px"},children:"No notes yet. Add the first note above."})]})]}),_==="attachments"&&r.jsx("div",{children:r.jsx(Rp,{ticketId:e.TicketID,onUploadComplete:()=>{console.log("Attachment uploaded successfully")}})})]}),r.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #2d3748",background:"#17263f",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[r.jsx("button",{onClick:i,disabled:d,style:{background:"transparent",border:"1px solid #2d3748",color:"#8892b0",borderRadius:"6px",padding:"10px 20px",fontSize:"14px",cursor:"pointer"},children:"Cancel"}),r.jsx("button",{onClick:k,disabled:d,style:{background:"#4CAF50",border:"none",color:"white",borderRadius:"6px",padding:"10px 20px",fontSize:"14px",cursor:d?"not-allowed":"pointer",opacity:d?.7:1},children:d?"Saving...":"Save Changes"})]})]})})}const c_=({onLogin:e})=>{const[t,i]=P.useState(""),[s,a]=P.useState(""),[c,d]=P.useState(""),[p,m]=P.useState(!1),[g,_]=P.useState(""),[j,b]=P.useState(!1),D=async k=>{if(k.preventDefault(),!t.trim()){_("Please enter your company/site code");return}if(!s.trim()||!c.trim()){_("Please enter both username and password");return}m(!0),_("");try{await e(t.trim().toUpperCase(),s.trim(),c)}catch(A){_(A.message||"Login failed. Please check your credentials.")}finally{m(!1)}};return r.jsx("div",{className:"tenant-login-container",children:r.jsxs("div",{className:"tenant-login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("h1",{children:"Field Service Management"}),r.jsx("p",{className:"login-subtitle",children:"Enter your company details to continue"})]}),r.jsxs("form",{onSubmit:D,className:"tenant-login-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"tenantCode",children:"Company/Site Code"}),r.jsx("input",{id:"tenantCode",type:"text",value:t,onChange:k=>i(k.target.value.toUpperCase()),placeholder:"e.g., ACME001, TECH-CORP",maxLength:20,disabled:p,autoComplete:"organization"}),r.jsxs("small",{className:"field-help",children:["Your unique company identifier",r.jsx("button",{type:"button",className:"help-button",onClick:()=>b(!j),children:"?"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"username",children:"Username"}),r.jsx("input",{id:"username",type:"text",value:s,onChange:k=>a(k.target.value),placeholder:"Your username",disabled:p,autoComplete:"username"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{id:"password",type:"password",value:c,onChange:k=>d(k.target.value),placeholder:"Your password",disabled:p,autoComplete:"current-password"})]}),g&&r.jsxs("div",{className:"error-message",children:[r.jsx("span",{className:"error-icon",children:"⚠️"}),g]}),r.jsx("button",{type:"submit",className:"login-button",disabled:p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Connecting..."]}):"Sign In"})]}),j&&r.jsxs("div",{className:"help-panel",children:[r.jsx("h3",{children:"Don't have a company code?"}),r.jsx("p",{children:"Your company code is provided by your system administrator when your organization is set up."}),r.jsx("h4",{children:"Common formats:"}),r.jsxs("ul",{children:[r.jsxs("li",{children:[r.jsx("code",{children:"COMPANY001"})," - Company name + number"]}),r.jsxs("li",{children:[r.jsx("code",{children:"ACME-NYC"})," - Company + location"]}),r.jsxs("li",{children:[r.jsx("code",{children:"TECH-CORP"})," - Abbreviated company name"]})]}),r.jsx("p",{children:"Contact your IT department or system administrator for your company code."})]}),r.jsxs("div",{className:"login-footer",children:[r.jsx("p",{children:"Need to set up a new company?"}),r.jsxs("p",{className:"contact-admin",children:["Please contact your system administrator or email"," ",r.jsx("a",{href:"mailto:admin@dcpsp.com",children:"admin@dcpsp.com"})," ","to register your organization."]})]}),r.jsxs("div",{className:"hosting-options",children:[r.jsx("p",{className:"hosting-note",children:r.jsx("strong",{children:"Hosting Options Available:"})}),r.jsxs("ul",{className:"hosting-list",children:[r.jsx("li",{children:"🌐 Cloud-hosted with your database"}),r.jsx("li",{children:"🏢 Self-hosted on your infrastructure"}),r.jsx("li",{children:"🔒 Hybrid deployment options"})]})]})]})})};function u_(){const[e,t]=P.useState(!1);return P.useEffect(()=>{const i=()=>{document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen().then(()=>t(!0)).catch(()=>{console.log("Fullscreen API not available, using browser fullscreen")})},s=d=>{(d.key==="F11"||d.key==="f"&&d.ctrlKey)&&(d.preventDefault(),document.fullscreenElement?(document.exitFullscreen(),t(!1)):document.documentElement.requestFullscreen&&(document.documentElement.requestFullscreen(),t(!0))),d.key==="Escape"&&d.shiftKey&&window.close()},a=()=>{t(!!document.fullscreenElement)};document.addEventListener("keydown",s),document.addEventListener("fullscreenchange",a);const c=setTimeout(i,1e3);return()=>{clearTimeout(c),document.removeEventListener("keydown",s),document.removeEventListener("fullscreenchange",a)}},[]),r.jsxs("div",{style:{margin:0,padding:0,height:"100vh",width:"100vw",background:"#f0f0f0",overflow:"hidden",position:"fixed",top:0,left:0},children:[r.jsxs("div",{style:{position:"absolute",top:"10px",left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.8)",color:"white",padding:"8px 16px",borderRadius:"20px",fontSize:"12px",zIndex:1e4,display:"flex",alignItems:"center",gap:"12px"},children:[r.jsx("span",{children:"🗺️ DCPSP Operations Center - Live Map"}),r.jsx("span",{style:{opacity:.7,fontSize:"10px"},children:"Shortcuts: F11 (Fullscreen) | Shift+Esc (Close)"}),r.jsx("button",{onClick:()=>window.close(),style:{background:"transparent",border:"1px solid #666",color:"white",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},children:"Close Window"}),r.jsx("button",{onClick:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},style:{background:"transparent",border:"1px solid #666",color:"white",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"11px"},children:e?"Exit Fullscreen":"Fullscreen"})]}),r.jsx("div",{style:{height:"100vh",width:"100vw"},children:r.jsx(Hp,{})})]})}function d_(){const[e,t]=P.useState([]),[i,s]=P.useState([]),[a,c]=P.useState(!0),[d,p]=P.useState(void 0),[m,g]=P.useState(!1),[_,j]=P.useState(void 0),[b,D]=P.useState("Tickets"),[k,A]=P.useState(null),[O,S]=P.useState(null),[f,w]=P.useState("DCPSP Field Service"),[C,y]=P.useState(!1),[z,I]=P.useState(!1),[B,$]=P.useState(""),[H,U]=P.useState(0),[F,G]=P.useState(0);P.useEffect(()=>{document.title=f},[f]),P.useEffect(()=>{if(!C||!k){console.log("🔴 Count fetch skipped:",{isAuthenticated:C,hasUser:!!k});return}console.log("🟢 Fetching initial request count...");const q=async()=>{try{const ge="https://field-service-api.azurewebsites.net/api",le=k.companyCode||localStorage.getItem("companyCode")||"",Pt={"Content-Type":"application/json"},Qt=localStorage.getItem("authToken");Qt&&(Pt.Authorization=`Bearer ${Qt}`);const Me=localStorage.getItem("sqlUser");if(Me)try{const tt=JSON.parse(Me);tt.id&&(Pt["x-user-id"]=tt.id,Pt["x-user-name"]=tt.username||tt.fullName||"",Pt["x-user-role"]=tt.role||"")}catch{console.warn("Failed to parse sqlUser from localStorage")}console.log("📡 Fetching from:",`${ge}/service-requests?status=New&companyCode=${le}`);const Lt=await fetch(`${ge}/service-requests?status=New&companyCode=${le}`,{headers:Pt});if(Lt.ok){const tt=await Lt.json();console.log("✅ Got request count:",tt.length),G(tt.length)}else console.error("❌ Request failed:",Lt.status,Lt.statusText)}catch(ge){console.error("Failed to fetch initial request count:",ge)}};q();const ee=setInterval(q,6e4);return()=>clearInterval(ee)},[C,k]),P.useEffect(()=>{(()=>{console.log("🔐 Initializing authentication..."),console.log("📦 LocalStorage contents:",{sqlUser:!!localStorage.getItem("sqlUser"),authToken:!!localStorage.getItem("authToken"),userRole:localStorage.getItem("userRole"),userName:localStorage.getItem("userName")});const ee=localStorage.getItem("sqlUser"),ge=localStorage.getItem("authToken");if(console.log("🔍 Checking authentication:",{hasSqlUser:!!ee,hasToken:!!ge}),ee&&ge)try{const le=JSON.parse(ee);console.log("👤 Found stored user:",le.username,"Company:",le.companyCode),A(le),y(!0),le.companyDisplayName?w(le.companyDisplayName):le.companyName&&w(le.companyName),console.log("✅ User authenticated from localStorage - isAuthenticated will be set to TRUE");return}catch(le){console.error("🔄 Invalid sqlUser data, clearing session:",le),localStorage.removeItem("sqlUser"),localStorage.removeItem("authToken")}console.log("📋 No valid session - ready for login"),y(!1)})()},[]);const K=async(q,ee,ge)=>{I(!0),$("");try{const le=await Vl.login(q,ee,ge);if(le.success&&le.data)le.data.token&&(localStorage.setItem("authToken",le.data.token),console.log("✅ Stored auth token")),le.data.user&&(localStorage.setItem("sqlUser",JSON.stringify(le.data.user)),localStorage.setItem("userRole",le.data.user.role),localStorage.setItem("userName",le.data.user.fullName||le.data.user.username),localStorage.setItem("userId",le.data.user.id),console.log("✅ Stored SQL user for data isolation:",le.data.user.id,"Company:",le.data.user.companyCode)),A(le.data.user),S({id:q,code:le.data.tenant.code,name:le.data.tenant.name,tier:"Standard",maxUsers:100}),le.data.user.companyDisplayName?w(le.data.user.companyDisplayName):le.data.user.companyName?w(le.data.user.companyName):le.data.tenant.name&&w(le.data.tenant.name),y(!0),await re();else throw new Error(le.error||"Login failed")}catch(le){throw $(le.message||"Login failed. Please try again."),le}finally{I(!1)}},ne=async()=>{await Vl.logout(),A(null),S(null),y(!1),t([]),s([]),D("Tickets")};async function re(){if(["Tickets","Reports","Closed"].includes(b)){console.log("App.refresh: Starting refresh..."),console.log("App.refresh: Loading data from SQL API"),c(!0),j(void 0);try{console.log("App.refresh: Using SqlApiService");const[q,ee]=await Promise.all([$p(),Gl()]);console.log("App.refresh: Received from SQL database -",q.length,"tickets and",ee.length,"sites"),t(q),s(ee),console.log("App.refresh: Updated state with tickets and sites"),U(ge=>ge+1)}catch(q){console.error("App.refresh: Error during refresh:",q),j(`Database connection failed: ${q.message}`),t([]),s([])}finally{c(!1)}}}if(P.useEffect(()=>{C&&re()},[b,C]),new URLSearchParams(window.location.search).get("map-only")==="true")return r.jsx(u_,{});if((k==null?void 0:k.role)==="Technician"){const q=async ee=>{try{await Mo(ee.TicketID,ee,k),await re()}catch(ge){throw console.error("Error updating ticket:",ge),ge}};return r.jsx(a_,{tickets:e,currentUser:k,onTicketUpdate:q,onLogout:ne})}async function v(q,ee){await Mo(q,{Status:ee},k),await re()}async function E(q){try{m?(await Sy(q,k),g(!1),p(void 0)):d&&(await Mo(d.TicketID,q,k),p(void 0)),await re()}catch(ee){console.error("Error saving ticket:",ee),alert("Error saving ticket: "+ee.message)}}const W=()=>{const q=new Date,ee=new Date(q.getTime()+72*60*60*1e3);return{TicketID:`TKT-TEMP-${Date.now()}`,Title:"",Status:"New",Priority:"Normal",Customer:"",Site:"",LicenseIDs:"",Category:"",Description:"",ScheduledStart:"",ScheduledEnd:"",AssignedTo:"",SLA_Due:ee.toISOString(),Resolution:"",ClosedBy:"",ClosedDate:"",GeoLocation:"",Tags:"",CreatedAt:new Date().toISOString(),UpdatedAt:new Date().toISOString(),CoordinatorNotes:[]}},Z=()=>{p(W()),g(!0)},Q=async q=>{try{const ee={id:Date.now().toString(),timestamp:new Date().toISOString(),user:(k==null?void 0:k.fullName)||"Unknown User",action:"Ticket Reopened",field:"Status",oldValue:q.Status,newValue:"New",notes:q.reopenReason||"Ticket reopened from closed status"};await Mo(q.TicketID,{Status:"New",ClosedBy:"",ClosedDate:"",AuditTrail:[...q.AuditTrail||[],ee]},k),await re()}catch(ee){console.error("Error reopening ticket:",ee),alert("Error reopening ticket: "+ee.message)}},te=async q=>{try{const ee=await pt.getTicket(q.TicketID);p(ee),g(!1)}catch(ee){console.error("Error loading complete ticket data:",ee),p(q),g(!1)}},ae=()=>{p(void 0),g(!1)};return console.log("🔍 App Render State:",{isAuthenticated:C,hasUser:!!k,userCompany:k==null?void 0:k.companyCode}),r.jsxs("div",{className:"container",children:[!C&&r.jsx(c_,{onLogin:K}),C&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"row",style:{marginBottom:12},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("h1",{children:["🔧 ",f]}),r.jsxs("div",{className:"muted",children:["Multi-Tenant Field Service Management Platform",O&&r.jsxs("span",{style:{marginLeft:"16px",fontWeight:500,color:"#3b82f6"},children:["• ",O.name," (",O.tier,")"]})]})]}),r.jsxs("div",{className:"toolbar",children:[b==="Tickets"&&r.jsx("button",{className:"ghost",onClick:re,children:"Refresh"}),b==="Tickets"&&r.jsx("button",{className:"primary",onClick:Z,children:"New Ticket"})]})]}),r.jsx(qy,{tab:b,setTab:q=>D(q),currentUser:k,onLogout:ne,newRequestsCount:F}),"          ",b==="Tickets"&&r.jsxs(r.Fragment,{children:[_&&r.jsxs("div",{className:"card",style:{borderColor:"#ff5470",color:"#ffb3bf"},children:["Error: ",_]}),r.jsx(Yx,{items:e.filter(q=>q.Status!=="Closed"),onStatusChange:v,onEdit:te,loading:a})]}),b==="Map"&&r.jsx(Hp,{tickets:e,refreshTrigger:H}),b==="Calendar"&&r.jsx(Ay,{tickets:e,currentUser:k,onTicketSelect:p}),b==="Reports"&&r.jsx(Ry,{tickets:e,sites:i}),b==="Closed"&&r.jsx(Uy,{tickets:e,onViewHistory:q=>p(q),onReopen:Q}),b==="Users"&&r.jsx($y,{currentUser:k}),b==="Companies"&&r.jsx(Vy,{}),b==="Activity"&&r.jsx(Zy,{}),b==="Customers"&&r.jsx(Gy,{}),b==="Sites"&&r.jsx(Qy,{}),b==="Licenses"&&r.jsx(n_,{}),b==="Vendors"&&r.jsx(o_,{}),b==="Requests"&&r.jsx(s_,{onLogout:ne,onCountChange:G}),d&&r.jsx(ny,{ticket:d,onClose:ae,onSave:E,readonly:d.Status==="Closed",companyName:f})]})]})}Xa.createRoot(document.getElementById("root")).render(r.jsx(Lr.StrictMode,{children:r.jsx(d_,{})}));
